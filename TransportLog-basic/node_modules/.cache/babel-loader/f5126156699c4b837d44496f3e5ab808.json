{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n\nimport { formatUnit, isNullOrUndefined, closest, extend, append, prepend, remove } from '@syncfusion/ej2-base';\nimport { createElement, addClass, EventHandler } from '@syncfusion/ej2-base';\nimport { AgendaBase } from '../event-renderer/agenda-base';\nimport * as util from '../base/util';\nimport * as event from '../base/constant';\nimport * as cls from '../base/css-constant';\n/**\n * agenda view\n */\n\nvar Agenda =\n/** @class */\nfunction (_super) {\n  __extends(Agenda, _super);\n\n  function Agenda(parent) {\n    var _this = _super.call(this, parent) || this;\n\n    _this.viewClass = 'e-agenda-view';\n    _this.isInverseTableSelect = false;\n    _this.agendaDates = {};\n    _this.virtualScrollTop = 1;\n    return _this;\n  }\n\n  Agenda.prototype.getModuleName = function () {\n    return 'agenda';\n  };\n\n  Agenda.prototype.renderLayout = function () {\n    this.agendaDates = {};\n    this.element = createElement('div', {\n      className: cls.TABLE_WRAP_CLASS\n    });\n    addClass([this.element], this.viewClass);\n    this.element.appendChild(this.createTableLayout(cls.OUTER_TABLE_CLASS));\n    this.element.querySelector('table').setAttribute('role', 'presentation');\n    this.parent.element.querySelector('.' + cls.TABLE_CONTAINER_CLASS).appendChild(this.element);\n    var eTr = createElement('tr');\n    this.element.querySelector('tbody').appendChild(eTr);\n    var workTd = createElement('td');\n    eTr.appendChild(workTd);\n    var wrap = createElement('div', {\n      className: cls.CONTENT_WRAP_CLASS\n    });\n    workTd.appendChild(wrap);\n    var tbl = this.createTableLayout(cls.CONTENT_TABLE_CLASS);\n    this.setAriaAttributes(tbl);\n    wrap.appendChild(tbl);\n    var tBody = tbl.querySelector('tbody');\n    var agendaDate = util.resetTime(this.parent.selectedDate);\n    this.renderEmptyContent(tBody, agendaDate);\n    this.wireEvents();\n\n    if (this.parent.resourceBase) {\n      this.parent.resourceBase.generateResourceLevels([{\n        renderDates: this.parent.activeView.renderDates\n      }]);\n    }\n\n    if (this.parent.uiStateValues.isGroupAdaptive && !this.parent.element.querySelector('.' + cls.RESOURCE_TOOLBAR_CONTAINER)) {\n      this.renderResourceMobileLayout();\n    }\n\n    this.parent.notify(event.contentReady, {});\n  };\n\n  Agenda.prototype.eventLoad = function (args) {\n    this.dataSource = extend([], this.parent.eventsData, null, true);\n\n    for (var _i = 0, _a = this.parent.eventsData; _i < _a.length; _i++) {\n      var event_1 = _a[_i];\n      delete event_1.generatedDates;\n    }\n\n    var eventCollection = this.parent.activeViewOptions.allowVirtualScrolling ? args.processedData : this.parent.eventsProcessed;\n\n    if (this.parent.uiStateValues.isGroupAdaptive) {\n      var resource = this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex];\n      this.dataSource = this.parent.eventBase.filterEventsByResource(resource, this.dataSource);\n      eventCollection = this.parent.eventBase.filterEventsByResource(resource, eventCollection);\n    }\n\n    this.parent.eventsProcessed = this.processAgendaEvents(eventCollection);\n    var agendaDate = util.resetTime(this.parent.selectedDate);\n    var tBody = this.element.querySelector('.' + cls.CONTENT_TABLE_CLASS + ' tbody');\n    util.removeChildren(tBody);\n    this.renderInitialContent(tBody, agendaDate);\n    this.wireEventActions();\n    var contentArea = closest(tBody, '.' + cls.CONTENT_WRAP_CLASS);\n    contentArea.scrollTop = 1;\n    this.parent.notify(event.eventsLoaded, {});\n\n    if (!this.parent.activeViewOptions.allowVirtualScrolling) {\n      this.retainScrollPosition();\n    }\n  };\n\n  Agenda.prototype.refreshEvent = function (refreshDate) {\n    var processedData = [];\n    var fields = this.parent.eventFields;\n\n    for (var _i = 0, _a = this.dataSource; _i < _a.length; _i++) {\n      var data = _a[_i];\n\n      if (isNullOrUndefined(data[fields.recurrenceID]) && !isNullOrUndefined(data[fields.recurrenceRule]) && !isNullOrUndefined(data.generatedDates) && refreshDate >= data.generatedDates.end) {\n        processedData = processedData.concat(this.parent.eventBase.generateOccurrence(data, refreshDate));\n      }\n    }\n\n    this.parent.eventsProcessed = this.parent.eventsProcessed.concat(this.processAgendaEvents(processedData));\n  };\n\n  Agenda.prototype.refreshHeader = function () {\n    var tBody = this.element.querySelector('.' + cls.CONTENT_TABLE_CLASS + ' tbody');\n\n    if (this.parent.activeViewOptions.group.byDate) {\n      util.removeChildren(tBody);\n    } else {\n      remove(tBody.firstElementChild);\n    }\n\n    var agendaDate = util.resetTime(this.parent.selectedDate);\n    var emptyTBody = createElement('tbody');\n    var firstDate = new Date(agendaDate.getTime());\n    var lastDate = this.parent.activeViewOptions.allowVirtualScrolling && this.parent.hideEmptyAgendaDays ? this.getEndDateFromStartDate(firstDate) : util.addDays(firstDate, this.parent.agendaDaysCount);\n    this.renderContent(emptyTBody, firstDate, lastDate);\n    append([].slice.call(emptyTBody.childNodes), tBody);\n  };\n\n  Agenda.prototype.renderInitialContent = function (tBody, agendaDate) {\n    var emptyTBody = createElement('tbody');\n    var firstDate = new Date(agendaDate.getTime());\n    var lastDate = this.parent.activeViewOptions.allowVirtualScrolling && this.parent.hideEmptyAgendaDays ? this.getEndDateFromStartDate(firstDate) : util.addDays(firstDate, this.parent.agendaDaysCount);\n    this.renderContent(emptyTBody, firstDate, lastDate);\n    append([].slice.call(emptyTBody.childNodes), tBody); // Initial rendering, to load previous date events upto scroll bar enable\n\n    if (this.parent.activeViewOptions.allowVirtualScrolling && this.parent.hideEmptyAgendaDays && this.parent.eventsData.length > 0) {\n      var contentArea = this.getContentAreaElement();\n      var contentChild = contentArea.querySelector('.e-content-table');\n\n      while (contentArea.offsetWidth <= contentArea.clientWidth) {\n        if (this.parent.isAdaptive && contentChild.offsetHeight >= contentArea.clientHeight) {\n          break;\n        }\n\n        var emptyTBody_1 = createElement('tbody');\n        lastDate = firstDate;\n        firstDate = util.addDays(lastDate, -this.parent.agendaDaysCount);\n        this.renderContent(emptyTBody_1, firstDate, lastDate);\n        prepend([].slice.call(emptyTBody_1.childNodes), tBody);\n\n        if (firstDate <= this.parent.minDate) {\n          break;\n        }\n      }\n    }\n\n    if (tBody.childNodes.length <= 0) {\n      this.renderEmptyContent(tBody, agendaDate);\n    }\n  };\n\n  Agenda.prototype.renderContent = function (tBody, agendaDate, lastDate) {\n    var fieldMapping = this.parent.eventFields;\n    var firstDate = new Date(agendaDate.getTime());\n    var isObject = this.appointmentFiltering(firstDate, lastDate);\n\n    if (isObject.length > 0 && this.parent.activeViewOptions.allowVirtualScrolling && this.parent.hideEmptyAgendaDays) {\n      agendaDate = isObject[0][fieldMapping.startTime];\n      agendaDate = new Date(new Date(agendaDate.getTime()).setHours(0, 0, 0, 0));\n      this.updateHeaderText(isObject[0][fieldMapping.startTime]);\n    }\n\n    var endDate;\n\n    if (!this.parent.hideEmptyAgendaDays || this.parent.agendaDaysCount > 0 && isObject.length > 0) {\n      if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n        var date = agendaDate;\n\n        if (!this.parent.activeViewOptions.group.byDate) {\n          this.parent.activeViewOptions.allowVirtualScrolling = false;\n          date = firstDate;\n\n          if (this.parent.headerModule) {\n            this.parent.headerModule.updateDateRange(this.parent.activeView.getDateRangeText());\n            this.parent.headerModule.updateHeaderItems('remove');\n          }\n        }\n\n        this.calculateResourceTableElement(tBody, this.parent.agendaDaysCount, date);\n      } else {\n        for (var day = 0; day < this.parent.agendaDaysCount; day++) {\n          var filterData = this.appointmentFiltering(agendaDate);\n          var nTr = this.createTableRowElement(agendaDate, 'data');\n\n          if (this.element.querySelector('tr[data-row-index=\"' + parseInt(nTr.getAttribute('data-row-index'), 10) + '\"]')) {\n            agendaDate = util.addDays(agendaDate, 1);\n            continue;\n          }\n\n          var dTd = nTr.children[0];\n          var aTd = nTr.children[1];\n\n          if (filterData.length > 0 || !this.parent.hideEmptyAgendaDays && filterData.length === 0) {\n            var elementType = !this.parent.hideEmptyAgendaDays && filterData.length === 0 ? 'noEvents' : 'data';\n            dTd.appendChild(this.createDateHeaderElement(agendaDate));\n            nTr.appendChild(dTd);\n            var cTd = this.createAgendaContentElement(elementType, filterData, aTd);\n            nTr.appendChild(cTd);\n\n            if (cTd.querySelectorAll('li').length > 0) {\n              tBody.appendChild(nTr);\n            }\n          } else if (this.parent.activeViewOptions.allowVirtualScrolling) {\n            day--;\n          }\n\n          if (this.isCurrentDate(new Date(agendaDate.getTime()))) {\n            addClass(dTd.childNodes, cls.AGENDA_CURRENT_DAY_CLASS);\n          }\n\n          agendaDate = util.addDays(agendaDate, 1);\n\n          if (agendaDate.getTime() > lastDate.getTime()) {\n            break;\n          }\n        }\n      }\n\n      endDate = new Date(agendaDate.getTime() - util.MS_PER_DAY);\n    }\n\n    this.agendaDates = {\n      start: firstDate,\n      end: endDate\n    };\n  };\n\n  Agenda.prototype.agendaScrolling = function (event) {\n    if (this.parent.quickPopup) {\n      this.parent.quickPopup.quickPopupHide();\n    }\n\n    if (this.parent.activeViewOptions.allowVirtualScrolling) {\n      this.virtualScrolling(event);\n    }\n\n    if (!this.parent.activeViewOptions.allowVirtualScrolling) {\n      this.setPersistence();\n    }\n  };\n\n  Agenda.prototype.virtualScrolling = function (event) {\n    var target = event.target;\n    var scrollTop = target.scrollTop;\n    var scrollHeight = target.scrollHeight;\n    var offsetHeight = target.clientHeight;\n    var totalHeight = scrollTop + offsetHeight;\n    var direction = this.virtualScrollTop < scrollTop ? 'next' : 'previous';\n    var tBody = target.querySelector('tbody');\n    var emptyTBody = createElement('tbody');\n    var topElement = this.getElementFromScrollerPosition(event);\n    var scrollDate = this.parent.getDateFromElement(topElement);\n    var filterDate;\n    var filterData;\n\n    if (scrollTop === 0) {\n      filterDate = this.getPreviousNextDate(util.addDays(scrollDate, -1), direction);\n      filterData = this.appointmentFiltering(filterDate.start, filterDate.end);\n\n      if (filterData.length > 0 || !this.parent.hideEmptyAgendaDays) {\n        this.renderContent(emptyTBody, filterDate.start, filterDate.end);\n        prepend([].slice.call(emptyTBody.childNodes), tBody);\n        this.wireEventActions();\n\n        for (var s = 0, element = tBody.children; s < element.length; s++) {\n          if (element[s].getAttribute('data-row-index') === topElement.getAttribute('data-column-index')) {\n            var scrollToValue = element[s].offsetTop - this.element.querySelector('.e-agenda-item').offsetHeight;\n            target.scrollTop = scrollToValue;\n            break;\n          }\n        }\n\n        this.updateHeaderText(scrollDate);\n      }\n    } else if (totalHeight >= scrollHeight - 5) {\n      filterDate = this.getPreviousNextDate(util.addDays(scrollDate, 1), direction);\n      filterData = this.appointmentFiltering(filterDate.start, filterDate.end);\n\n      if (filterData.length > 0 || !this.parent.hideEmptyAgendaDays) {\n        this.renderContent(emptyTBody, filterDate.start, filterDate.end);\n        append([].slice.call(emptyTBody.childNodes), tBody);\n        this.wireEventActions();\n        this.updateHeaderText(scrollDate);\n      }\n    } else {\n      this.updateHeaderText(scrollDate);\n    }\n\n    this.virtualScrollTop = scrollTop;\n    var selectedElements = this.parent.eventBase.getSelectedAppointments();\n\n    if (selectedElements.length > 0) {\n      selectedElements[selectedElements.length - 1].focus();\n    }\n  };\n\n  Agenda.prototype.getElementFromScrollerPosition = function (event) {\n    var filterElement;\n    var target = event.target;\n    var scrollTop = target.scrollTop;\n    var scrollHeight = target.scrollHeight;\n    var offsetHeight = target.clientHeight;\n    var totalHeight = scrollTop + offsetHeight;\n    var liCollection = [].slice.call(target.querySelectorAll('.e-agenda-item'));\n    var li;\n    var liDetails;\n\n    if (liCollection.length > 0) {\n      if (scrollTop === 0) {\n        li = liCollection[0];\n        filterElement = closest(li, '.' + cls.AGENDA_CELLS_CLASS);\n      } else if (totalHeight === scrollHeight) {\n        li = liCollection[liCollection.length - 1];\n        filterElement = closest(li, '.' + cls.AGENDA_CELLS_CLASS);\n      } else {\n        for (var a = 0, length_1 = liCollection.length; a < length_1; a++) {\n          li = liCollection[a];\n          liDetails = li.getBoundingClientRect();\n\n          if (liDetails.top >= 0) {\n            filterElement = closest(li, '.' + cls.AGENDA_CELLS_CLASS);\n            break;\n          }\n        }\n      }\n    }\n\n    return filterElement;\n  };\n\n  Agenda.prototype.updateHeaderText = function (date) {\n    if (this.parent.showHeaderBar) {\n      this.parent.headerModule.updateDateRange(this.getDateRangeText(date));\n    }\n  };\n\n  Agenda.prototype.getPreviousNextDate = function (date, type) {\n    var currentDate = new Date(date.getTime());\n    var firstDate = this.getStartDateFromEndDate(date);\n    var lastDate = this.getEndDateFromStartDate(date);\n    var daysCount = 0;\n\n    do {\n      var filterData = this.appointmentFiltering(currentDate);\n\n      if (filterData.length > 0 || !this.parent.hideEmptyAgendaDays) {\n        daysCount++;\n      }\n\n      currentDate = util.addDays(currentDate, type === 'next' ? 1 : -1);\n\n      if (currentDate < firstDate || currentDate > lastDate) {\n        break;\n      }\n    } while (daysCount !== this.parent.agendaDaysCount);\n\n    var endDate = util.addDays(currentDate, type === 'next' ? -1 : 1);\n    return type === 'next' ? {\n      start: date,\n      end: util.addDays(endDate, 1)\n    } : {\n      start: endDate,\n      end: util.addDays(date, 1)\n    };\n  };\n\n  Agenda.prototype.appointmentFiltering = function (startDate, endDate) {\n    var dateStart;\n    var dateEnd;\n\n    if (!isNullOrUndefined(startDate) && isNullOrUndefined(endDate)) {\n      dateStart = util.resetTime(new Date(startDate.getTime()));\n      dateEnd = util.setTime(new Date(dateStart.getTime()), util.MS_PER_DAY);\n    } else {\n      dateStart = new Date(startDate.getTime());\n      dateEnd = new Date(endDate.getTime());\n    }\n\n    var filterData = this.parent.eventBase.filterEvents(dateStart, dateEnd);\n\n    if (filterData.length === 0) {\n      this.refreshEvent(startDate);\n      filterData = this.parent.eventBase.filterEvents(dateStart, dateEnd);\n    }\n\n    return filterData;\n  };\n\n  Agenda.prototype.getStartDateFromEndDate = function (endDate) {\n    var filterDate;\n    var fields = this.parent.eventFields;\n\n    if (this.parent.eventsProcessed.length > 0) {\n      var firstDate = Math.min.apply(Math, this.parent.eventsProcessed.map(function (a) {\n        return a[fields.startTime].getTime();\n      }));\n      filterDate = this.parent.hideEmptyAgendaDays ? new Date(firstDate) : this.parent.minDate;\n    } else {\n      filterDate = this.parent.hideEmptyAgendaDays ? util.addMonths(endDate, -1) : this.parent.minDate;\n    }\n\n    return util.resetTime(filterDate);\n  };\n\n  Agenda.prototype.getEndDateFromStartDate = function (startDate) {\n    var filterDate;\n    var fieldMapping = this.parent.eventFields;\n\n    if (this.parent.eventsProcessed.length > 0) {\n      var lastDate = Math.max.apply(Math, this.parent.eventsProcessed.map(function (a) {\n        return a[fieldMapping.endTime].getTime();\n      }));\n      filterDate = this.parent.hideEmptyAgendaDays ? new Date(lastDate) : this.parent.maxDate;\n    } else {\n      filterDate = this.parent.hideEmptyAgendaDays ? util.addMonths(startDate, 1) : this.parent.maxDate;\n    }\n\n    return util.resetTime(util.addDays(filterDate, 1));\n  };\n\n  Agenda.prototype.getNextPreviousDate = function (type) {\n    var noOfDays = type === 'next' ? 1 : -1;\n    return util.addDays(this.parent.selectedDate, noOfDays);\n  };\n\n  Agenda.prototype.startDate = function () {\n    return util.resetTime(this.parent.selectedDate);\n  };\n\n  Agenda.prototype.endDate = function () {\n    if (this.parent.activeViewOptions.allowVirtualScrolling) {\n      return this.getEndDateFromStartDate(this.startDate());\n    } else {\n      return util.addDays(this.startDate(), this.parent.agendaDaysCount);\n    }\n  };\n\n  Agenda.prototype.getDateRangeText = function (date) {\n    var formatDate = this.parent.activeViewOptions.dateFormat ? this.parent.activeViewOptions.dateFormat : 'MMMM y';\n\n    if (this.parent.activeViewOptions.allowVirtualScrolling || this.parent.isAdaptive) {\n      var currentDate = isNullOrUndefined(date) ? this.parent.selectedDate : date;\n      return util.capitalizeFirstWord(this.parent.globalize.formatDate(currentDate, {\n        format: formatDate,\n        calendar: this.parent.getCalendarMode()\n      }), 'multiple');\n    } else {\n      var startDate = this.parent.selectedDate;\n      var endDate = util.addDays(startDate, this.parent.agendaDaysCount - 1);\n      return this.formatDateRange(startDate, endDate);\n    }\n  };\n\n  Agenda.prototype.dayNavigationClick = function (e) {\n    var element = closest(e.currentTarget, '.' + cls.AGENDA_CELLS_CLASS);\n    var date = this.parent.getDateFromElement(element);\n\n    if (!isNullOrUndefined(date) && !this.parent.isAdaptive && this.parent.isMinMaxDate(date)) {\n      this.parent.setProperties({\n        selectedDate: date\n      }, true);\n      this.parent.changeView('Day', e);\n    }\n  };\n\n  Agenda.prototype.wireEvents = function () {\n    EventHandler.add(this.element.querySelector('.' + cls.CONTENT_WRAP_CLASS), event.scroll, this.agendaScrolling, this);\n  };\n\n  Agenda.prototype.unWireEvents = function () {\n    EventHandler.remove(this.element.querySelector('.' + cls.CONTENT_WRAP_CLASS), event.scroll, this.agendaScrolling);\n    var dateHeaderElement = [].slice.call(this.element.querySelectorAll('.e-m-date'));\n\n    for (var _i = 0, dateHeaderElement_1 = dateHeaderElement; _i < dateHeaderElement_1.length; _i++) {\n      var element = dateHeaderElement_1[_i];\n      EventHandler.remove(element, 'click', this.dayNavigationClick);\n    }\n  };\n\n  Agenda.prototype.addEventListener = function () {\n    this.parent.on(event.scrollUiUpdate, this.onAgendaScrollUiUpdate, this);\n    this.parent.on(event.dataReady, this.eventLoad, this);\n  };\n\n  Agenda.prototype.removeEventListener = function () {\n    if (this.parent) {\n      this.parent.off(event.scrollUiUpdate, this.onAgendaScrollUiUpdate);\n      this.parent.off(event.dataReady, this.eventLoad);\n    }\n  };\n\n  Agenda.prototype.onAgendaScrollUiUpdate = function () {\n    var headerHeight = this.getHeaderBarHeight();\n\n    if (this.parent.headerModule) {\n      if (this.parent.activeViewOptions.allowVirtualScrolling) {\n        this.parent.headerModule.updateHeaderItems('add');\n      } else {\n        this.parent.headerModule.updateHeaderItems('remove');\n      }\n    }\n\n    var contentArea = this.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n\n    if (this.parent.height !== 'auto') {\n      contentArea.style.height = formatUnit(this.parent.element.offsetHeight - headerHeight);\n    }\n  };\n\n  Agenda.prototype.scrollToDate = function (scrollDate) {\n    var date = new Date(+util.resetTime(scrollDate));\n\n    if (this.parent.activeViewOptions.allowVirtualScrolling) {\n      if (!this.parent.hideEmptyAgendaDays || this.parent.getEvents(date, util.addDays(date, 1), true).length > 0) {\n        this.parent.changeDate(date);\n      }\n    } else {\n      var dateElement = this.element.querySelector('.' + cls.AGENDA_CELLS_CLASS + '[data-date=\"' + date.getTime() + '\"]');\n\n      if (dateElement) {\n        this.getContentAreaElement().scrollTop = dateElement.offsetTop;\n      }\n    }\n  };\n\n  Agenda.prototype.destroy = function () {\n    if (!this.parent || this.parent && this.parent.isDestroyed) {\n      return;\n    }\n\n    if (this.element) {\n      this.unWireEvents();\n\n      if (this.parent.resourceBase) {\n        this.parent.resourceBase.destroy();\n      }\n\n      if (this.parent.headerModule && this.parent.activeViewOptions.allowVirtualScrolling) {\n        this.parent.headerModule.updateHeaderItems('remove');\n      }\n\n      _super.prototype.destroy.call(this);\n    }\n  };\n\n  return Agenda;\n}(AgendaBase);\n\nexport { Agenda };","map":{"version":3,"sources":["C:/Users/Zoran/source/repos/TransportApp/TransportLog-basic/node_modules/@syncfusion/ej2-schedule/src/schedule/renderer/agenda.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","formatUnit","isNullOrUndefined","closest","extend","append","prepend","remove","createElement","addClass","EventHandler","AgendaBase","util","event","cls","Agenda","_super","parent","_this","call","viewClass","isInverseTableSelect","agendaDates","virtualScrollTop","getModuleName","renderLayout","element","className","TABLE_WRAP_CLASS","appendChild","createTableLayout","OUTER_TABLE_CLASS","querySelector","setAttribute","TABLE_CONTAINER_CLASS","eTr","workTd","wrap","CONTENT_WRAP_CLASS","tbl","CONTENT_TABLE_CLASS","setAriaAttributes","tBody","agendaDate","resetTime","selectedDate","renderEmptyContent","wireEvents","resourceBase","generateResourceLevels","renderDates","activeView","uiStateValues","isGroupAdaptive","RESOURCE_TOOLBAR_CONTAINER","renderResourceMobileLayout","notify","contentReady","eventLoad","args","dataSource","eventsData","_i","_a","length","event_1","generatedDates","eventCollection","activeViewOptions","allowVirtualScrolling","processedData","eventsProcessed","resource","lastResourceLevel","groupIndex","eventBase","filterEventsByResource","processAgendaEvents","removeChildren","renderInitialContent","wireEventActions","contentArea","scrollTop","eventsLoaded","retainScrollPosition","refreshEvent","refreshDate","fields","eventFields","data","recurrenceID","recurrenceRule","end","concat","generateOccurrence","refreshHeader","group","byDate","firstElementChild","emptyTBody","firstDate","Date","getTime","lastDate","hideEmptyAgendaDays","getEndDateFromStartDate","addDays","agendaDaysCount","renderContent","slice","childNodes","getContentAreaElement","contentChild","offsetWidth","clientWidth","isAdaptive","offsetHeight","clientHeight","emptyTBody_1","minDate","fieldMapping","isObject","appointmentFiltering","startTime","setHours","updateHeaderText","endDate","resources","date","headerModule","updateDateRange","getDateRangeText","updateHeaderItems","calculateResourceTableElement","day","filterData","nTr","createTableRowElement","parseInt","getAttribute","dTd","children","aTd","elementType","createDateHeaderElement","cTd","createAgendaContentElement","querySelectorAll","isCurrentDate","AGENDA_CURRENT_DAY_CLASS","MS_PER_DAY","start","agendaScrolling","quickPopup","quickPopupHide","virtualScrolling","setPersistence","target","scrollHeight","totalHeight","direction","topElement","getElementFromScrollerPosition","scrollDate","getDateFromElement","filterDate","getPreviousNextDate","s","scrollToValue","offsetTop","selectedElements","getSelectedAppointments","focus","filterElement","liCollection","li","liDetails","AGENDA_CELLS_CLASS","a","length_1","getBoundingClientRect","top","showHeaderBar","type","currentDate","getStartDateFromEndDate","daysCount","startDate","dateStart","dateEnd","setTime","filterEvents","Math","min","apply","map","addMonths","max","endTime","maxDate","getNextPreviousDate","noOfDays","formatDate","dateFormat","capitalizeFirstWord","globalize","format","calendar","getCalendarMode","formatDateRange","dayNavigationClick","e","currentTarget","isMinMaxDate","setProperties","changeView","add","scroll","unWireEvents","dateHeaderElement","dateHeaderElement_1","addEventListener","on","scrollUiUpdate","onAgendaScrollUiUpdate","dataReady","removeEventListener","off","headerHeight","getHeaderBarHeight","height","style","scrollToDate","getEvents","changeDate","dateElement","destroy","isDestroyed"],"mappings":"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","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { formatUnit, isNullOrUndefined, closest, extend, append, prepend, remove } from '@syncfusion/ej2-base';\nimport { createElement, addClass, EventHandler } from '@syncfusion/ej2-base';\nimport { AgendaBase } from '../event-renderer/agenda-base';\nimport * as util from '../base/util';\nimport * as event from '../base/constant';\nimport * as cls from '../base/css-constant';\n/**\n * agenda view\n */\nvar Agenda = /** @class */ (function (_super) {\n    __extends(Agenda, _super);\n    function Agenda(parent) {\n        var _this = _super.call(this, parent) || this;\n        _this.viewClass = 'e-agenda-view';\n        _this.isInverseTableSelect = false;\n        _this.agendaDates = {};\n        _this.virtualScrollTop = 1;\n        return _this;\n    }\n    Agenda.prototype.getModuleName = function () {\n        return 'agenda';\n    };\n    Agenda.prototype.renderLayout = function () {\n        this.agendaDates = {};\n        this.element = createElement('div', { className: cls.TABLE_WRAP_CLASS });\n        addClass([this.element], this.viewClass);\n        this.element.appendChild(this.createTableLayout(cls.OUTER_TABLE_CLASS));\n        this.element.querySelector('table').setAttribute('role', 'presentation');\n        this.parent.element.querySelector('.' + cls.TABLE_CONTAINER_CLASS).appendChild(this.element);\n        var eTr = createElement('tr');\n        this.element.querySelector('tbody').appendChild(eTr);\n        var workTd = createElement('td');\n        eTr.appendChild(workTd);\n        var wrap = createElement('div', { className: cls.CONTENT_WRAP_CLASS });\n        workTd.appendChild(wrap);\n        var tbl = this.createTableLayout(cls.CONTENT_TABLE_CLASS);\n        this.setAriaAttributes(tbl);\n        wrap.appendChild(tbl);\n        var tBody = tbl.querySelector('tbody');\n        var agendaDate = util.resetTime(this.parent.selectedDate);\n        this.renderEmptyContent(tBody, agendaDate);\n        this.wireEvents();\n        if (this.parent.resourceBase) {\n            this.parent.resourceBase.generateResourceLevels([{ renderDates: this.parent.activeView.renderDates }]);\n        }\n        if (this.parent.uiStateValues.isGroupAdaptive && !this.parent.element.querySelector('.' + cls.RESOURCE_TOOLBAR_CONTAINER)) {\n            this.renderResourceMobileLayout();\n        }\n        this.parent.notify(event.contentReady, {});\n    };\n    Agenda.prototype.eventLoad = function (args) {\n        this.dataSource = extend([], this.parent.eventsData, null, true);\n        for (var _i = 0, _a = this.parent.eventsData; _i < _a.length; _i++) {\n            var event_1 = _a[_i];\n            delete event_1.generatedDates;\n        }\n        var eventCollection = this.parent.activeViewOptions.allowVirtualScrolling ?\n            args.processedData : this.parent.eventsProcessed;\n        if (this.parent.uiStateValues.isGroupAdaptive) {\n            var resource = this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex];\n            this.dataSource = this.parent.eventBase.filterEventsByResource(resource, this.dataSource);\n            eventCollection = this.parent.eventBase.filterEventsByResource(resource, eventCollection);\n        }\n        this.parent.eventsProcessed = this.processAgendaEvents(eventCollection);\n        var agendaDate = util.resetTime(this.parent.selectedDate);\n        var tBody = this.element.querySelector('.' + cls.CONTENT_TABLE_CLASS + ' tbody');\n        util.removeChildren(tBody);\n        this.renderInitialContent(tBody, agendaDate);\n        this.wireEventActions();\n        var contentArea = closest(tBody, '.' + cls.CONTENT_WRAP_CLASS);\n        contentArea.scrollTop = 1;\n        this.parent.notify(event.eventsLoaded, {});\n        if (!this.parent.activeViewOptions.allowVirtualScrolling) {\n            this.retainScrollPosition();\n        }\n    };\n    Agenda.prototype.refreshEvent = function (refreshDate) {\n        var processedData = [];\n        var fields = this.parent.eventFields;\n        for (var _i = 0, _a = this.dataSource; _i < _a.length; _i++) {\n            var data = _a[_i];\n            if (isNullOrUndefined(data[fields.recurrenceID]) && !isNullOrUndefined(data[fields.recurrenceRule]) &&\n                !isNullOrUndefined(data.generatedDates) && refreshDate >= data.generatedDates.end) {\n                processedData = processedData.concat(this.parent.eventBase.generateOccurrence(data, refreshDate));\n            }\n        }\n        this.parent.eventsProcessed = this.parent.eventsProcessed.concat(this.processAgendaEvents(processedData));\n    };\n    Agenda.prototype.refreshHeader = function () {\n        var tBody = this.element.querySelector('.' + cls.CONTENT_TABLE_CLASS + ' tbody');\n        if (this.parent.activeViewOptions.group.byDate) {\n            util.removeChildren(tBody);\n        }\n        else {\n            remove(tBody.firstElementChild);\n        }\n        var agendaDate = util.resetTime(this.parent.selectedDate);\n        var emptyTBody = createElement('tbody');\n        var firstDate = new Date(agendaDate.getTime());\n        var lastDate = (this.parent.activeViewOptions.allowVirtualScrolling && this.parent.hideEmptyAgendaDays) ?\n            this.getEndDateFromStartDate(firstDate) : util.addDays(firstDate, this.parent.agendaDaysCount);\n        this.renderContent(emptyTBody, firstDate, lastDate);\n        append([].slice.call(emptyTBody.childNodes), tBody);\n    };\n    Agenda.prototype.renderInitialContent = function (tBody, agendaDate) {\n        var emptyTBody = createElement('tbody');\n        var firstDate = new Date(agendaDate.getTime());\n        var lastDate = (this.parent.activeViewOptions.allowVirtualScrolling && this.parent.hideEmptyAgendaDays) ?\n            this.getEndDateFromStartDate(firstDate) : util.addDays(firstDate, this.parent.agendaDaysCount);\n        this.renderContent(emptyTBody, firstDate, lastDate);\n        append([].slice.call(emptyTBody.childNodes), tBody);\n        // Initial rendering, to load previous date events upto scroll bar enable\n        if (this.parent.activeViewOptions.allowVirtualScrolling && this.parent.hideEmptyAgendaDays && this.parent.eventsData.length > 0) {\n            var contentArea = this.getContentAreaElement();\n            var contentChild = contentArea.querySelector('.e-content-table');\n            while (contentArea.offsetWidth <= contentArea.clientWidth) {\n                if (this.parent.isAdaptive && contentChild.offsetHeight >= contentArea.clientHeight) {\n                    break;\n                }\n                var emptyTBody_1 = createElement('tbody');\n                lastDate = firstDate;\n                firstDate = util.addDays(lastDate, -this.parent.agendaDaysCount);\n                this.renderContent(emptyTBody_1, firstDate, lastDate);\n                prepend([].slice.call(emptyTBody_1.childNodes), tBody);\n                if (firstDate <= this.parent.minDate) {\n                    break;\n                }\n            }\n        }\n        if (tBody.childNodes.length <= 0) {\n            this.renderEmptyContent(tBody, agendaDate);\n        }\n    };\n    Agenda.prototype.renderContent = function (tBody, agendaDate, lastDate) {\n        var fieldMapping = this.parent.eventFields;\n        var firstDate = new Date(agendaDate.getTime());\n        var isObject = this.appointmentFiltering(firstDate, lastDate);\n        if (isObject.length > 0 && this.parent.activeViewOptions.allowVirtualScrolling && this.parent.hideEmptyAgendaDays) {\n            agendaDate = isObject[0][fieldMapping.startTime];\n            agendaDate = new Date(new Date(agendaDate.getTime()).setHours(0, 0, 0, 0));\n            this.updateHeaderText(isObject[0][fieldMapping.startTime]);\n        }\n        var endDate;\n        if (!this.parent.hideEmptyAgendaDays || (this.parent.agendaDaysCount > 0 && isObject.length > 0)) {\n            if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n                var date = agendaDate;\n                if (!this.parent.activeViewOptions.group.byDate) {\n                    this.parent.activeViewOptions.allowVirtualScrolling = false;\n                    date = firstDate;\n                    if (this.parent.headerModule) {\n                        this.parent.headerModule.updateDateRange(this.parent.activeView.getDateRangeText());\n                        this.parent.headerModule.updateHeaderItems('remove');\n                    }\n                }\n                this.calculateResourceTableElement(tBody, this.parent.agendaDaysCount, date);\n            }\n            else {\n                for (var day = 0; day < this.parent.agendaDaysCount; day++) {\n                    var filterData = this.appointmentFiltering(agendaDate);\n                    var nTr = this.createTableRowElement(agendaDate, 'data');\n                    if (this.element.querySelector('tr[data-row-index=\"' + parseInt(nTr.getAttribute('data-row-index'), 10) + '\"]')) {\n                        agendaDate = util.addDays(agendaDate, 1);\n                        continue;\n                    }\n                    var dTd = nTr.children[0];\n                    var aTd = nTr.children[1];\n                    if (filterData.length > 0 || (!this.parent.hideEmptyAgendaDays && filterData.length === 0)) {\n                        var elementType = (!this.parent.hideEmptyAgendaDays && filterData.length === 0) ? 'noEvents' : 'data';\n                        dTd.appendChild(this.createDateHeaderElement(agendaDate));\n                        nTr.appendChild(dTd);\n                        var cTd = this.createAgendaContentElement(elementType, filterData, aTd);\n                        nTr.appendChild(cTd);\n                        if (cTd.querySelectorAll('li').length > 0) {\n                            tBody.appendChild(nTr);\n                        }\n                    }\n                    else if (this.parent.activeViewOptions.allowVirtualScrolling) {\n                        day--;\n                    }\n                    if (this.isCurrentDate(new Date(agendaDate.getTime()))) {\n                        addClass(dTd.childNodes, cls.AGENDA_CURRENT_DAY_CLASS);\n                    }\n                    agendaDate = util.addDays(agendaDate, 1);\n                    if (agendaDate.getTime() > lastDate.getTime()) {\n                        break;\n                    }\n                }\n            }\n            endDate = new Date(agendaDate.getTime() - util.MS_PER_DAY);\n        }\n        this.agendaDates = { start: firstDate, end: endDate };\n    };\n    Agenda.prototype.agendaScrolling = function (event) {\n        if (this.parent.quickPopup) {\n            this.parent.quickPopup.quickPopupHide();\n        }\n        if (this.parent.activeViewOptions.allowVirtualScrolling) {\n            this.virtualScrolling(event);\n        }\n        if (!this.parent.activeViewOptions.allowVirtualScrolling) {\n            this.setPersistence();\n        }\n    };\n    Agenda.prototype.virtualScrolling = function (event) {\n        var target = event.target;\n        var scrollTop = target.scrollTop;\n        var scrollHeight = target.scrollHeight;\n        var offsetHeight = target.clientHeight;\n        var totalHeight = scrollTop + offsetHeight;\n        var direction = (this.virtualScrollTop < scrollTop) ? 'next' : 'previous';\n        var tBody = target.querySelector('tbody');\n        var emptyTBody = createElement('tbody');\n        var topElement = this.getElementFromScrollerPosition(event);\n        var scrollDate = this.parent.getDateFromElement(topElement);\n        var filterDate;\n        var filterData;\n        if (scrollTop === 0) {\n            filterDate = this.getPreviousNextDate(util.addDays(scrollDate, -1), direction);\n            filterData = this.appointmentFiltering(filterDate.start, filterDate.end);\n            if (filterData.length > 0 || !this.parent.hideEmptyAgendaDays) {\n                this.renderContent(emptyTBody, filterDate.start, filterDate.end);\n                prepend([].slice.call(emptyTBody.childNodes), tBody);\n                this.wireEventActions();\n                for (var s = 0, element = tBody.children; s < element.length; s++) {\n                    if (element[s].getAttribute('data-row-index') === topElement.getAttribute('data-column-index')) {\n                        var scrollToValue = element[s].offsetTop -\n                            this.element.querySelector('.e-agenda-item').offsetHeight;\n                        target.scrollTop = scrollToValue;\n                        break;\n                    }\n                }\n                this.updateHeaderText(scrollDate);\n            }\n        }\n        else if (totalHeight >= (scrollHeight - 5)) {\n            filterDate = this.getPreviousNextDate(util.addDays(scrollDate, 1), direction);\n            filterData = this.appointmentFiltering(filterDate.start, filterDate.end);\n            if (filterData.length > 0 || !this.parent.hideEmptyAgendaDays) {\n                this.renderContent(emptyTBody, filterDate.start, filterDate.end);\n                append([].slice.call(emptyTBody.childNodes), tBody);\n                this.wireEventActions();\n                this.updateHeaderText(scrollDate);\n            }\n        }\n        else {\n            this.updateHeaderText(scrollDate);\n        }\n        this.virtualScrollTop = scrollTop;\n        var selectedElements = this.parent.eventBase.getSelectedAppointments();\n        if (selectedElements.length > 0) {\n            selectedElements[selectedElements.length - 1].focus();\n        }\n    };\n    Agenda.prototype.getElementFromScrollerPosition = function (event) {\n        var filterElement;\n        var target = event.target;\n        var scrollTop = target.scrollTop;\n        var scrollHeight = target.scrollHeight;\n        var offsetHeight = target.clientHeight;\n        var totalHeight = scrollTop + offsetHeight;\n        var liCollection = [].slice.call(target.querySelectorAll('.e-agenda-item'));\n        var li;\n        var liDetails;\n        if (liCollection.length > 0) {\n            if (scrollTop === 0) {\n                li = liCollection[0];\n                filterElement = closest(li, '.' + cls.AGENDA_CELLS_CLASS);\n            }\n            else if (totalHeight === scrollHeight) {\n                li = liCollection[liCollection.length - 1];\n                filterElement = closest(li, '.' + cls.AGENDA_CELLS_CLASS);\n            }\n            else {\n                for (var a = 0, length_1 = liCollection.length; a < length_1; a++) {\n                    li = liCollection[a];\n                    liDetails = li.getBoundingClientRect();\n                    if (liDetails.top >= 0) {\n                        filterElement = closest(li, '.' + cls.AGENDA_CELLS_CLASS);\n                        break;\n                    }\n                }\n            }\n        }\n        return filterElement;\n    };\n    Agenda.prototype.updateHeaderText = function (date) {\n        if (this.parent.showHeaderBar) {\n            this.parent.headerModule.updateDateRange(this.getDateRangeText(date));\n        }\n    };\n    Agenda.prototype.getPreviousNextDate = function (date, type) {\n        var currentDate = new Date(date.getTime());\n        var firstDate = this.getStartDateFromEndDate(date);\n        var lastDate = this.getEndDateFromStartDate(date);\n        var daysCount = 0;\n        do {\n            var filterData = this.appointmentFiltering(currentDate);\n            if (filterData.length > 0 || !this.parent.hideEmptyAgendaDays) {\n                daysCount++;\n            }\n            currentDate = util.addDays(currentDate, (type === 'next') ? 1 : -1);\n            if (currentDate < firstDate || currentDate > lastDate) {\n                break;\n            }\n        } while (daysCount !== this.parent.agendaDaysCount);\n        var endDate = util.addDays(currentDate, (type === 'next') ? -1 : 1);\n        return (type === 'next') ? { start: date, end: util.addDays(endDate, 1) } : { start: endDate, end: util.addDays(date, 1) };\n    };\n    Agenda.prototype.appointmentFiltering = function (startDate, endDate) {\n        var dateStart;\n        var dateEnd;\n        if (!isNullOrUndefined(startDate) && isNullOrUndefined(endDate)) {\n            dateStart = util.resetTime(new Date(startDate.getTime()));\n            dateEnd = util.setTime(new Date(dateStart.getTime()), util.MS_PER_DAY);\n        }\n        else {\n            dateStart = new Date(startDate.getTime());\n            dateEnd = new Date(endDate.getTime());\n        }\n        var filterData = this.parent.eventBase.filterEvents(dateStart, dateEnd);\n        if (filterData.length === 0) {\n            this.refreshEvent(startDate);\n            filterData = this.parent.eventBase.filterEvents(dateStart, dateEnd);\n        }\n        return filterData;\n    };\n    Agenda.prototype.getStartDateFromEndDate = function (endDate) {\n        var filterDate;\n        var fields = this.parent.eventFields;\n        if (this.parent.eventsProcessed.length > 0) {\n            var firstDate = Math.min.apply(Math, this.parent.eventsProcessed.map(function (a) {\n                return a[fields.startTime].getTime();\n            }));\n            filterDate = this.parent.hideEmptyAgendaDays ? new Date(firstDate) : this.parent.minDate;\n        }\n        else {\n            filterDate = this.parent.hideEmptyAgendaDays ? util.addMonths(endDate, -1) : this.parent.minDate;\n        }\n        return util.resetTime(filterDate);\n    };\n    Agenda.prototype.getEndDateFromStartDate = function (startDate) {\n        var filterDate;\n        var fieldMapping = this.parent.eventFields;\n        if (this.parent.eventsProcessed.length > 0) {\n            var lastDate = Math.max.apply(Math, this.parent.eventsProcessed.map(function (a) {\n                return a[fieldMapping.endTime].getTime();\n            }));\n            filterDate = this.parent.hideEmptyAgendaDays ? new Date(lastDate) : this.parent.maxDate;\n        }\n        else {\n            filterDate = this.parent.hideEmptyAgendaDays ? util.addMonths(startDate, 1) : this.parent.maxDate;\n        }\n        return util.resetTime(util.addDays(filterDate, 1));\n    };\n    Agenda.prototype.getNextPreviousDate = function (type) {\n        var noOfDays = (type === 'next') ? 1 : -1;\n        return util.addDays(this.parent.selectedDate, noOfDays);\n    };\n    Agenda.prototype.startDate = function () {\n        return util.resetTime(this.parent.selectedDate);\n    };\n    Agenda.prototype.endDate = function () {\n        if (this.parent.activeViewOptions.allowVirtualScrolling) {\n            return this.getEndDateFromStartDate(this.startDate());\n        }\n        else {\n            return util.addDays(this.startDate(), this.parent.agendaDaysCount);\n        }\n    };\n    Agenda.prototype.getDateRangeText = function (date) {\n        var formatDate = (this.parent.activeViewOptions.dateFormat) ? this.parent.activeViewOptions.dateFormat : 'MMMM y';\n        if (this.parent.activeViewOptions.allowVirtualScrolling || this.parent.isAdaptive) {\n            var currentDate = isNullOrUndefined(date) ? this.parent.selectedDate : date;\n            return util.capitalizeFirstWord(this.parent.globalize.formatDate(currentDate, { format: formatDate, calendar: this.parent.getCalendarMode() }), 'multiple');\n        }\n        else {\n            var startDate = this.parent.selectedDate;\n            var endDate = util.addDays(startDate, this.parent.agendaDaysCount - 1);\n            return this.formatDateRange(startDate, endDate);\n        }\n    };\n    Agenda.prototype.dayNavigationClick = function (e) {\n        var element = closest(e.currentTarget, '.' + cls.AGENDA_CELLS_CLASS);\n        var date = this.parent.getDateFromElement(element);\n        if (!isNullOrUndefined(date) && !this.parent.isAdaptive && this.parent.isMinMaxDate(date)) {\n            this.parent.setProperties({ selectedDate: date }, true);\n            this.parent.changeView('Day', e);\n        }\n    };\n    Agenda.prototype.wireEvents = function () {\n        EventHandler.add(this.element.querySelector('.' + cls.CONTENT_WRAP_CLASS), event.scroll, this.agendaScrolling, this);\n    };\n    Agenda.prototype.unWireEvents = function () {\n        EventHandler.remove(this.element.querySelector('.' + cls.CONTENT_WRAP_CLASS), event.scroll, this.agendaScrolling);\n        var dateHeaderElement = [].slice.call(this.element.querySelectorAll('.e-m-date'));\n        for (var _i = 0, dateHeaderElement_1 = dateHeaderElement; _i < dateHeaderElement_1.length; _i++) {\n            var element = dateHeaderElement_1[_i];\n            EventHandler.remove(element, 'click', this.dayNavigationClick);\n        }\n    };\n    Agenda.prototype.addEventListener = function () {\n        this.parent.on(event.scrollUiUpdate, this.onAgendaScrollUiUpdate, this);\n        this.parent.on(event.dataReady, this.eventLoad, this);\n    };\n    Agenda.prototype.removeEventListener = function () {\n        if (this.parent) {\n            this.parent.off(event.scrollUiUpdate, this.onAgendaScrollUiUpdate);\n            this.parent.off(event.dataReady, this.eventLoad);\n        }\n    };\n    Agenda.prototype.onAgendaScrollUiUpdate = function () {\n        var headerHeight = this.getHeaderBarHeight();\n        if (this.parent.headerModule) {\n            if (this.parent.activeViewOptions.allowVirtualScrolling) {\n                this.parent.headerModule.updateHeaderItems('add');\n            }\n            else {\n                this.parent.headerModule.updateHeaderItems('remove');\n            }\n        }\n        var contentArea = this.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n        if (this.parent.height !== 'auto') {\n            contentArea.style.height = formatUnit(this.parent.element.offsetHeight - headerHeight);\n        }\n    };\n    Agenda.prototype.scrollToDate = function (scrollDate) {\n        var date = new Date(+util.resetTime(scrollDate));\n        if (this.parent.activeViewOptions.allowVirtualScrolling) {\n            if (!this.parent.hideEmptyAgendaDays || this.parent.getEvents(date, util.addDays(date, 1), true).length > 0) {\n                this.parent.changeDate(date);\n            }\n        }\n        else {\n            var dateElement = this.element.querySelector('.' + cls.AGENDA_CELLS_CLASS + '[data-date=\"' + date.getTime() + '\"]');\n            if (dateElement) {\n                this.getContentAreaElement().scrollTop = dateElement.offsetTop;\n            }\n        }\n    };\n    Agenda.prototype.destroy = function () {\n        if (!this.parent || this.parent && this.parent.isDestroyed) {\n            return;\n        }\n        if (this.element) {\n            this.unWireEvents();\n            if (this.parent.resourceBase) {\n                this.parent.resourceBase.destroy();\n            }\n            if (this.parent.headerModule && this.parent.activeViewOptions.allowVirtualScrolling) {\n                this.parent.headerModule.updateHeaderItems('remove');\n            }\n            _super.prototype.destroy.call(this);\n        }\n    };\n    return Agenda;\n}(AgendaBase));\nexport { Agenda };\n"]},"metadata":{},"sourceType":"module"}