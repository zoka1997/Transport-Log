{"ast":null,"code":"/**\r\n * DevExtreme (esm/ui/selection/selection.js)\r\n * Version: 22.1.6\r\n * Build date: Tue Oct 18 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport Class from \"../../core/class\";\nimport deferredStrategy from \"./selection.strategy.deferred\";\nimport standardStrategy from \"./selection.strategy.standard\";\nimport { extend } from \"../../core/utils/extend\";\nimport { noop } from \"../../core/utils/common\";\nimport { isDefined } from \"../../core/utils/type\";\nimport { Deferred, when } from \"../../core/utils/deferred\";\nexport default Class.inherit({\n  ctor: function (options) {\n    this.options = extend(this._getDefaultOptions(), options, {\n      selectedItemKeys: options.selectedKeys || []\n    });\n    this._selectionStrategy = this.options.deferred ? new deferredStrategy(this.options) : new standardStrategy(this.options);\n    this._focusedItemIndex = -1;\n\n    if (!this.options.equalByReference) {\n      this._selectionStrategy.updateSelectedItemKeyHash(this.options.selectedItemKeys);\n    }\n  },\n  _getDefaultOptions: function () {\n    return {\n      allowNullValue: false,\n      deferred: false,\n      equalByReference: false,\n      mode: \"multiple\",\n      selectedItems: [],\n      selectionFilter: [],\n      maxFilterLengthInRequest: 0,\n      onSelectionChanged: noop,\n      key: noop,\n      keyOf: function (item) {\n        return item;\n      },\n      load: function () {\n        return new Deferred().resolve([]);\n      },\n      totalCount: function () {\n        return -1;\n      },\n      isSelectableItem: function () {\n        return true;\n      },\n      isItemSelected: function () {\n        return false;\n      },\n      getItemData: function (item) {\n        return item;\n      },\n      dataFields: noop,\n      filter: noop\n    };\n  },\n  validate: function () {\n    this._selectionStrategy.validate();\n  },\n  getSelectedItemKeys: function () {\n    return this._selectionStrategy.getSelectedItemKeys();\n  },\n  getSelectedItems: function () {\n    return this._selectionStrategy.getSelectedItems();\n  },\n  selectionFilter: function (value) {\n    if (void 0 === value) {\n      return this.options.selectionFilter;\n    }\n\n    var filterIsChanged = this.options.selectionFilter !== value && JSON.stringify(this.options.selectionFilter) !== JSON.stringify(value);\n    this.options.selectionFilter = value;\n    filterIsChanged && this.onSelectionChanged();\n  },\n  setSelection: function (keys, updatedKeys) {\n    return this.selectedItemKeys(keys, false, false, false, updatedKeys);\n  },\n  select: function (keys) {\n    return this.selectedItemKeys(keys, true);\n  },\n  deselect: function (keys) {\n    return this.selectedItemKeys(keys, true, true);\n  },\n  selectedItemKeys: function (keys, preserve, isDeselect, isSelectAll, updatedKeys) {\n    var _keys;\n\n    keys = null !== (_keys = keys) && void 0 !== _keys ? _keys : [];\n    keys = Array.isArray(keys) ? keys : [keys];\n    this.validate();\n    return this._selectionStrategy.selectedItemKeys(keys, preserve, isDeselect, isSelectAll, updatedKeys);\n  },\n  clearSelection: function () {\n    return this.selectedItemKeys([]);\n  },\n  _addSelectedItem: function (itemData, key) {\n    this._selectionStrategy.addSelectedItem(key, itemData);\n  },\n  _removeSelectedItem: function (key) {\n    this._selectionStrategy.removeSelectedItem(key);\n  },\n  _setSelectedItems: function (keys, items) {\n    this._selectionStrategy.setSelectedItems(keys, items);\n  },\n  onSelectionChanged: function () {\n    this._selectionStrategy.onSelectionChanged();\n  },\n  changeItemSelection: function (itemIndex, keys, setFocusOnly) {\n    var _this$options$allowLo, _this$options;\n\n    var isSelectedItemsChanged;\n    var items = this.options.plainItems();\n    var item = items[itemIndex];\n    var deferred;\n    var allowLoadByRange = null === (_this$options$allowLo = (_this$options = this.options).allowLoadByRange) || void 0 === _this$options$allowLo ? void 0 : _this$options$allowLo.call(_this$options);\n    var indexOffset;\n    var focusedItemNotInLoadedRange = false;\n    var shiftFocusedItemNotInLoadedRange = false;\n\n    var itemIsNotInLoadedRange = index => index >= 0 && !items.filter(it => it.loadIndex === index).length;\n\n    if (allowLoadByRange) {\n      indexOffset = item.loadIndex - itemIndex;\n      itemIndex = item.loadIndex;\n      focusedItemNotInLoadedRange = itemIsNotInLoadedRange(this._focusedItemIndex);\n\n      if (isDefined(this._shiftFocusedItemIndex)) {\n        shiftFocusedItemNotInLoadedRange = itemIsNotInLoadedRange(this._shiftFocusedItemIndex);\n      }\n    }\n\n    if (!this.isSelectable() || !this.isDataItem(item)) {\n      return false;\n    }\n\n    var itemData = this.options.getItemData(item);\n    var itemKey = this.options.keyOf(itemData);\n    keys = keys || {};\n\n    if (keys.shift && \"multiple\" === this.options.mode && this._focusedItemIndex >= 0) {\n      if (focusedItemNotInLoadedRange || shiftFocusedItemNotInLoadedRange) {\n        isSelectedItemsChanged = itemIndex !== this._shiftFocusedItemIndex || this._focusedItemIndex !== this._shiftFocusedItemIndex;\n\n        if (isSelectedItemsChanged) {\n          deferred = this.changeItemSelectionWhenShiftKeyInVirtualPaging(itemIndex);\n        }\n      } else {\n        isSelectedItemsChanged = this.changeItemSelectionWhenShiftKeyPressed(itemIndex, items, indexOffset);\n      }\n    } else if (keys.control) {\n      this._resetItemSelectionWhenShiftKeyPressed();\n\n      if (!setFocusOnly) {\n        var isSelected = this._selectionStrategy.isItemDataSelected(itemData);\n\n        if (\"single\" === this.options.mode) {\n          this.clearSelectedItems();\n        }\n\n        if (isSelected) {\n          this._removeSelectedItem(itemKey);\n        } else {\n          this._addSelectedItem(itemData, itemKey);\n        }\n      }\n\n      isSelectedItemsChanged = true;\n    } else {\n      this._resetItemSelectionWhenShiftKeyPressed();\n\n      var isKeysEqual = this._selectionStrategy.equalKeys(this.options.selectedItemKeys[0], itemKey);\n\n      if (1 !== this.options.selectedItemKeys.length || !isKeysEqual) {\n        this._setSelectedItems([itemKey], [itemData]);\n\n        isSelectedItemsChanged = true;\n      }\n    }\n\n    if (isSelectedItemsChanged) {\n      when(deferred).done(() => {\n        this._focusedItemIndex = itemIndex;\n        !setFocusOnly && this.onSelectionChanged();\n      });\n      return true;\n    }\n  },\n  isDataItem: function (item) {\n    return this.options.isSelectableItem(item);\n  },\n  isSelectable: function () {\n    return \"single\" === this.options.mode || \"multiple\" === this.options.mode;\n  },\n  isItemDataSelected: function (data) {\n    return this._selectionStrategy.isItemDataSelected(data, {\n      checkPending: true\n    });\n  },\n  isItemSelected: function (arg, options) {\n    return this._selectionStrategy.isItemKeySelected(arg, options);\n  },\n  _resetItemSelectionWhenShiftKeyPressed: function () {\n    delete this._shiftFocusedItemIndex;\n  },\n  _resetFocusedItemIndex: function () {\n    this._focusedItemIndex = -1;\n  },\n  changeItemSelectionWhenShiftKeyInVirtualPaging: function (loadIndex) {\n    var loadOptions = this.options.getLoadOptions(loadIndex, this._focusedItemIndex, this._shiftFocusedItemIndex);\n    var deferred = new Deferred();\n    var indexOffset = loadOptions.skip;\n    this.options.load(loadOptions).done(items => {\n      this.changeItemSelectionWhenShiftKeyPressed(loadIndex, items, indexOffset);\n      deferred.resolve();\n    });\n    return deferred.promise();\n  },\n  changeItemSelectionWhenShiftKeyPressed: function (itemIndex, items, indexOffset) {\n    var isSelectedItemsChanged = false;\n    var itemIndexStep;\n    var indexOffsetDefined = isDefined(indexOffset);\n    var index = indexOffsetDefined ? this._focusedItemIndex - indexOffset : this._focusedItemIndex;\n    var keyOf = this.options.keyOf;\n    var focusedItem = items[index];\n    var focusedData = this.options.getItemData(focusedItem);\n    var focusedKey = keyOf(focusedData);\n    var isFocusedItemSelected = focusedItem && this.isItemDataSelected(focusedData);\n\n    if (!isDefined(this._shiftFocusedItemIndex)) {\n      this._shiftFocusedItemIndex = this._focusedItemIndex;\n    }\n\n    var data;\n    var itemKey;\n    var startIndex;\n    var endIndex;\n\n    if (this._shiftFocusedItemIndex !== this._focusedItemIndex) {\n      itemIndexStep = this._focusedItemIndex < this._shiftFocusedItemIndex ? 1 : -1;\n      startIndex = indexOffsetDefined ? this._focusedItemIndex - indexOffset : this._focusedItemIndex;\n      endIndex = indexOffsetDefined ? this._shiftFocusedItemIndex - indexOffset : this._shiftFocusedItemIndex;\n\n      for (index = startIndex; index !== endIndex; index += itemIndexStep) {\n        if (indexOffsetDefined || this.isDataItem(items[index])) {\n          itemKey = keyOf(this.options.getItemData(items[index]));\n\n          this._removeSelectedItem(itemKey);\n\n          isSelectedItemsChanged = true;\n        }\n      }\n    }\n\n    if (itemIndex !== this._shiftFocusedItemIndex) {\n      itemIndexStep = itemIndex < this._shiftFocusedItemIndex ? 1 : -1;\n      startIndex = indexOffsetDefined ? itemIndex - indexOffset : itemIndex;\n      endIndex = indexOffsetDefined ? this._shiftFocusedItemIndex - indexOffset : this._shiftFocusedItemIndex;\n\n      for (index = startIndex; index !== endIndex; index += itemIndexStep) {\n        if (indexOffsetDefined || this.isDataItem(items[index])) {\n          data = this.options.getItemData(items[index]);\n          itemKey = keyOf(data);\n\n          this._addSelectedItem(data, itemKey);\n\n          isSelectedItemsChanged = true;\n        }\n      }\n    }\n\n    if ((indexOffsetDefined || this.isDataItem(focusedItem)) && !isFocusedItemSelected) {\n      this._addSelectedItem(focusedData, focusedKey);\n\n      isSelectedItemsChanged = true;\n    }\n\n    return isSelectedItemsChanged;\n  },\n  clearSelectedItems: function () {\n    this._setSelectedItems([], []);\n  },\n  selectAll: function (isOnePage) {\n    this._resetFocusedItemIndex();\n\n    if (isOnePage) {\n      return this._onePageSelectAll(false);\n    } else {\n      return this.selectedItemKeys([], true, false, true);\n    }\n  },\n  deselectAll: function (isOnePage) {\n    this._resetFocusedItemIndex();\n\n    if (isOnePage) {\n      return this._onePageSelectAll(true);\n    } else {\n      return this.selectedItemKeys([], true, true, true);\n    }\n  },\n  _onePageSelectAll: function (isDeselect) {\n    var items = this._selectionStrategy.getSelectableItems(this.options.plainItems());\n\n    for (var i = 0; i < items.length; i++) {\n      var item = items[i];\n\n      if (this.isDataItem(item)) {\n        var itemData = this.options.getItemData(item);\n        var itemKey = this.options.keyOf(itemData);\n        var isSelected = this.isItemSelected(itemKey);\n\n        if (!isSelected && !isDeselect) {\n          this._addSelectedItem(itemData, itemKey);\n        }\n\n        if (isSelected && isDeselect) {\n          this._removeSelectedItem(itemKey);\n        }\n      }\n    }\n\n    this.onSelectionChanged();\n    return new Deferred().resolve();\n  },\n  getSelectAllState: function (visibleOnly) {\n    return this._selectionStrategy.getSelectAllState(visibleOnly);\n  }\n});","map":{"version":3,"sources":["C:/Users/Zoran/source/repos/TransportApp/TransportLog-basic/node_modules/devextreme/esm/ui/selection/selection.js"],"names":["Class","deferredStrategy","standardStrategy","extend","noop","isDefined","Deferred","when","inherit","ctor","options","_getDefaultOptions","selectedItemKeys","selectedKeys","_selectionStrategy","deferred","_focusedItemIndex","equalByReference","updateSelectedItemKeyHash","allowNullValue","mode","selectedItems","selectionFilter","maxFilterLengthInRequest","onSelectionChanged","key","keyOf","item","load","resolve","totalCount","isSelectableItem","isItemSelected","getItemData","dataFields","filter","validate","getSelectedItemKeys","getSelectedItems","value","filterIsChanged","JSON","stringify","setSelection","keys","updatedKeys","select","deselect","preserve","isDeselect","isSelectAll","_keys","Array","isArray","clearSelection","_addSelectedItem","itemData","addSelectedItem","_removeSelectedItem","removeSelectedItem","_setSelectedItems","items","setSelectedItems","changeItemSelection","itemIndex","setFocusOnly","_this$options$allowLo","_this$options","isSelectedItemsChanged","plainItems","allowLoadByRange","call","indexOffset","focusedItemNotInLoadedRange","shiftFocusedItemNotInLoadedRange","itemIsNotInLoadedRange","index","it","loadIndex","length","_shiftFocusedItemIndex","isSelectable","isDataItem","itemKey","shift","changeItemSelectionWhenShiftKeyInVirtualPaging","changeItemSelectionWhenShiftKeyPressed","control","_resetItemSelectionWhenShiftKeyPressed","isSelected","isItemDataSelected","clearSelectedItems","isKeysEqual","equalKeys","done","data","checkPending","arg","isItemKeySelected","_resetFocusedItemIndex","loadOptions","getLoadOptions","skip","promise","itemIndexStep","indexOffsetDefined","focusedItem","focusedData","focusedKey","isFocusedItemSelected","startIndex","endIndex","selectAll","isOnePage","_onePageSelectAll","deselectAll","getSelectableItems","i","getSelectAllState","visibleOnly"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (esm/ui/selection/selection.js)\r\n * Version: 22.1.6\r\n * Build date: Tue Oct 18 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport Class from \"../../core/class\";\r\nimport deferredStrategy from \"./selection.strategy.deferred\";\r\nimport standardStrategy from \"./selection.strategy.standard\";\r\nimport {\r\n    extend\r\n} from \"../../core/utils/extend\";\r\nimport {\r\n    noop\r\n} from \"../../core/utils/common\";\r\nimport {\r\n    isDefined\r\n} from \"../../core/utils/type\";\r\nimport {\r\n    Deferred,\r\n    when\r\n} from \"../../core/utils/deferred\";\r\nexport default Class.inherit({\r\n    ctor: function(options) {\r\n        this.options = extend(this._getDefaultOptions(), options, {\r\n            selectedItemKeys: options.selectedKeys || []\r\n        });\r\n        this._selectionStrategy = this.options.deferred ? new deferredStrategy(this.options) : new standardStrategy(this.options);\r\n        this._focusedItemIndex = -1;\r\n        if (!this.options.equalByReference) {\r\n            this._selectionStrategy.updateSelectedItemKeyHash(this.options.selectedItemKeys)\r\n        }\r\n    },\r\n    _getDefaultOptions: function() {\r\n        return {\r\n            allowNullValue: false,\r\n            deferred: false,\r\n            equalByReference: false,\r\n            mode: \"multiple\",\r\n            selectedItems: [],\r\n            selectionFilter: [],\r\n            maxFilterLengthInRequest: 0,\r\n            onSelectionChanged: noop,\r\n            key: noop,\r\n            keyOf: function(item) {\r\n                return item\r\n            },\r\n            load: function() {\r\n                return (new Deferred).resolve([])\r\n            },\r\n            totalCount: function() {\r\n                return -1\r\n            },\r\n            isSelectableItem: function() {\r\n                return true\r\n            },\r\n            isItemSelected: function() {\r\n                return false\r\n            },\r\n            getItemData: function(item) {\r\n                return item\r\n            },\r\n            dataFields: noop,\r\n            filter: noop\r\n        }\r\n    },\r\n    validate: function() {\r\n        this._selectionStrategy.validate()\r\n    },\r\n    getSelectedItemKeys: function() {\r\n        return this._selectionStrategy.getSelectedItemKeys()\r\n    },\r\n    getSelectedItems: function() {\r\n        return this._selectionStrategy.getSelectedItems()\r\n    },\r\n    selectionFilter: function(value) {\r\n        if (void 0 === value) {\r\n            return this.options.selectionFilter\r\n        }\r\n        var filterIsChanged = this.options.selectionFilter !== value && JSON.stringify(this.options.selectionFilter) !== JSON.stringify(value);\r\n        this.options.selectionFilter = value;\r\n        filterIsChanged && this.onSelectionChanged()\r\n    },\r\n    setSelection: function(keys, updatedKeys) {\r\n        return this.selectedItemKeys(keys, false, false, false, updatedKeys)\r\n    },\r\n    select: function(keys) {\r\n        return this.selectedItemKeys(keys, true)\r\n    },\r\n    deselect: function(keys) {\r\n        return this.selectedItemKeys(keys, true, true)\r\n    },\r\n    selectedItemKeys: function(keys, preserve, isDeselect, isSelectAll, updatedKeys) {\r\n        var _keys;\r\n        keys = null !== (_keys = keys) && void 0 !== _keys ? _keys : [];\r\n        keys = Array.isArray(keys) ? keys : [keys];\r\n        this.validate();\r\n        return this._selectionStrategy.selectedItemKeys(keys, preserve, isDeselect, isSelectAll, updatedKeys)\r\n    },\r\n    clearSelection: function() {\r\n        return this.selectedItemKeys([])\r\n    },\r\n    _addSelectedItem: function(itemData, key) {\r\n        this._selectionStrategy.addSelectedItem(key, itemData)\r\n    },\r\n    _removeSelectedItem: function(key) {\r\n        this._selectionStrategy.removeSelectedItem(key)\r\n    },\r\n    _setSelectedItems: function(keys, items) {\r\n        this._selectionStrategy.setSelectedItems(keys, items)\r\n    },\r\n    onSelectionChanged: function() {\r\n        this._selectionStrategy.onSelectionChanged()\r\n    },\r\n    changeItemSelection: function(itemIndex, keys, setFocusOnly) {\r\n        var _this$options$allowLo, _this$options;\r\n        var isSelectedItemsChanged;\r\n        var items = this.options.plainItems();\r\n        var item = items[itemIndex];\r\n        var deferred;\r\n        var allowLoadByRange = null === (_this$options$allowLo = (_this$options = this.options).allowLoadByRange) || void 0 === _this$options$allowLo ? void 0 : _this$options$allowLo.call(_this$options);\r\n        var indexOffset;\r\n        var focusedItemNotInLoadedRange = false;\r\n        var shiftFocusedItemNotInLoadedRange = false;\r\n        var itemIsNotInLoadedRange = index => index >= 0 && !items.filter(it => it.loadIndex === index).length;\r\n        if (allowLoadByRange) {\r\n            indexOffset = item.loadIndex - itemIndex;\r\n            itemIndex = item.loadIndex;\r\n            focusedItemNotInLoadedRange = itemIsNotInLoadedRange(this._focusedItemIndex);\r\n            if (isDefined(this._shiftFocusedItemIndex)) {\r\n                shiftFocusedItemNotInLoadedRange = itemIsNotInLoadedRange(this._shiftFocusedItemIndex)\r\n            }\r\n        }\r\n        if (!this.isSelectable() || !this.isDataItem(item)) {\r\n            return false\r\n        }\r\n        var itemData = this.options.getItemData(item);\r\n        var itemKey = this.options.keyOf(itemData);\r\n        keys = keys || {};\r\n        if (keys.shift && \"multiple\" === this.options.mode && this._focusedItemIndex >= 0) {\r\n            if (focusedItemNotInLoadedRange || shiftFocusedItemNotInLoadedRange) {\r\n                isSelectedItemsChanged = itemIndex !== this._shiftFocusedItemIndex || this._focusedItemIndex !== this._shiftFocusedItemIndex;\r\n                if (isSelectedItemsChanged) {\r\n                    deferred = this.changeItemSelectionWhenShiftKeyInVirtualPaging(itemIndex)\r\n                }\r\n            } else {\r\n                isSelectedItemsChanged = this.changeItemSelectionWhenShiftKeyPressed(itemIndex, items, indexOffset)\r\n            }\r\n        } else if (keys.control) {\r\n            this._resetItemSelectionWhenShiftKeyPressed();\r\n            if (!setFocusOnly) {\r\n                var isSelected = this._selectionStrategy.isItemDataSelected(itemData);\r\n                if (\"single\" === this.options.mode) {\r\n                    this.clearSelectedItems()\r\n                }\r\n                if (isSelected) {\r\n                    this._removeSelectedItem(itemKey)\r\n                } else {\r\n                    this._addSelectedItem(itemData, itemKey)\r\n                }\r\n            }\r\n            isSelectedItemsChanged = true\r\n        } else {\r\n            this._resetItemSelectionWhenShiftKeyPressed();\r\n            var isKeysEqual = this._selectionStrategy.equalKeys(this.options.selectedItemKeys[0], itemKey);\r\n            if (1 !== this.options.selectedItemKeys.length || !isKeysEqual) {\r\n                this._setSelectedItems([itemKey], [itemData]);\r\n                isSelectedItemsChanged = true\r\n            }\r\n        }\r\n        if (isSelectedItemsChanged) {\r\n            when(deferred).done(() => {\r\n                this._focusedItemIndex = itemIndex;\r\n                !setFocusOnly && this.onSelectionChanged()\r\n            });\r\n            return true\r\n        }\r\n    },\r\n    isDataItem: function(item) {\r\n        return this.options.isSelectableItem(item)\r\n    },\r\n    isSelectable: function() {\r\n        return \"single\" === this.options.mode || \"multiple\" === this.options.mode\r\n    },\r\n    isItemDataSelected: function(data) {\r\n        return this._selectionStrategy.isItemDataSelected(data, {\r\n            checkPending: true\r\n        })\r\n    },\r\n    isItemSelected: function(arg, options) {\r\n        return this._selectionStrategy.isItemKeySelected(arg, options)\r\n    },\r\n    _resetItemSelectionWhenShiftKeyPressed: function() {\r\n        delete this._shiftFocusedItemIndex\r\n    },\r\n    _resetFocusedItemIndex: function() {\r\n        this._focusedItemIndex = -1\r\n    },\r\n    changeItemSelectionWhenShiftKeyInVirtualPaging: function(loadIndex) {\r\n        var loadOptions = this.options.getLoadOptions(loadIndex, this._focusedItemIndex, this._shiftFocusedItemIndex);\r\n        var deferred = new Deferred;\r\n        var indexOffset = loadOptions.skip;\r\n        this.options.load(loadOptions).done(items => {\r\n            this.changeItemSelectionWhenShiftKeyPressed(loadIndex, items, indexOffset);\r\n            deferred.resolve()\r\n        });\r\n        return deferred.promise()\r\n    },\r\n    changeItemSelectionWhenShiftKeyPressed: function(itemIndex, items, indexOffset) {\r\n        var isSelectedItemsChanged = false;\r\n        var itemIndexStep;\r\n        var indexOffsetDefined = isDefined(indexOffset);\r\n        var index = indexOffsetDefined ? this._focusedItemIndex - indexOffset : this._focusedItemIndex;\r\n        var keyOf = this.options.keyOf;\r\n        var focusedItem = items[index];\r\n        var focusedData = this.options.getItemData(focusedItem);\r\n        var focusedKey = keyOf(focusedData);\r\n        var isFocusedItemSelected = focusedItem && this.isItemDataSelected(focusedData);\r\n        if (!isDefined(this._shiftFocusedItemIndex)) {\r\n            this._shiftFocusedItemIndex = this._focusedItemIndex\r\n        }\r\n        var data;\r\n        var itemKey;\r\n        var startIndex;\r\n        var endIndex;\r\n        if (this._shiftFocusedItemIndex !== this._focusedItemIndex) {\r\n            itemIndexStep = this._focusedItemIndex < this._shiftFocusedItemIndex ? 1 : -1;\r\n            startIndex = indexOffsetDefined ? this._focusedItemIndex - indexOffset : this._focusedItemIndex;\r\n            endIndex = indexOffsetDefined ? this._shiftFocusedItemIndex - indexOffset : this._shiftFocusedItemIndex;\r\n            for (index = startIndex; index !== endIndex; index += itemIndexStep) {\r\n                if (indexOffsetDefined || this.isDataItem(items[index])) {\r\n                    itemKey = keyOf(this.options.getItemData(items[index]));\r\n                    this._removeSelectedItem(itemKey);\r\n                    isSelectedItemsChanged = true\r\n                }\r\n            }\r\n        }\r\n        if (itemIndex !== this._shiftFocusedItemIndex) {\r\n            itemIndexStep = itemIndex < this._shiftFocusedItemIndex ? 1 : -1;\r\n            startIndex = indexOffsetDefined ? itemIndex - indexOffset : itemIndex;\r\n            endIndex = indexOffsetDefined ? this._shiftFocusedItemIndex - indexOffset : this._shiftFocusedItemIndex;\r\n            for (index = startIndex; index !== endIndex; index += itemIndexStep) {\r\n                if (indexOffsetDefined || this.isDataItem(items[index])) {\r\n                    data = this.options.getItemData(items[index]);\r\n                    itemKey = keyOf(data);\r\n                    this._addSelectedItem(data, itemKey);\r\n                    isSelectedItemsChanged = true\r\n                }\r\n            }\r\n        }\r\n        if ((indexOffsetDefined || this.isDataItem(focusedItem)) && !isFocusedItemSelected) {\r\n            this._addSelectedItem(focusedData, focusedKey);\r\n            isSelectedItemsChanged = true\r\n        }\r\n        return isSelectedItemsChanged\r\n    },\r\n    clearSelectedItems: function() {\r\n        this._setSelectedItems([], [])\r\n    },\r\n    selectAll: function(isOnePage) {\r\n        this._resetFocusedItemIndex();\r\n        if (isOnePage) {\r\n            return this._onePageSelectAll(false)\r\n        } else {\r\n            return this.selectedItemKeys([], true, false, true)\r\n        }\r\n    },\r\n    deselectAll: function(isOnePage) {\r\n        this._resetFocusedItemIndex();\r\n        if (isOnePage) {\r\n            return this._onePageSelectAll(true)\r\n        } else {\r\n            return this.selectedItemKeys([], true, true, true)\r\n        }\r\n    },\r\n    _onePageSelectAll: function(isDeselect) {\r\n        var items = this._selectionStrategy.getSelectableItems(this.options.plainItems());\r\n        for (var i = 0; i < items.length; i++) {\r\n            var item = items[i];\r\n            if (this.isDataItem(item)) {\r\n                var itemData = this.options.getItemData(item);\r\n                var itemKey = this.options.keyOf(itemData);\r\n                var isSelected = this.isItemSelected(itemKey);\r\n                if (!isSelected && !isDeselect) {\r\n                    this._addSelectedItem(itemData, itemKey)\r\n                }\r\n                if (isSelected && isDeselect) {\r\n                    this._removeSelectedItem(itemKey)\r\n                }\r\n            }\r\n        }\r\n        this.onSelectionChanged();\r\n        return (new Deferred).resolve()\r\n    },\r\n    getSelectAllState: function(visibleOnly) {\r\n        return this._selectionStrategy.getSelectAllState(visibleOnly)\r\n    }\r\n});\r\n"]},"metadata":{},"sourceType":"module"}