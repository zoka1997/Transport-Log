{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nimport { isNullOrUndefined, createElement, prepend, extend, formatUnit, append, setStyleAttribute } from '@syncfusion/ej2-base';\nimport { VerticalView } from './vertical-view';\nimport { TimelineEvent } from '../event-renderer/timeline-view';\nimport { TimelineHeaderRow } from './timeline-header-row';\nimport * as event from '../base/constant';\nimport * as cls from '../base/css-constant';\nimport * as util from '../base/util';\n/**\n * timeline views\n */\n\nvar TimelineViews =\n/** @class */\nfunction (_super) {\n  __extends(TimelineViews, _super);\n\n  function TimelineViews(parent) {\n    var _this = _super.call(this, parent) || this;\n\n    _this.timelineAppointment = null;\n    _this.baseCssClass = 'e-timeline-view';\n    return _this;\n  }\n\n  TimelineViews.prototype.getModuleName = function () {\n    return 'timelineViews';\n  };\n\n  TimelineViews.prototype.getLeftPanelElement = function () {\n    return this.element.querySelector('.' + cls.RESOURCE_COLUMN_WRAP_CLASS);\n  };\n\n  TimelineViews.prototype.scrollTopPanel = function (target) {\n    _super.prototype.scrollTopPanel.call(this, target);\n\n    this.scrollHeaderLabels(target);\n  };\n\n  TimelineViews.prototype.scrollToWorkHour = function () {\n    var start = this.parent.getStartEndTime(this.parent.workHours.start);\n    var currDateTime = this.isWorkDay(this.parent.selectedDate) && this.parent.workHours.highlight && !isNullOrUndefined(start) ? new Date(+this.parent.selectedDate).setHours(start.getHours(), start.getMinutes(), 0, 0) : new Date(+this.parent.selectedDate).setHours(0, 0, 0, 0);\n    var queryString = '[data-date=\"' + new Date(currDateTime).getTime().toString() + '\"]';\n    var firstWorkHourCell = this.element.querySelector(queryString);\n\n    if (firstWorkHourCell) {\n      this.getContentAreaElement().scrollLeft = !this.parent.enableRtl ? firstWorkHourCell.offsetLeft : -(this.parent.getContentTable().offsetWidth - firstWorkHourCell.offsetLeft - firstWorkHourCell.offsetWidth);\n    }\n  };\n\n  TimelineViews.prototype.scrollToHour = function (hour, scrollDate) {\n    var date;\n    var index;\n\n    if (scrollDate) {\n      index = this.parent.getIndexOfDate(this.renderDates, util.resetTime(scrollDate));\n\n      if (index >= 0) {\n        date = scrollDate;\n\n        if (!isNullOrUndefined(hour)) {\n          var timeString = hour.split(':');\n\n          if (timeString.length === 2) {\n            date = new Date(scrollDate.setHours(parseInt(timeString[0], 10), parseInt(timeString[1], 10), 0));\n          }\n        }\n      }\n    }\n\n    date = isNullOrUndefined(scrollDate) ? this.parent.getStartEndTime(hour) : date;\n\n    if (isNullOrUndefined(date)) {\n      return;\n    }\n\n    var scrollLeft;\n\n    if (isNullOrUndefined(hour) || !this.parent.activeViewOptions.timeScale.enable) {\n      scrollLeft = index * this.getWorkCellWidth();\n    } else {\n      scrollLeft = isNullOrUndefined(scrollDate) ? this.getLeftFromDateTime(null, date) : this.getLeftFromDateTime([index], date);\n    }\n\n    this.getScrollableElement().scrollLeft = !this.parent.enableRtl ? scrollLeft : -scrollLeft;\n  };\n\n  TimelineViews.prototype.generateColumnLevels = function () {\n    var levels = [];\n    var dateSlots = this.getDateSlots(this.renderDates, this.parent.activeViewOptions.workDays);\n    levels.push(dateSlots);\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      this.parent.resourceBase.generateResourceLevels(dateSlots, !this.parent.uiStateValues.isGroupAdaptive);\n    }\n\n    var hourSlots = [];\n\n    if (this.parent.activeViewOptions.timeScale.enable) {\n      hourSlots = this.generateTimeSlots(levels[levels.length - 1]);\n      levels.push(hourSlots);\n    }\n\n    if (this.parent.activeViewOptions.headerRows.length > 0) {\n      var renderGn = new TimelineHeaderRow(this.parent, this.renderDates);\n      levels = renderGn.generateColumnLevels(dateSlots, hourSlots);\n    }\n\n    return levels;\n  };\n\n  TimelineViews.prototype.generateTimeSlots = function (dateSlots) {\n    var _this = this;\n\n    var handler = function (r) {\n      r.type = r.first ? 'majorSlot' : 'minorSlot';\n      r.className = r.first ? [cls.TIME_SLOT_CLASS] : [cls.TIME_SLOT_CLASS, cls.TIME_CELLS_CLASS];\n      r.workDays = _this.parent.activeViewOptions.workDays;\n      return r;\n    };\n\n    var timeSlotData = this.getTimeSlotRows(handler);\n    var slots = [];\n\n    for (var _i = 0, dateSlots_1 = dateSlots; _i < dateSlots_1.length; _i++) {\n      var data = dateSlots_1[_i];\n      data.colSpan = timeSlotData.length;\n      var tempTimeSlots = extend([], timeSlotData, null, true);\n\n      for (var _a = 0, tempTimeSlots_1 = tempTimeSlots; _a < tempTimeSlots_1.length; _a++) {\n        var slot = tempTimeSlots_1[_a];\n        var cellDate = util.resetTime(new Date('' + data.date));\n        slot.date = util.setTime(cellDate, util.getDateInMs(slot.date));\n        slots.push(slot);\n      }\n    }\n\n    return slots;\n  };\n\n  TimelineViews.prototype.changeCurrentTimePosition = function () {\n    if (!this.parent || this.parent && this.parent.isDestroyed) {\n      return;\n    }\n\n    this.removeCurrentTimeIndicatorElements();\n    var currentDateIndex = this.getCurrentTimeIndicatorIndex();\n    var left = this.getLeftFromDateTime(currentDateIndex, this.parent.getCurrentTime());\n    var height = this.element.querySelector('.' + cls.CONTENT_TABLE_CLASS).offsetHeight;\n    var headerWrap = this.element.querySelector('.' + cls.DATE_HEADER_WRAP_CLASS);\n    var contentWrap = this.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n    contentWrap.appendChild(createElement('div', {\n      className: cls.CURRENT_TIMELINE_CLASS,\n      styles: (this.parent.enableRtl ? 'right' : 'left') + ':' + formatUnit(left) + '; height:' + formatUnit(height)\n    }));\n\n    if (this.parent.virtualScrollModule) {\n      var timeIndicator = this.parent.element.querySelector('.' + cls.CURRENT_TIMELINE_CLASS);\n      var element = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS + ' table');\n      setStyleAttribute(timeIndicator, {\n        transform: element.style.transform\n      });\n    }\n\n    var currentTimeEle = createElement('div', {\n      innerHTML: this.parent.getTimeString(this.parent.getCurrentTime()),\n      className: cls.CURRENT_TIME_CLASS\n    });\n    headerWrap.appendChild(currentTimeEle);\n    currentTimeEle.style[this.parent.enableRtl ? 'right' : 'left'] = formatUnit(left - currentTimeEle.offsetWidth / 2);\n  };\n\n  TimelineViews.prototype.getLeftFromDateTime = function (currentDateIndex, date) {\n    var startHour = this.getStartHour();\n    var endHour = this.getEndHour();\n    var diffInDates = 0;\n    var diffInMinutes = (date.getHours() - startHour.getHours()) * 60 + (date.getMinutes() - startHour.getMinutes());\n\n    if (!isNullOrUndefined(currentDateIndex)) {\n      var end = endHour.getHours() === 0 ? 24 : endHour.getHours();\n\n      if (currentDateIndex[0] !== 0) {\n        diffInDates = currentDateIndex[0] * ((end - startHour.getHours()) * 60) + (endHour.getMinutes() - startHour.getMinutes());\n      }\n\n      diffInMinutes = diffInDates + diffInMinutes;\n    }\n\n    return diffInMinutes * this.getWorkCellWidth() * this.parent.activeViewOptions.timeScale.slotCount / this.parent.activeViewOptions.timeScale.interval;\n  };\n\n  TimelineViews.prototype.getWorkCellWidth = function () {\n    return this.element.querySelector('.e-work-cells').getBoundingClientRect().width;\n  };\n\n  TimelineViews.prototype.renderHeader = function () {\n    var tr = createElement('tr');\n\n    if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n      this.parent.resourceBase.renderResourceHeaderIndent(tr);\n    }\n\n    var dateTd = createElement('td');\n    dateTd.appendChild(this.renderDatesHeader());\n    tr.appendChild(dateTd);\n    prepend([tr], this.element.querySelector('tbody'));\n  }; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  TimelineViews.prototype.createAllDayRow = function (table, tdData) {};\n\n  TimelineViews.prototype.getCurrentTimeIndicatorIndex = function () {\n    var currentDateIndex = [];\n    var index = this.parent.getIndexOfDate(this.renderDates, util.resetTime(this.parent.getCurrentTime()));\n\n    if (index >= 0) {\n      currentDateIndex.push(index);\n    }\n\n    return currentDateIndex;\n  };\n\n  TimelineViews.prototype.renderContent = function () {\n    var tr = createElement('tr');\n\n    if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n      var resTd = createElement('td');\n      resTd.appendChild(this.parent.resourceBase.createResourceColumn());\n      tr.appendChild(resTd);\n    }\n\n    var workTd = createElement('td');\n    var wrap = this.renderContentArea();\n    wrap.appendChild(this.createEventTable(this.getRowCount()));\n    this.collapseRows(wrap);\n    workTd.appendChild(wrap);\n    tr.appendChild(workTd);\n\n    if (this.parent.virtualScrollModule) {\n      this.parent.virtualScrollModule.renderVirtualTrack(wrap);\n    }\n\n    this.element.querySelector('tbody').appendChild(tr);\n  };\n\n  TimelineViews.prototype.getRowCount = function () {\n    if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n      return this.parent.resourceBase.renderedResources.length;\n    }\n\n    return 1;\n  };\n\n  TimelineViews.prototype.getResourceTdData = function (i, tdData) {\n    var resLevel = this.parent.resourceBase.renderedResources[i];\n    var resSHr = resLevel.resourceData[resLevel.resource.startHourField] || this.parent.workHours.start;\n    var resEHr = resLevel.resourceData[resLevel.resource.endHourField] || this.parent.workHours.end;\n    tdData.startHour = this.parent.getStartEndTime(resSHr);\n    tdData.endHour = this.parent.getStartEndTime(resEHr);\n    tdData.workDays = resLevel.resourceData[resLevel.resource.workDaysField] || this.parent.workDays;\n    tdData.className = resLevel.className;\n    tdData.groupIndex = resLevel.groupIndex;\n    tdData.groupOrder = resLevel.groupOrder;\n    return tdData;\n  };\n\n  TimelineViews.prototype.renderContentTable = function (table) {\n    var tBody = table.querySelector('tbody');\n    append(this.getContentRows(), tBody);\n  };\n\n  TimelineViews.prototype.getContentRows = function () {\n    var rows = [];\n    var tr = createElement('tr');\n    var td = createElement('td', {\n      attrs: {\n        'aria-selected': 'false'\n      }\n    });\n    var trCount = this.getRowCount();\n\n    for (var i = 0; i < trCount; i++) {\n      var ntr = tr.cloneNode();\n\n      for (var _i = 0, _a = this.colLevels[this.colLevels.length - 1]; _i < _a.length; _i++) {\n        var tdData = _a[_i];\n\n        if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n          tdData = this.getResourceTdData(i, tdData);\n        }\n\n        var ntd = this.createContentTd(tdData, tdData, td);\n        ntr.appendChild(ntd);\n      }\n\n      rows.push(ntr);\n    }\n\n    return rows;\n  };\n\n  TimelineViews.prototype.getContentTdClass = function (r) {\n    return r.first || !this.parent.activeViewOptions.timeScale.enable ? [cls.WORK_CELLS_CLASS] : [cls.WORK_CELLS_CLASS, cls.ALTERNATE_CELLS_CLASS];\n  };\n\n  TimelineViews.prototype.renderEvents = function () {\n    this.timelineAppointment = new TimelineEvent(this.parent, this.parent.activeViewOptions.timeScale.enable ? 'hour' : 'day');\n    this.timelineAppointment.renderAppointments();\n    this.parent.notify(event.eventsLoaded, {});\n  };\n\n  TimelineViews.prototype.getAdjustedDate = function (date) {\n    if (!this.parent.activeViewOptions.timeScale.enable) {\n      return new Date(date.setHours(0, 0, 0, 0));\n    } else {\n      var timeSlots = this.colLevels[this.colLevels.length - 1];\n\n      for (var i = 0; i < timeSlots.length; i++) {\n        if (timeSlots[i].date.getTime() > date.getTime()) {\n          return timeSlots[i - 1].date;\n        }\n      }\n    }\n\n    return null;\n  };\n\n  TimelineViews.prototype.destroy = function () {\n    if (!this.parent || this.parent && this.parent.isDestroyed) {\n      return;\n    }\n\n    if (this.timelineAppointment) {\n      this.timelineAppointment.destroy();\n      this.timelineAppointment = null;\n    }\n\n    _super.prototype.destroy.call(this);\n  };\n\n  return TimelineViews;\n}(VerticalView);\n\nexport { TimelineViews };","map":{"version":3,"sources":["C:/Users/Zoran/source/repos/TransportApp/TransportLog-basic/node_modules/@syncfusion/ej2-schedule/src/schedule/renderer/timeline-view.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","isNullOrUndefined","createElement","prepend","extend","formatUnit","append","setStyleAttribute","VerticalView","TimelineEvent","TimelineHeaderRow","event","cls","util","TimelineViews","_super","parent","_this","call","timelineAppointment","baseCssClass","getModuleName","getLeftPanelElement","element","querySelector","RESOURCE_COLUMN_WRAP_CLASS","scrollTopPanel","target","scrollHeaderLabels","scrollToWorkHour","start","getStartEndTime","workHours","currDateTime","isWorkDay","selectedDate","highlight","Date","setHours","getHours","getMinutes","queryString","getTime","toString","firstWorkHourCell","getContentAreaElement","scrollLeft","enableRtl","offsetLeft","getContentTable","offsetWidth","scrollToHour","hour","scrollDate","date","index","getIndexOfDate","renderDates","resetTime","timeString","split","length","parseInt","activeViewOptions","timeScale","enable","getWorkCellWidth","getLeftFromDateTime","getScrollableElement","generateColumnLevels","levels","dateSlots","getDateSlots","workDays","push","group","resources","resourceBase","generateResourceLevels","uiStateValues","isGroupAdaptive","hourSlots","generateTimeSlots","headerRows","renderGn","handler","r","type","first","className","TIME_SLOT_CLASS","TIME_CELLS_CLASS","timeSlotData","getTimeSlotRows","slots","_i","dateSlots_1","data","colSpan","tempTimeSlots","_a","tempTimeSlots_1","slot","cellDate","setTime","getDateInMs","changeCurrentTimePosition","isDestroyed","removeCurrentTimeIndicatorElements","currentDateIndex","getCurrentTimeIndicatorIndex","left","getCurrentTime","height","CONTENT_TABLE_CLASS","offsetHeight","headerWrap","DATE_HEADER_WRAP_CLASS","contentWrap","CONTENT_WRAP_CLASS","appendChild","CURRENT_TIMELINE_CLASS","styles","virtualScrollModule","timeIndicator","transform","style","currentTimeEle","innerHTML","getTimeString","CURRENT_TIME_CLASS","startHour","getStartHour","endHour","getEndHour","diffInDates","diffInMinutes","end","slotCount","interval","getBoundingClientRect","width","renderHeader","tr","renderResourceHeaderIndent","dateTd","renderDatesHeader","createAllDayRow","table","tdData","renderContent","resTd","createResourceColumn","workTd","wrap","renderContentArea","createEventTable","getRowCount","collapseRows","renderVirtualTrack","renderedResources","getResourceTdData","i","resLevel","resSHr","resourceData","resource","startHourField","resEHr","endHourField","workDaysField","groupIndex","groupOrder","renderContentTable","tBody","getContentRows","rows","td","attrs","trCount","ntr","cloneNode","colLevels","ntd","createContentTd","getContentTdClass","WORK_CELLS_CLASS","ALTERNATE_CELLS_CLASS","renderEvents","renderAppointments","notify","eventsLoaded","getAdjustedDate","timeSlots","destroy"],"mappings":"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","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { isNullOrUndefined, createElement, prepend, extend, formatUnit, append, setStyleAttribute } from '@syncfusion/ej2-base';\nimport { VerticalView } from './vertical-view';\nimport { TimelineEvent } from '../event-renderer/timeline-view';\nimport { TimelineHeaderRow } from './timeline-header-row';\nimport * as event from '../base/constant';\nimport * as cls from '../base/css-constant';\nimport * as util from '../base/util';\n/**\n * timeline views\n */\nvar TimelineViews = /** @class */ (function (_super) {\n    __extends(TimelineViews, _super);\n    function TimelineViews(parent) {\n        var _this = _super.call(this, parent) || this;\n        _this.timelineAppointment = null;\n        _this.baseCssClass = 'e-timeline-view';\n        return _this;\n    }\n    TimelineViews.prototype.getModuleName = function () {\n        return 'timelineViews';\n    };\n    TimelineViews.prototype.getLeftPanelElement = function () {\n        return this.element.querySelector('.' + cls.RESOURCE_COLUMN_WRAP_CLASS);\n    };\n    TimelineViews.prototype.scrollTopPanel = function (target) {\n        _super.prototype.scrollTopPanel.call(this, target);\n        this.scrollHeaderLabels(target);\n    };\n    TimelineViews.prototype.scrollToWorkHour = function () {\n        var start = this.parent.getStartEndTime(this.parent.workHours.start);\n        var currDateTime = this.isWorkDay(this.parent.selectedDate) && this.parent.workHours.highlight &&\n            !isNullOrUndefined(start) ? new Date(+this.parent.selectedDate).setHours(start.getHours(), start.getMinutes(), 0, 0)\n            : new Date(+this.parent.selectedDate).setHours(0, 0, 0, 0);\n        var queryString = '[data-date=\"' + new Date(currDateTime).getTime().toString() + '\"]';\n        var firstWorkHourCell = this.element.querySelector(queryString);\n        if (firstWorkHourCell) {\n            this.getContentAreaElement().scrollLeft = !this.parent.enableRtl ? firstWorkHourCell.offsetLeft :\n                -(this.parent.getContentTable().offsetWidth - firstWorkHourCell.offsetLeft - firstWorkHourCell.offsetWidth);\n        }\n    };\n    TimelineViews.prototype.scrollToHour = function (hour, scrollDate) {\n        var date;\n        var index;\n        if (scrollDate) {\n            index = this.parent.getIndexOfDate(this.renderDates, util.resetTime(scrollDate));\n            if (index >= 0) {\n                date = scrollDate;\n                if (!isNullOrUndefined(hour)) {\n                    var timeString = hour.split(':');\n                    if (timeString.length === 2) {\n                        date = new Date(scrollDate.setHours(parseInt(timeString[0], 10), parseInt(timeString[1], 10), 0));\n                    }\n                }\n            }\n        }\n        date = isNullOrUndefined(scrollDate) ? this.parent.getStartEndTime(hour) : date;\n        if (isNullOrUndefined(date)) {\n            return;\n        }\n        var scrollLeft;\n        if (isNullOrUndefined(hour) || !this.parent.activeViewOptions.timeScale.enable) {\n            scrollLeft = index * this.getWorkCellWidth();\n        }\n        else {\n            scrollLeft = isNullOrUndefined(scrollDate) ? this.getLeftFromDateTime(null, date) :\n                this.getLeftFromDateTime([index], date);\n        }\n        this.getScrollableElement().scrollLeft = !this.parent.enableRtl ? scrollLeft : -scrollLeft;\n    };\n    TimelineViews.prototype.generateColumnLevels = function () {\n        var levels = [];\n        var dateSlots = this.getDateSlots(this.renderDates, this.parent.activeViewOptions.workDays);\n        levels.push(dateSlots);\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            this.parent.resourceBase.generateResourceLevels(dateSlots, !this.parent.uiStateValues.isGroupAdaptive);\n        }\n        var hourSlots = [];\n        if (this.parent.activeViewOptions.timeScale.enable) {\n            hourSlots = this.generateTimeSlots(levels[levels.length - 1]);\n            levels.push(hourSlots);\n        }\n        if (this.parent.activeViewOptions.headerRows.length > 0) {\n            var renderGn = new TimelineHeaderRow(this.parent, this.renderDates);\n            levels = renderGn.generateColumnLevels(dateSlots, hourSlots);\n        }\n        return levels;\n    };\n    TimelineViews.prototype.generateTimeSlots = function (dateSlots) {\n        var _this = this;\n        var handler = function (r) {\n            r.type = r.first ? 'majorSlot' : 'minorSlot';\n            r.className = r.first ? [cls.TIME_SLOT_CLASS] : [cls.TIME_SLOT_CLASS, cls.TIME_CELLS_CLASS];\n            r.workDays = _this.parent.activeViewOptions.workDays;\n            return r;\n        };\n        var timeSlotData = this.getTimeSlotRows(handler);\n        var slots = [];\n        for (var _i = 0, dateSlots_1 = dateSlots; _i < dateSlots_1.length; _i++) {\n            var data = dateSlots_1[_i];\n            data.colSpan = timeSlotData.length;\n            var tempTimeSlots = extend([], timeSlotData, null, true);\n            for (var _a = 0, tempTimeSlots_1 = tempTimeSlots; _a < tempTimeSlots_1.length; _a++) {\n                var slot = tempTimeSlots_1[_a];\n                var cellDate = util.resetTime(new Date('' + data.date));\n                slot.date = util.setTime(cellDate, util.getDateInMs(slot.date));\n                slots.push(slot);\n            }\n        }\n        return slots;\n    };\n    TimelineViews.prototype.changeCurrentTimePosition = function () {\n        if (!this.parent || this.parent && this.parent.isDestroyed) {\n            return;\n        }\n        this.removeCurrentTimeIndicatorElements();\n        var currentDateIndex = this.getCurrentTimeIndicatorIndex();\n        var left = this.getLeftFromDateTime(currentDateIndex, this.parent.getCurrentTime());\n        var height = this.element.querySelector('.' + cls.CONTENT_TABLE_CLASS).offsetHeight;\n        var headerWrap = this.element.querySelector('.' + cls.DATE_HEADER_WRAP_CLASS);\n        var contentWrap = this.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n        contentWrap.appendChild(createElement('div', {\n            className: cls.CURRENT_TIMELINE_CLASS,\n            styles: (this.parent.enableRtl ? 'right' : 'left') + ':' + formatUnit(left) + '; height:' + formatUnit(height)\n        }));\n        if (this.parent.virtualScrollModule) {\n            var timeIndicator = this.parent.element.querySelector('.' + cls.CURRENT_TIMELINE_CLASS);\n            var element = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS + ' table');\n            setStyleAttribute(timeIndicator, {\n                transform: element.style.transform\n            });\n        }\n        var currentTimeEle = createElement('div', {\n            innerHTML: this.parent.getTimeString(this.parent.getCurrentTime()),\n            className: cls.CURRENT_TIME_CLASS\n        });\n        headerWrap.appendChild(currentTimeEle);\n        currentTimeEle.style[this.parent.enableRtl ? 'right' : 'left'] = formatUnit(left - (currentTimeEle.offsetWidth / 2));\n    };\n    TimelineViews.prototype.getLeftFromDateTime = function (currentDateIndex, date) {\n        var startHour = this.getStartHour();\n        var endHour = this.getEndHour();\n        var diffInDates = 0;\n        var diffInMinutes = ((date.getHours() - startHour.getHours()) * 60) + (date.getMinutes() - startHour.getMinutes());\n        if (!isNullOrUndefined(currentDateIndex)) {\n            var end = (endHour.getHours() === 0) ? 24 : endHour.getHours();\n            if (currentDateIndex[0] !== 0) {\n                diffInDates = (currentDateIndex[0]) * ((end - startHour.getHours()) * 60) + (endHour.getMinutes() - startHour.getMinutes());\n            }\n            diffInMinutes = diffInDates + diffInMinutes;\n        }\n        return (diffInMinutes * this.getWorkCellWidth() * this.parent.activeViewOptions.timeScale.slotCount) /\n            this.parent.activeViewOptions.timeScale.interval;\n    };\n    TimelineViews.prototype.getWorkCellWidth = function () {\n        return this.element.querySelector('.e-work-cells').getBoundingClientRect().width;\n    };\n    TimelineViews.prototype.renderHeader = function () {\n        var tr = createElement('tr');\n        if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n            this.parent.resourceBase.renderResourceHeaderIndent(tr);\n        }\n        var dateTd = createElement('td');\n        dateTd.appendChild(this.renderDatesHeader());\n        tr.appendChild(dateTd);\n        prepend([tr], this.element.querySelector('tbody'));\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    TimelineViews.prototype.createAllDayRow = function (table, tdData) { };\n    TimelineViews.prototype.getCurrentTimeIndicatorIndex = function () {\n        var currentDateIndex = [];\n        var index = this.parent.getIndexOfDate(this.renderDates, util.resetTime(this.parent.getCurrentTime()));\n        if (index >= 0) {\n            currentDateIndex.push(index);\n        }\n        return currentDateIndex;\n    };\n    TimelineViews.prototype.renderContent = function () {\n        var tr = createElement('tr');\n        if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n            var resTd = createElement('td');\n            resTd.appendChild(this.parent.resourceBase.createResourceColumn());\n            tr.appendChild(resTd);\n        }\n        var workTd = createElement('td');\n        var wrap = this.renderContentArea();\n        wrap.appendChild(this.createEventTable(this.getRowCount()));\n        this.collapseRows(wrap);\n        workTd.appendChild(wrap);\n        tr.appendChild(workTd);\n        if (this.parent.virtualScrollModule) {\n            this.parent.virtualScrollModule.renderVirtualTrack(wrap);\n        }\n        this.element.querySelector('tbody').appendChild(tr);\n    };\n    TimelineViews.prototype.getRowCount = function () {\n        if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n            return this.parent.resourceBase.renderedResources.length;\n        }\n        return 1;\n    };\n    TimelineViews.prototype.getResourceTdData = function (i, tdData) {\n        var resLevel = this.parent.resourceBase.renderedResources[i];\n        var resSHr = resLevel.resourceData[resLevel.resource.startHourField] || this.parent.workHours.start;\n        var resEHr = resLevel.resourceData[resLevel.resource.endHourField] || this.parent.workHours.end;\n        tdData.startHour = this.parent.getStartEndTime(resSHr);\n        tdData.endHour = this.parent.getStartEndTime(resEHr);\n        tdData.workDays = resLevel.resourceData[resLevel.resource.workDaysField] || this.parent.workDays;\n        tdData.className = resLevel.className;\n        tdData.groupIndex = resLevel.groupIndex;\n        tdData.groupOrder = resLevel.groupOrder;\n        return tdData;\n    };\n    TimelineViews.prototype.renderContentTable = function (table) {\n        var tBody = table.querySelector('tbody');\n        append(this.getContentRows(), tBody);\n    };\n    TimelineViews.prototype.getContentRows = function () {\n        var rows = [];\n        var tr = createElement('tr');\n        var td = createElement('td', { attrs: { 'aria-selected': 'false' } });\n        var trCount = this.getRowCount();\n        for (var i = 0; i < trCount; i++) {\n            var ntr = tr.cloneNode();\n            for (var _i = 0, _a = this.colLevels[this.colLevels.length - 1]; _i < _a.length; _i++) {\n                var tdData = _a[_i];\n                if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n                    tdData = this.getResourceTdData(i, tdData);\n                }\n                var ntd = this.createContentTd(tdData, tdData, td);\n                ntr.appendChild(ntd);\n            }\n            rows.push(ntr);\n        }\n        return rows;\n    };\n    TimelineViews.prototype.getContentTdClass = function (r) {\n        return (r.first || !this.parent.activeViewOptions.timeScale.enable) ? [cls.WORK_CELLS_CLASS] :\n            [cls.WORK_CELLS_CLASS, cls.ALTERNATE_CELLS_CLASS];\n    };\n    TimelineViews.prototype.renderEvents = function () {\n        this.timelineAppointment = new TimelineEvent(this.parent, this.parent.activeViewOptions.timeScale.enable ? 'hour' : 'day');\n        this.timelineAppointment.renderAppointments();\n        this.parent.notify(event.eventsLoaded, {});\n    };\n    TimelineViews.prototype.getAdjustedDate = function (date) {\n        if (!this.parent.activeViewOptions.timeScale.enable) {\n            return new Date(date.setHours(0, 0, 0, 0));\n        }\n        else {\n            var timeSlots = this.colLevels[this.colLevels.length - 1];\n            for (var i = 0; i < timeSlots.length; i++) {\n                if (timeSlots[i].date.getTime() > date.getTime()) {\n                    return timeSlots[i - 1].date;\n                }\n            }\n        }\n        return null;\n    };\n    TimelineViews.prototype.destroy = function () {\n        if (!this.parent || this.parent && this.parent.isDestroyed) {\n            return;\n        }\n        if (this.timelineAppointment) {\n            this.timelineAppointment.destroy();\n            this.timelineAppointment = null;\n        }\n        _super.prototype.destroy.call(this);\n    };\n    return TimelineViews;\n}(VerticalView));\nexport { TimelineViews };\n"]},"metadata":{},"sourceType":"module"}