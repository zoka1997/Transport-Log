{"ast":null,"code":"/**\r\n * DevExtreme (esm/ui/collection/ui.collection_widget.base.js)\r\n * Version: 22.1.6\r\n * Build date: Tue Oct 18 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport { getOuterWidth } from \"../../core/utils/size\";\nimport $ from \"../../core/renderer\";\nimport eventsEngine from \"../../events/core/events_engine\";\nimport { ensureDefined, deferRenderer, noop } from \"../../core/utils/common\";\nimport { findTemplates } from \"../../core/utils/template_manager\";\nimport { getPublicElement } from \"../../core/element\";\nimport domAdapter from \"../../core/dom_adapter\";\nimport { isPlainObject, isFunction, isDefined } from \"../../core/utils/type\";\nimport { when } from \"../../core/utils/deferred\";\nimport { extend } from \"../../core/utils/extend\";\nimport { each } from \"../../core/utils/iterator\";\nimport Action from \"../../core/action\";\nimport Guid from \"../../core/guid\";\nimport Widget from \"../widget/ui.widget\";\nimport { addNamespace, isCommandKeyPressed } from \"../../events/utils/index\";\nimport pointerEvents from \"../../events/pointer\";\nimport DataHelperMixin from \"../../data_helper\";\nimport CollectionWidgetItem from \"./item\";\nimport { focusable } from \"../widget/selectors\";\nimport messageLocalization from \"../../localization/message\";\nimport holdEvent from \"../../events/hold\";\nimport { compileGetter } from \"../../core/utils/data\";\nimport { name as clickEventName } from \"../../events/click\";\nimport { name as contextMenuEventName } from \"../../events/contextmenu\";\nimport { BindableTemplate } from \"../../core/templates/bindable_template\";\nvar COLLECTION_CLASS = \"dx-collection\";\nvar ITEM_CLASS = \"dx-item\";\nvar CONTENT_CLASS_POSTFIX = \"-content\";\nvar ITEM_CONTENT_PLACEHOLDER_CLASS = \"dx-item-content-placeholder\";\nvar ITEM_DATA_KEY = \"dxItemData\";\nvar ITEM_INDEX_KEY = \"dxItemIndex\";\nvar ITEM_TEMPLATE_ID_PREFIX = \"tmpl-\";\nvar ITEMS_OPTIONS_NAME = \"dxItem\";\nvar SELECTED_ITEM_CLASS = \"dx-item-selected\";\nvar ITEM_RESPONSE_WAIT_CLASS = \"dx-item-response-wait\";\nvar EMPTY_COLLECTION = \"dx-empty-collection\";\nvar TEMPLATE_WRAPPER_CLASS = \"dx-template-wrapper\";\nvar ITEM_PATH_REGEX = /^([^.]+\\[\\d+\\]\\.)+([\\w.]+)$/;\nvar ANONYMOUS_TEMPLATE_NAME = \"item\";\nvar FOCUS_UP = \"up\";\nvar FOCUS_DOWN = \"down\";\nvar FOCUS_LEFT = \"left\";\nvar FOCUS_RIGHT = \"right\";\nvar FOCUS_PAGE_UP = \"pageup\";\nvar FOCUS_PAGE_DOWN = \"pagedown\";\nvar FOCUS_LAST = \"last\";\nvar FOCUS_FIRST = \"first\";\nvar CollectionWidget = Widget.inherit({\n  _activeStateUnit: \".\" + ITEM_CLASS,\n  _supportedKeys: function () {\n    var enter = function (e) {\n      var $itemElement = $(this.option(\"focusedElement\"));\n\n      if (!$itemElement.length) {\n        return;\n      }\n\n      this._itemClickHandler(extend({}, e, {\n        target: $itemElement.get(0),\n        currentTarget: $itemElement.get(0)\n      }));\n    };\n\n    var move = function (location, e) {\n      if (!isCommandKeyPressed(e)) {\n        e.preventDefault();\n        e.stopPropagation();\n\n        this._moveFocus(location, e);\n      }\n    };\n\n    return extend(this.callBase(), {\n      space: function (e) {\n        e.preventDefault();\n        enter.call(this, e);\n      },\n      enter: enter,\n      leftArrow: move.bind(this, FOCUS_LEFT),\n      rightArrow: move.bind(this, FOCUS_RIGHT),\n      upArrow: move.bind(this, FOCUS_UP),\n      downArrow: move.bind(this, FOCUS_DOWN),\n      pageUp: move.bind(this, FOCUS_UP),\n      pageDown: move.bind(this, FOCUS_DOWN),\n      home: move.bind(this, FOCUS_FIRST),\n      end: move.bind(this, FOCUS_LAST)\n    });\n  },\n  _getDefaultOptions: function () {\n    return extend(this.callBase(), {\n      selectOnFocus: false,\n      loopItemFocus: true,\n      items: [],\n      itemTemplate: \"item\",\n      onItemRendered: null,\n      onItemClick: null,\n      onItemHold: null,\n      itemHoldTimeout: 750,\n      onItemContextMenu: null,\n      onFocusedItemChanged: null,\n      noDataText: messageLocalization.format(\"dxCollectionWidget-noDataText\"),\n      dataSource: null,\n      _itemAttributes: {},\n      itemTemplateProperty: \"template\",\n      focusOnSelectedItem: true,\n      focusedElement: null,\n      displayExpr: void 0,\n      disabledExpr: function (data) {\n        return data ? data.disabled : void 0;\n      },\n      visibleExpr: function (data) {\n        return data ? data.visible : void 0;\n      }\n    });\n  },\n  _init: function () {\n    this._compileDisplayGetter();\n\n    this.callBase();\n\n    this._cleanRenderedItems();\n\n    this._refreshDataSource();\n  },\n  _compileDisplayGetter: function () {\n    var displayExpr = this.option(\"displayExpr\");\n    this._displayGetter = displayExpr ? compileGetter(this.option(\"displayExpr\")) : void 0;\n  },\n  _initTemplates: function () {\n    this._initItemsFromMarkup();\n\n    this._initDefaultItemTemplate();\n\n    this.callBase();\n  },\n  _getAnonymousTemplateName: function () {\n    return ANONYMOUS_TEMPLATE_NAME;\n  },\n  _initDefaultItemTemplate: function () {\n    var fieldsMap = this._getFieldsMap();\n\n    this._templateManager.addDefaultTemplates({\n      item: new BindableTemplate(function ($container, data) {\n        if (isPlainObject(data)) {\n          this._prepareDefaultItemTemplate(data, $container);\n        } else {\n          if (fieldsMap && isFunction(fieldsMap.text)) {\n            data = fieldsMap.text(data);\n          }\n\n          $container.text(String(ensureDefined(data, \"\")));\n        }\n      }.bind(this), this._getBindableFields(), this.option(\"integrationOptions.watchMethod\"), fieldsMap)\n    });\n  },\n  _getBindableFields: function () {\n    return [\"text\", \"html\"];\n  },\n  _getFieldsMap: function () {\n    if (this._displayGetter) {\n      return {\n        text: this._displayGetter\n      };\n    }\n  },\n  _prepareDefaultItemTemplate: function (data, $container) {\n    if (isDefined(data.text)) {\n      $container.text(data.text);\n    }\n\n    if (isDefined(data.html)) {\n      $container.html(data.html);\n    }\n  },\n  _initItemsFromMarkup: function () {\n    var rawItems = findTemplates(this.$element(), ITEMS_OPTIONS_NAME);\n\n    if (!rawItems.length || this.option(\"items\").length) {\n      return;\n    }\n\n    var items = rawItems.map(_ref => {\n      var {\n        element: element,\n        options: options\n      } = _ref;\n      var isTemplateRequired = /\\S/.test(element.innerHTML) && !options.template;\n\n      if (isTemplateRequired) {\n        options.template = this._prepareItemTemplate(element);\n      } else {\n        $(element).remove();\n      }\n\n      return options;\n    });\n    this.option(\"items\", items);\n  },\n  _prepareItemTemplate: function (item) {\n    var templateId = ITEM_TEMPLATE_ID_PREFIX + new Guid();\n    var $template = $(item).detach().clone().removeAttr(\"data-options\").addClass(TEMPLATE_WRAPPER_CLASS);\n\n    this._saveTemplate(templateId, $template);\n\n    return templateId;\n  },\n  _dataSourceOptions: function () {\n    return {\n      paginate: false\n    };\n  },\n  _cleanRenderedItems: function () {\n    this._renderedItemsCount = 0;\n  },\n  _focusTarget: function () {\n    return this.$element();\n  },\n  _focusInHandler: function (e) {\n    this.callBase.apply(this, arguments);\n\n    if (!this._isFocusTarget(e.target)) {\n      return;\n    }\n\n    var $focusedElement = $(this.option(\"focusedElement\"));\n\n    if ($focusedElement.length) {\n      this._setFocusedItem($focusedElement);\n    } else {\n      var $activeItem = this._getActiveItem();\n\n      if ($activeItem.length) {\n        this.option(\"focusedElement\", getPublicElement($activeItem));\n      }\n    }\n  },\n  _focusOutHandler: function () {\n    this.callBase.apply(this, arguments);\n    var $target = $(this.option(\"focusedElement\"));\n\n    this._updateFocusedItemState($target, false);\n  },\n  _getActiveItem: function (last) {\n    var $focusedElement = $(this.option(\"focusedElement\"));\n\n    if ($focusedElement.length) {\n      return $focusedElement;\n    }\n\n    var index = this.option(\"focusOnSelectedItem\") ? this.option(\"selectedIndex\") : 0;\n\n    var activeElements = this._getActiveElement();\n\n    var lastIndex = activeElements.length - 1;\n\n    if (index < 0) {\n      index = last ? lastIndex : 0;\n    }\n\n    return activeElements.eq(index);\n  },\n  _moveFocus: function (location) {\n    var $items = this._getAvailableItems();\n\n    var $newTarget;\n\n    switch (location) {\n      case FOCUS_PAGE_UP:\n      case FOCUS_UP:\n        $newTarget = this._prevItem($items);\n        break;\n\n      case FOCUS_PAGE_DOWN:\n      case FOCUS_DOWN:\n        $newTarget = this._nextItem($items);\n        break;\n\n      case FOCUS_RIGHT:\n        $newTarget = this.option(\"rtlEnabled\") ? this._prevItem($items) : this._nextItem($items);\n        break;\n\n      case FOCUS_LEFT:\n        $newTarget = this.option(\"rtlEnabled\") ? this._nextItem($items) : this._prevItem($items);\n        break;\n\n      case FOCUS_FIRST:\n        $newTarget = $items.first();\n        break;\n\n      case FOCUS_LAST:\n        $newTarget = $items.last();\n        break;\n\n      default:\n        return false;\n    }\n\n    if (0 !== $newTarget.length) {\n      this.option(\"focusedElement\", getPublicElement($newTarget));\n    }\n  },\n  _getVisibleItems: function ($itemElements) {\n    $itemElements = $itemElements || this._itemElements();\n    return $itemElements.filter(\":visible\");\n  },\n  _getAvailableItems: function ($itemElements) {\n    return this._getVisibleItems($itemElements).not(\".dx-state-disabled\");\n  },\n  _prevItem: function ($items) {\n    var $target = this._getActiveItem();\n\n    var targetIndex = $items.index($target);\n    var $last = $items.last();\n    var $item = $($items[targetIndex - 1]);\n    var loop = this.option(\"loopItemFocus\");\n\n    if (0 === $item.length && loop) {\n      $item = $last;\n    }\n\n    return $item;\n  },\n  _nextItem: function ($items) {\n    var $target = this._getActiveItem(true);\n\n    var targetIndex = $items.index($target);\n    var $first = $items.first();\n    var $item = $($items[targetIndex + 1]);\n    var loop = this.option(\"loopItemFocus\");\n\n    if (0 === $item.length && loop) {\n      $item = $first;\n    }\n\n    return $item;\n  },\n  _selectFocusedItem: function ($target) {\n    this.selectItem($target);\n  },\n  _updateFocusedItemState: function (target, isFocused, needCleanItemId) {\n    var $target = $(target);\n\n    if ($target.length) {\n      this._refreshActiveDescendant();\n\n      this._refreshItemId($target, needCleanItemId);\n\n      this._toggleFocusClass(isFocused, $target);\n    }\n\n    this._updateParentActiveDescendant();\n  },\n  _refreshActiveDescendant: function ($target) {\n    this.setAria(\"activedescendant\", isDefined(this.option(\"focusedElement\")) ? this.getFocusedItemId() : null, $target);\n  },\n  _refreshItemId: function ($target, needCleanItemId) {\n    if (!needCleanItemId && this.option(\"focusedElement\")) {\n      this.setAria(\"id\", this.getFocusedItemId(), $target);\n    } else {\n      this.setAria(\"id\", null, $target);\n    }\n  },\n  _setFocusedItem: function ($target) {\n    if (!$target || !$target.length) {\n      return;\n    }\n\n    this._updateFocusedItemState($target, true);\n\n    this.onFocusedItemChanged(this.getFocusedItemId());\n\n    if (this.option(\"selectOnFocus\")) {\n      this._selectFocusedItem($target);\n    }\n  },\n  _findItemElementByItem: function (item) {\n    var result = $();\n    var that = this;\n    this.itemElements().each(function () {\n      var $item = $(this);\n\n      if ($item.data(that._itemDataKey()) === item) {\n        result = $item;\n        return false;\n      }\n    });\n    return result;\n  },\n  _getIndexByItem: function (item) {\n    return this.option(\"items\").indexOf(item);\n  },\n  _itemOptionChanged: function (item, property, value, oldValue) {\n    var $item = this._findItemElementByItem(item);\n\n    if (!$item.length) {\n      return;\n    }\n\n    if (!this.constructor.ItemClass.getInstance($item).setDataField(property, value)) {\n      this._refreshItem($item, item);\n    }\n\n    var isDisabling = \"disabled\" === property && value;\n\n    if (isDisabling) {\n      this._resetItemFocus($item);\n    }\n  },\n\n  _resetItemFocus($item) {\n    if ($item.is(this.option(\"focusedElement\"))) {\n      this.option(\"focusedElement\", null);\n    }\n  },\n\n  _refreshItem: function ($item) {\n    var itemData = this._getItemData($item);\n\n    var index = $item.data(this._itemIndexKey());\n\n    this._renderItem(this._renderedItemsCount + index, itemData, null, $item);\n  },\n  _updateParentActiveDescendant: noop,\n  _optionChanged: function (args) {\n    if (\"items\" === args.name) {\n      var matches = args.fullName.match(ITEM_PATH_REGEX);\n\n      if (matches && matches.length) {\n        var property = matches[matches.length - 1];\n        var itemPath = args.fullName.replace(\".\" + property, \"\");\n        var item = this.option(itemPath);\n\n        this._itemOptionChanged(item, property, args.value, args.previousValue);\n\n        return;\n      }\n    }\n\n    switch (args.name) {\n      case \"items\":\n      case \"_itemAttributes\":\n      case \"itemTemplateProperty\":\n      case \"useItemTextAsTitle\":\n        this._cleanRenderedItems();\n\n        this._invalidate();\n\n        break;\n\n      case \"dataSource\":\n        this._refreshDataSource();\n\n        this._renderEmptyMessage();\n\n        break;\n\n      case \"noDataText\":\n        this._renderEmptyMessage();\n\n        break;\n\n      case \"itemTemplate\":\n        this._invalidate();\n\n        break;\n\n      case \"onItemRendered\":\n        this._createItemRenderAction();\n\n        break;\n\n      case \"onItemClick\":\n        break;\n\n      case \"onItemHold\":\n      case \"itemHoldTimeout\":\n        this._attachHoldEvent();\n\n        break;\n\n      case \"onItemContextMenu\":\n        this._attachContextMenuEvent();\n\n        break;\n\n      case \"onFocusedItemChanged\":\n        this.onFocusedItemChanged = this._createActionByOption(\"onFocusedItemChanged\");\n        break;\n\n      case \"selectOnFocus\":\n      case \"loopItemFocus\":\n      case \"focusOnSelectedItem\":\n        break;\n\n      case \"focusedElement\":\n        this._updateFocusedItemState(args.previousValue, false, true);\n\n        this._setFocusedItem($(args.value));\n\n        break;\n\n      case \"displayExpr\":\n        this._compileDisplayGetter();\n\n        this._initDefaultItemTemplate();\n\n        this._invalidate();\n\n        break;\n\n      case \"visibleExpr\":\n      case \"disabledExpr\":\n        this._invalidate();\n\n        break;\n\n      default:\n        this.callBase(args);\n    }\n  },\n  _invalidate: function () {\n    this.option(\"focusedElement\", null);\n    return this.callBase.apply(this, arguments);\n  },\n  _loadNextPage: function () {\n    var dataSource = this._dataSource;\n\n    this._expectNextPageLoading();\n\n    dataSource.pageIndex(1 + dataSource.pageIndex());\n    return dataSource.load();\n  },\n  _expectNextPageLoading: function () {\n    this._startIndexForAppendedItems = 0;\n  },\n  _expectLastItemLoading: function () {\n    this._startIndexForAppendedItems = -1;\n  },\n  _forgetNextPageLoading: function () {\n    this._startIndexForAppendedItems = null;\n  },\n  _dataSourceChangedHandler: function (newItems) {\n    var items = this.option(\"items\");\n\n    if (this._initialized && items && this._shouldAppendItems()) {\n      this._renderedItemsCount = items.length;\n\n      if (!this._isLastPage() || -1 !== this._startIndexForAppendedItems) {\n        this.option().items = items.concat(newItems.slice(this._startIndexForAppendedItems));\n      }\n\n      this._forgetNextPageLoading();\n\n      this._refreshContent();\n    } else {\n      this.option(\"items\", newItems.slice());\n    }\n  },\n  _refreshContent: function () {\n    this._prepareContent();\n\n    this._renderContent();\n  },\n  _dataSourceLoadErrorHandler: function () {\n    this._forgetNextPageLoading();\n\n    this.option(\"items\", this.option(\"items\"));\n  },\n  _shouldAppendItems: function () {\n    return null != this._startIndexForAppendedItems && this._allowDynamicItemsAppend();\n  },\n  _allowDynamicItemsAppend: function () {\n    return false;\n  },\n  _clean: function () {\n    this._cleanFocusState();\n\n    this._cleanItemContainer();\n  },\n  _cleanItemContainer: function () {\n    $(this._itemContainer()).empty();\n  },\n  _dispose: function () {\n    this.callBase();\n    clearTimeout(this._itemFocusTimeout);\n  },\n  _refresh: function () {\n    this._cleanRenderedItems();\n\n    this.callBase.apply(this, arguments);\n  },\n  _itemContainer: function () {\n    return this.$element();\n  },\n  _itemClass: function () {\n    return ITEM_CLASS;\n  },\n  _itemContentClass: function () {\n    return this._itemClass() + CONTENT_CLASS_POSTFIX;\n  },\n  _selectedItemClass: function () {\n    return SELECTED_ITEM_CLASS;\n  },\n  _itemResponseWaitClass: function () {\n    return ITEM_RESPONSE_WAIT_CLASS;\n  },\n  _itemSelector: function () {\n    return \".\" + this._itemClass();\n  },\n  _itemDataKey: function () {\n    return ITEM_DATA_KEY;\n  },\n  _itemIndexKey: function () {\n    return ITEM_INDEX_KEY;\n  },\n  _itemElements: function () {\n    return this._itemContainer().find(this._itemSelector());\n  },\n  _initMarkup: function () {\n    this.callBase();\n    this.onFocusedItemChanged = this._createActionByOption(\"onFocusedItemChanged\");\n    this.$element().addClass(COLLECTION_CLASS);\n\n    this._prepareContent();\n  },\n  _prepareContent: deferRenderer(function () {\n    this._renderContentImpl();\n  }),\n  _renderContent: function () {\n    this._fireContentReadyAction();\n  },\n  _render: function () {\n    this.callBase();\n\n    this._attachClickEvent();\n\n    this._attachHoldEvent();\n\n    this._attachContextMenuEvent();\n  },\n  _attachClickEvent: function () {\n    var itemSelector = this._itemSelector();\n\n    var clickEventNamespace = addNamespace(clickEventName, this.NAME);\n    var pointerDownEventNamespace = addNamespace(pointerEvents.down, this.NAME);\n    var that = this;\n    var pointerDownAction = new Action(function (args) {\n      var event = args.event;\n\n      that._itemPointerDownHandler(event);\n    });\n    eventsEngine.off(this._itemContainer(), clickEventNamespace, itemSelector);\n    eventsEngine.off(this._itemContainer(), pointerDownEventNamespace, itemSelector);\n    eventsEngine.on(this._itemContainer(), clickEventNamespace, itemSelector, function (e) {\n      this._itemClickHandler(e);\n    }.bind(this));\n    eventsEngine.on(this._itemContainer(), pointerDownEventNamespace, itemSelector, function (e) {\n      pointerDownAction.execute({\n        element: $(e.target),\n        event: e\n      });\n    });\n  },\n  _itemClickHandler: function (e, args, config) {\n    this._itemDXEventHandler(e, \"onItemClick\", args, config);\n  },\n  _itemPointerDownHandler: function (e) {\n    if (!this.option(\"focusStateEnabled\")) {\n      return;\n    }\n\n    this._itemFocusHandler = function () {\n      clearTimeout(this._itemFocusTimeout);\n      this._itemFocusHandler = null;\n\n      if (e.isDefaultPrevented()) {\n        return;\n      }\n\n      var $target = $(e.target);\n      var $closestItem = $target.closest(this._itemElements());\n\n      var $closestFocusable = this._closestFocusable($target);\n\n      if ($closestItem.length && this._isFocusTarget(null === $closestFocusable || void 0 === $closestFocusable ? void 0 : $closestFocusable.get(0))) {\n        this.option(\"focusedElement\", getPublicElement($closestItem));\n      }\n    }.bind(this);\n\n    this._itemFocusTimeout = setTimeout(this._forcePointerDownFocus.bind(this));\n  },\n  _closestFocusable: function ($target) {\n    if ($target.is(focusable)) {\n      return $target;\n    } else {\n      $target = $target.parent();\n\n      while ($target.length && !domAdapter.isDocument($target.get(0))) {\n        if ($target.is(focusable)) {\n          return $target;\n        }\n\n        $target = $target.parent();\n      }\n    }\n  },\n  _forcePointerDownFocus: function () {\n    this._itemFocusHandler && this._itemFocusHandler();\n  },\n  _updateFocusState: function () {\n    this.callBase.apply(this, arguments);\n\n    this._forcePointerDownFocus();\n  },\n  _attachHoldEvent: function () {\n    var $itemContainer = this._itemContainer();\n\n    var itemSelector = this._itemSelector();\n\n    var eventName = addNamespace(holdEvent.name, this.NAME);\n    eventsEngine.off($itemContainer, eventName, itemSelector);\n    eventsEngine.on($itemContainer, eventName, itemSelector, {\n      timeout: this._getHoldTimeout()\n    }, this._itemHoldHandler.bind(this));\n  },\n  _getHoldTimeout: function () {\n    return this.option(\"itemHoldTimeout\");\n  },\n  _shouldFireHoldEvent: function () {\n    return this.hasActionSubscription(\"onItemHold\");\n  },\n  _itemHoldHandler: function (e) {\n    if (this._shouldFireHoldEvent()) {\n      this._itemDXEventHandler(e, \"onItemHold\");\n    } else {\n      e.cancel = true;\n    }\n  },\n  _attachContextMenuEvent: function () {\n    var $itemContainer = this._itemContainer();\n\n    var itemSelector = this._itemSelector();\n\n    var eventName = addNamespace(contextMenuEventName, this.NAME);\n    eventsEngine.off($itemContainer, eventName, itemSelector);\n    eventsEngine.on($itemContainer, eventName, itemSelector, this._itemContextMenuHandler.bind(this));\n  },\n  _shouldFireContextMenuEvent: function () {\n    return this.hasActionSubscription(\"onItemContextMenu\");\n  },\n  _itemContextMenuHandler: function (e) {\n    if (this._shouldFireContextMenuEvent()) {\n      this._itemDXEventHandler(e, \"onItemContextMenu\");\n    } else {\n      e.cancel = true;\n    }\n  },\n  _renderContentImpl: function () {\n    var items = this.option(\"items\") || [];\n\n    if (this._renderedItemsCount) {\n      this._renderItems(items.slice(this._renderedItemsCount));\n    } else {\n      this._renderItems(items);\n    }\n  },\n  _renderItems: function (items) {\n    if (items.length) {\n      each(items, function (index, itemData) {\n        this._renderItem(this._renderedItemsCount + index, itemData);\n      }.bind(this));\n    }\n\n    this._renderEmptyMessage();\n  },\n  _renderItem: function (index, itemData, $container, $itemToReplace) {\n    var _index$item;\n\n    var itemIndex = null !== (_index$item = null === index || void 0 === index ? void 0 : index.item) && void 0 !== _index$item ? _index$item : index;\n    $container = $container || this._itemContainer();\n\n    var $itemFrame = this._renderItemFrame(itemIndex, itemData, $container, $itemToReplace);\n\n    this._setElementData($itemFrame, itemData, itemIndex);\n\n    $itemFrame.attr(this.option(\"_itemAttributes\"));\n\n    this._attachItemClickEvent(itemData, $itemFrame);\n\n    var $itemContent = this._getItemContent($itemFrame);\n\n    var renderContentPromise = this._renderItemContent({\n      index: itemIndex,\n      itemData: itemData,\n      container: getPublicElement($itemContent),\n      contentClass: this._itemContentClass(),\n      defaultTemplateName: this.option(\"itemTemplate\")\n    });\n\n    var that = this;\n    when(renderContentPromise).done(function ($itemContent) {\n      that._postprocessRenderItem({\n        itemElement: $itemFrame,\n        itemContent: $itemContent,\n        itemData: itemData,\n        itemIndex: itemIndex\n      });\n\n      that._executeItemRenderAction(index, itemData, getPublicElement($itemFrame));\n    });\n    return $itemFrame;\n  },\n  _getItemContent: function ($itemFrame) {\n    var $itemContent = $itemFrame.find(\".\" + ITEM_CONTENT_PLACEHOLDER_CLASS);\n    $itemContent.removeClass(ITEM_CONTENT_PLACEHOLDER_CLASS);\n    return $itemContent;\n  },\n  _attachItemClickEvent: function (itemData, $itemElement) {\n    if (!itemData || !itemData.onClick) {\n      return;\n    }\n\n    eventsEngine.on($itemElement, clickEventName, function (e) {\n      this._itemEventHandlerByHandler($itemElement, itemData.onClick, {\n        event: e\n      });\n    }.bind(this));\n  },\n  _renderItemContent: function (args) {\n    var itemTemplateName = this._getItemTemplateName(args);\n\n    var itemTemplate = this._getTemplate(itemTemplateName);\n\n    this._addItemContentClasses(args);\n\n    var $templateResult = $(this._createItemByTemplate(itemTemplate, args));\n\n    if (!$templateResult.hasClass(TEMPLATE_WRAPPER_CLASS)) {\n      return args.container;\n    }\n\n    return this._renderItemContentByNode(args, $templateResult);\n  },\n  _renderItemContentByNode: function (args, $node) {\n    $(args.container).replaceWith($node);\n    args.container = getPublicElement($node);\n\n    this._addItemContentClasses(args);\n\n    return $node;\n  },\n  _addItemContentClasses: function (args) {\n    var classes = [ITEM_CLASS + CONTENT_CLASS_POSTFIX, args.contentClass];\n    $(args.container).addClass(classes.join(\" \"));\n  },\n  _appendItemToContainer: function ($container, $itemFrame, index) {\n    $itemFrame.appendTo($container);\n  },\n  _renderItemFrame: function (index, itemData, $container, $itemToReplace) {\n    var $itemFrame = $(\"<div>\");\n    new this.constructor.ItemClass($itemFrame, this._itemOptions(), itemData || {});\n\n    if ($itemToReplace && $itemToReplace.length) {\n      $itemToReplace.replaceWith($itemFrame);\n    } else {\n      this._appendItemToContainer.call(this, $container, $itemFrame, index);\n    }\n\n    if (this.option(\"useItemTextAsTitle\")) {\n      var displayValue = this._displayGetter ? this._displayGetter(itemData) : itemData;\n      $itemFrame.attr(\"title\", displayValue);\n    }\n\n    return $itemFrame;\n  },\n  _itemOptions: function () {\n    var that = this;\n    return {\n      watchMethod: function () {\n        return that.option(\"integrationOptions.watchMethod\");\n      },\n      owner: that,\n      fieldGetter: function (field) {\n        var expr = that.option(field + \"Expr\");\n        var getter = compileGetter(expr);\n        return getter;\n      }\n    };\n  },\n  _postprocessRenderItem: noop,\n  _executeItemRenderAction: function (index, itemData, itemElement) {\n    this._getItemRenderAction()({\n      itemElement: itemElement,\n      itemIndex: index,\n      itemData: itemData\n    });\n  },\n  _setElementData: function (element, data, index) {\n    element.addClass([ITEM_CLASS, this._itemClass()].join(\" \")).data(this._itemDataKey(), data).data(this._itemIndexKey(), index);\n  },\n  _createItemRenderAction: function () {\n    return this._itemRenderAction = this._createActionByOption(\"onItemRendered\", {\n      element: this.element(),\n      excludeValidators: [\"disabled\", \"readOnly\"],\n      category: \"rendering\"\n    });\n  },\n  _getItemRenderAction: function () {\n    return this._itemRenderAction || this._createItemRenderAction();\n  },\n  _getItemTemplateName: function (args) {\n    var data = args.itemData;\n    var templateProperty = args.templateProperty || this.option(\"itemTemplateProperty\");\n    var template = data && data[templateProperty];\n    return template || args.defaultTemplateName;\n  },\n  _createItemByTemplate: function (itemTemplate, renderArgs) {\n    return itemTemplate.render({\n      model: renderArgs.itemData,\n      container: renderArgs.container,\n      index: renderArgs.index\n    });\n  },\n  _emptyMessageContainer: function () {\n    return this._itemContainer();\n  },\n  _renderEmptyMessage: function (items) {\n    items = items || this.option(\"items\");\n    var noDataText = this.option(\"noDataText\");\n\n    var hideNoData = !noDataText || items && items.length || this._isDataSourceLoading();\n\n    if (hideNoData && this._$noData) {\n      this._$noData.remove();\n\n      this._$noData = null;\n      this.setAria(\"label\", void 0);\n    }\n\n    if (!hideNoData) {\n      this._$noData = this._$noData || $(\"<div>\").addClass(\"dx-empty-message\");\n\n      this._$noData.appendTo(this._emptyMessageContainer()).html(noDataText);\n\n      this.setAria(\"label\", noDataText);\n    }\n\n    this.$element().toggleClass(EMPTY_COLLECTION, !hideNoData);\n  },\n  _itemDXEventHandler: function (dxEvent, handlerOptionName, actionArgs, actionConfig) {\n    this._itemEventHandler(dxEvent.target, handlerOptionName, extend(actionArgs, {\n      event: dxEvent\n    }), actionConfig);\n  },\n  _itemEventHandler: function (initiator, handlerOptionName, actionArgs, actionConfig) {\n    var action = this._createActionByOption(handlerOptionName, extend({\n      validatingTargetName: \"itemElement\"\n    }, actionConfig));\n\n    return this._itemEventHandlerImpl(initiator, action, actionArgs);\n  },\n  _itemEventHandlerByHandler: function (initiator, handler, actionArgs, actionConfig) {\n    var action = this._createAction(handler, extend({\n      validatingTargetName: \"itemElement\"\n    }, actionConfig));\n\n    return this._itemEventHandlerImpl(initiator, action, actionArgs);\n  },\n  _itemEventHandlerImpl: function (initiator, action, actionArgs) {\n    var $itemElement = this._closestItemElement($(initiator));\n\n    var args = extend({}, actionArgs);\n    return action(extend(actionArgs, this._extendActionArgs($itemElement), args));\n  },\n  _extendActionArgs: function ($itemElement) {\n    return {\n      itemElement: getPublicElement($itemElement),\n      itemIndex: this._itemElements().index($itemElement),\n      itemData: this._getItemData($itemElement)\n    };\n  },\n  _closestItemElement: function ($element) {\n    return $($element).closest(this._itemSelector());\n  },\n  _getItemData: function (itemElement) {\n    return $(itemElement).data(this._itemDataKey());\n  },\n  _getSummaryItemsWidth: function (items, includeMargin) {\n    var result = 0;\n\n    if (items) {\n      each(items, function (_, item) {\n        result += getOuterWidth(item, includeMargin || false);\n      });\n    }\n\n    return result;\n  },\n  getFocusedItemId: function () {\n    if (!this._focusedItemId) {\n      this._focusedItemId = \"dx-\" + new Guid();\n    }\n\n    return this._focusedItemId;\n  },\n  itemElements: function () {\n    return this._itemElements();\n  },\n  itemsContainer: function () {\n    return this._itemContainer();\n  }\n}).include(DataHelperMixin);\nCollectionWidget.ItemClass = CollectionWidgetItem;\nexport default CollectionWidget;","map":{"version":3,"sources":["C:/Users/Zoran/source/repos/TransportApp/TransportLog-basic/node_modules/devextreme/esm/ui/collection/ui.collection_widget.base.js"],"names":["getOuterWidth","$","eventsEngine","ensureDefined","deferRenderer","noop","findTemplates","getPublicElement","domAdapter","isPlainObject","isFunction","isDefined","when","extend","each","Action","Guid","Widget","addNamespace","isCommandKeyPressed","pointerEvents","DataHelperMixin","CollectionWidgetItem","focusable","messageLocalization","holdEvent","compileGetter","name","clickEventName","contextMenuEventName","BindableTemplate","COLLECTION_CLASS","ITEM_CLASS","CONTENT_CLASS_POSTFIX","ITEM_CONTENT_PLACEHOLDER_CLASS","ITEM_DATA_KEY","ITEM_INDEX_KEY","ITEM_TEMPLATE_ID_PREFIX","ITEMS_OPTIONS_NAME","SELECTED_ITEM_CLASS","ITEM_RESPONSE_WAIT_CLASS","EMPTY_COLLECTION","TEMPLATE_WRAPPER_CLASS","ITEM_PATH_REGEX","ANONYMOUS_TEMPLATE_NAME","FOCUS_UP","FOCUS_DOWN","FOCUS_LEFT","FOCUS_RIGHT","FOCUS_PAGE_UP","FOCUS_PAGE_DOWN","FOCUS_LAST","FOCUS_FIRST","CollectionWidget","inherit","_activeStateUnit","_supportedKeys","enter","e","$itemElement","option","length","_itemClickHandler","target","get","currentTarget","move","location","preventDefault","stopPropagation","_moveFocus","callBase","space","call","leftArrow","bind","rightArrow","upArrow","downArrow","pageUp","pageDown","home","end","_getDefaultOptions","selectOnFocus","loopItemFocus","items","itemTemplate","onItemRendered","onItemClick","onItemHold","itemHoldTimeout","onItemContextMenu","onFocusedItemChanged","noDataText","format","dataSource","_itemAttributes","itemTemplateProperty","focusOnSelectedItem","focusedElement","displayExpr","disabledExpr","data","disabled","visibleExpr","visible","_init","_compileDisplayGetter","_cleanRenderedItems","_refreshDataSource","_displayGetter","_initTemplates","_initItemsFromMarkup","_initDefaultItemTemplate","_getAnonymousTemplateName","fieldsMap","_getFieldsMap","_templateManager","addDefaultTemplates","item","$container","_prepareDefaultItemTemplate","text","String","_getBindableFields","html","rawItems","$element","map","_ref","element","options","isTemplateRequired","test","innerHTML","template","_prepareItemTemplate","remove","templateId","$template","detach","clone","removeAttr","addClass","_saveTemplate","_dataSourceOptions","paginate","_renderedItemsCount","_focusTarget","_focusInHandler","apply","arguments","_isFocusTarget","$focusedElement","_setFocusedItem","$activeItem","_getActiveItem","_focusOutHandler","$target","_updateFocusedItemState","last","index","activeElements","_getActiveElement","lastIndex","eq","$items","_getAvailableItems","$newTarget","_prevItem","_nextItem","first","_getVisibleItems","$itemElements","_itemElements","filter","not","targetIndex","$last","$item","loop","$first","_selectFocusedItem","selectItem","isFocused","needCleanItemId","_refreshActiveDescendant","_refreshItemId","_toggleFocusClass","_updateParentActiveDescendant","setAria","getFocusedItemId","_findItemElementByItem","result","that","itemElements","_itemDataKey","_getIndexByItem","indexOf","_itemOptionChanged","property","value","oldValue","constructor","ItemClass","getInstance","setDataField","_refreshItem","isDisabling","_resetItemFocus","is","itemData","_getItemData","_itemIndexKey","_renderItem","_optionChanged","args","matches","fullName","match","itemPath","replace","previousValue","_invalidate","_renderEmptyMessage","_createItemRenderAction","_attachHoldEvent","_attachContextMenuEvent","_createActionByOption","_loadNextPage","_dataSource","_expectNextPageLoading","pageIndex","load","_startIndexForAppendedItems","_expectLastItemLoading","_forgetNextPageLoading","_dataSourceChangedHandler","newItems","_initialized","_shouldAppendItems","_isLastPage","concat","slice","_refreshContent","_prepareContent","_renderContent","_dataSourceLoadErrorHandler","_allowDynamicItemsAppend","_clean","_cleanFocusState","_cleanItemContainer","_itemContainer","empty","_dispose","clearTimeout","_itemFocusTimeout","_refresh","_itemClass","_itemContentClass","_selectedItemClass","_itemResponseWaitClass","_itemSelector","find","_initMarkup","_renderContentImpl","_fireContentReadyAction","_render","_attachClickEvent","itemSelector","clickEventNamespace","NAME","pointerDownEventNamespace","down","pointerDownAction","event","_itemPointerDownHandler","off","on","execute","config","_itemDXEventHandler","_itemFocusHandler","isDefaultPrevented","$closestItem","closest","$closestFocusable","_closestFocusable","setTimeout","_forcePointerDownFocus","parent","isDocument","_updateFocusState","$itemContainer","eventName","timeout","_getHoldTimeout","_itemHoldHandler","_shouldFireHoldEvent","hasActionSubscription","cancel","_itemContextMenuHandler","_shouldFireContextMenuEvent","_renderItems","$itemToReplace","_index$item","itemIndex","$itemFrame","_renderItemFrame","_setElementData","attr","_attachItemClickEvent","$itemContent","_getItemContent","renderContentPromise","_renderItemContent","container","contentClass","defaultTemplateName","done","_postprocessRenderItem","itemElement","itemContent","_executeItemRenderAction","removeClass","onClick","_itemEventHandlerByHandler","itemTemplateName","_getItemTemplateName","_getTemplate","_addItemContentClasses","$templateResult","_createItemByTemplate","hasClass","_renderItemContentByNode","$node","replaceWith","classes","join","_appendItemToContainer","appendTo","_itemOptions","displayValue","watchMethod","owner","fieldGetter","field","expr","getter","_getItemRenderAction","_itemRenderAction","excludeValidators","category","templateProperty","renderArgs","render","model","_emptyMessageContainer","hideNoData","_isDataSourceLoading","_$noData","toggleClass","dxEvent","handlerOptionName","actionArgs","actionConfig","_itemEventHandler","initiator","action","validatingTargetName","_itemEventHandlerImpl","handler","_createAction","_closestItemElement","_extendActionArgs","_getSummaryItemsWidth","includeMargin","_","_focusedItemId","itemsContainer","include"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (esm/ui/collection/ui.collection_widget.base.js)\r\n * Version: 22.1.6\r\n * Build date: Tue Oct 18 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport {\r\n    getOuterWidth\r\n} from \"../../core/utils/size\";\r\nimport $ from \"../../core/renderer\";\r\nimport eventsEngine from \"../../events/core/events_engine\";\r\nimport {\r\n    ensureDefined,\r\n    deferRenderer,\r\n    noop\r\n} from \"../../core/utils/common\";\r\nimport {\r\n    findTemplates\r\n} from \"../../core/utils/template_manager\";\r\nimport {\r\n    getPublicElement\r\n} from \"../../core/element\";\r\nimport domAdapter from \"../../core/dom_adapter\";\r\nimport {\r\n    isPlainObject,\r\n    isFunction,\r\n    isDefined\r\n} from \"../../core/utils/type\";\r\nimport {\r\n    when\r\n} from \"../../core/utils/deferred\";\r\nimport {\r\n    extend\r\n} from \"../../core/utils/extend\";\r\nimport {\r\n    each\r\n} from \"../../core/utils/iterator\";\r\nimport Action from \"../../core/action\";\r\nimport Guid from \"../../core/guid\";\r\nimport Widget from \"../widget/ui.widget\";\r\nimport {\r\n    addNamespace,\r\n    isCommandKeyPressed\r\n} from \"../../events/utils/index\";\r\nimport pointerEvents from \"../../events/pointer\";\r\nimport DataHelperMixin from \"../../data_helper\";\r\nimport CollectionWidgetItem from \"./item\";\r\nimport {\r\n    focusable\r\n} from \"../widget/selectors\";\r\nimport messageLocalization from \"../../localization/message\";\r\nimport holdEvent from \"../../events/hold\";\r\nimport {\r\n    compileGetter\r\n} from \"../../core/utils/data\";\r\nimport {\r\n    name as clickEventName\r\n} from \"../../events/click\";\r\nimport {\r\n    name as contextMenuEventName\r\n} from \"../../events/contextmenu\";\r\nimport {\r\n    BindableTemplate\r\n} from \"../../core/templates/bindable_template\";\r\nvar COLLECTION_CLASS = \"dx-collection\";\r\nvar ITEM_CLASS = \"dx-item\";\r\nvar CONTENT_CLASS_POSTFIX = \"-content\";\r\nvar ITEM_CONTENT_PLACEHOLDER_CLASS = \"dx-item-content-placeholder\";\r\nvar ITEM_DATA_KEY = \"dxItemData\";\r\nvar ITEM_INDEX_KEY = \"dxItemIndex\";\r\nvar ITEM_TEMPLATE_ID_PREFIX = \"tmpl-\";\r\nvar ITEMS_OPTIONS_NAME = \"dxItem\";\r\nvar SELECTED_ITEM_CLASS = \"dx-item-selected\";\r\nvar ITEM_RESPONSE_WAIT_CLASS = \"dx-item-response-wait\";\r\nvar EMPTY_COLLECTION = \"dx-empty-collection\";\r\nvar TEMPLATE_WRAPPER_CLASS = \"dx-template-wrapper\";\r\nvar ITEM_PATH_REGEX = /^([^.]+\\[\\d+\\]\\.)+([\\w.]+)$/;\r\nvar ANONYMOUS_TEMPLATE_NAME = \"item\";\r\nvar FOCUS_UP = \"up\";\r\nvar FOCUS_DOWN = \"down\";\r\nvar FOCUS_LEFT = \"left\";\r\nvar FOCUS_RIGHT = \"right\";\r\nvar FOCUS_PAGE_UP = \"pageup\";\r\nvar FOCUS_PAGE_DOWN = \"pagedown\";\r\nvar FOCUS_LAST = \"last\";\r\nvar FOCUS_FIRST = \"first\";\r\nvar CollectionWidget = Widget.inherit({\r\n    _activeStateUnit: \".\" + ITEM_CLASS,\r\n    _supportedKeys: function() {\r\n        var enter = function(e) {\r\n            var $itemElement = $(this.option(\"focusedElement\"));\r\n            if (!$itemElement.length) {\r\n                return\r\n            }\r\n            this._itemClickHandler(extend({}, e, {\r\n                target: $itemElement.get(0),\r\n                currentTarget: $itemElement.get(0)\r\n            }))\r\n        };\r\n        var move = function(location, e) {\r\n            if (!isCommandKeyPressed(e)) {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                this._moveFocus(location, e)\r\n            }\r\n        };\r\n        return extend(this.callBase(), {\r\n            space: function(e) {\r\n                e.preventDefault();\r\n                enter.call(this, e)\r\n            },\r\n            enter: enter,\r\n            leftArrow: move.bind(this, FOCUS_LEFT),\r\n            rightArrow: move.bind(this, FOCUS_RIGHT),\r\n            upArrow: move.bind(this, FOCUS_UP),\r\n            downArrow: move.bind(this, FOCUS_DOWN),\r\n            pageUp: move.bind(this, FOCUS_UP),\r\n            pageDown: move.bind(this, FOCUS_DOWN),\r\n            home: move.bind(this, FOCUS_FIRST),\r\n            end: move.bind(this, FOCUS_LAST)\r\n        })\r\n    },\r\n    _getDefaultOptions: function() {\r\n        return extend(this.callBase(), {\r\n            selectOnFocus: false,\r\n            loopItemFocus: true,\r\n            items: [],\r\n            itemTemplate: \"item\",\r\n            onItemRendered: null,\r\n            onItemClick: null,\r\n            onItemHold: null,\r\n            itemHoldTimeout: 750,\r\n            onItemContextMenu: null,\r\n            onFocusedItemChanged: null,\r\n            noDataText: messageLocalization.format(\"dxCollectionWidget-noDataText\"),\r\n            dataSource: null,\r\n            _itemAttributes: {},\r\n            itemTemplateProperty: \"template\",\r\n            focusOnSelectedItem: true,\r\n            focusedElement: null,\r\n            displayExpr: void 0,\r\n            disabledExpr: function(data) {\r\n                return data ? data.disabled : void 0\r\n            },\r\n            visibleExpr: function(data) {\r\n                return data ? data.visible : void 0\r\n            }\r\n        })\r\n    },\r\n    _init: function() {\r\n        this._compileDisplayGetter();\r\n        this.callBase();\r\n        this._cleanRenderedItems();\r\n        this._refreshDataSource()\r\n    },\r\n    _compileDisplayGetter: function() {\r\n        var displayExpr = this.option(\"displayExpr\");\r\n        this._displayGetter = displayExpr ? compileGetter(this.option(\"displayExpr\")) : void 0\r\n    },\r\n    _initTemplates: function() {\r\n        this._initItemsFromMarkup();\r\n        this._initDefaultItemTemplate();\r\n        this.callBase()\r\n    },\r\n    _getAnonymousTemplateName: function() {\r\n        return ANONYMOUS_TEMPLATE_NAME\r\n    },\r\n    _initDefaultItemTemplate: function() {\r\n        var fieldsMap = this._getFieldsMap();\r\n        this._templateManager.addDefaultTemplates({\r\n            item: new BindableTemplate(function($container, data) {\r\n                if (isPlainObject(data)) {\r\n                    this._prepareDefaultItemTemplate(data, $container)\r\n                } else {\r\n                    if (fieldsMap && isFunction(fieldsMap.text)) {\r\n                        data = fieldsMap.text(data)\r\n                    }\r\n                    $container.text(String(ensureDefined(data, \"\")))\r\n                }\r\n            }.bind(this), this._getBindableFields(), this.option(\"integrationOptions.watchMethod\"), fieldsMap)\r\n        })\r\n    },\r\n    _getBindableFields: function() {\r\n        return [\"text\", \"html\"]\r\n    },\r\n    _getFieldsMap: function() {\r\n        if (this._displayGetter) {\r\n            return {\r\n                text: this._displayGetter\r\n            }\r\n        }\r\n    },\r\n    _prepareDefaultItemTemplate: function(data, $container) {\r\n        if (isDefined(data.text)) {\r\n            $container.text(data.text)\r\n        }\r\n        if (isDefined(data.html)) {\r\n            $container.html(data.html)\r\n        }\r\n    },\r\n    _initItemsFromMarkup: function() {\r\n        var rawItems = findTemplates(this.$element(), ITEMS_OPTIONS_NAME);\r\n        if (!rawItems.length || this.option(\"items\").length) {\r\n            return\r\n        }\r\n        var items = rawItems.map(_ref => {\r\n            var {\r\n                element: element,\r\n                options: options\r\n            } = _ref;\r\n            var isTemplateRequired = /\\S/.test(element.innerHTML) && !options.template;\r\n            if (isTemplateRequired) {\r\n                options.template = this._prepareItemTemplate(element)\r\n            } else {\r\n                $(element).remove()\r\n            }\r\n            return options\r\n        });\r\n        this.option(\"items\", items)\r\n    },\r\n    _prepareItemTemplate: function(item) {\r\n        var templateId = ITEM_TEMPLATE_ID_PREFIX + new Guid;\r\n        var $template = $(item).detach().clone().removeAttr(\"data-options\").addClass(TEMPLATE_WRAPPER_CLASS);\r\n        this._saveTemplate(templateId, $template);\r\n        return templateId\r\n    },\r\n    _dataSourceOptions: function() {\r\n        return {\r\n            paginate: false\r\n        }\r\n    },\r\n    _cleanRenderedItems: function() {\r\n        this._renderedItemsCount = 0\r\n    },\r\n    _focusTarget: function() {\r\n        return this.$element()\r\n    },\r\n    _focusInHandler: function(e) {\r\n        this.callBase.apply(this, arguments);\r\n        if (!this._isFocusTarget(e.target)) {\r\n            return\r\n        }\r\n        var $focusedElement = $(this.option(\"focusedElement\"));\r\n        if ($focusedElement.length) {\r\n            this._setFocusedItem($focusedElement)\r\n        } else {\r\n            var $activeItem = this._getActiveItem();\r\n            if ($activeItem.length) {\r\n                this.option(\"focusedElement\", getPublicElement($activeItem))\r\n            }\r\n        }\r\n    },\r\n    _focusOutHandler: function() {\r\n        this.callBase.apply(this, arguments);\r\n        var $target = $(this.option(\"focusedElement\"));\r\n        this._updateFocusedItemState($target, false)\r\n    },\r\n    _getActiveItem: function(last) {\r\n        var $focusedElement = $(this.option(\"focusedElement\"));\r\n        if ($focusedElement.length) {\r\n            return $focusedElement\r\n        }\r\n        var index = this.option(\"focusOnSelectedItem\") ? this.option(\"selectedIndex\") : 0;\r\n        var activeElements = this._getActiveElement();\r\n        var lastIndex = activeElements.length - 1;\r\n        if (index < 0) {\r\n            index = last ? lastIndex : 0\r\n        }\r\n        return activeElements.eq(index)\r\n    },\r\n    _moveFocus: function(location) {\r\n        var $items = this._getAvailableItems();\r\n        var $newTarget;\r\n        switch (location) {\r\n            case FOCUS_PAGE_UP:\r\n            case FOCUS_UP:\r\n                $newTarget = this._prevItem($items);\r\n                break;\r\n            case FOCUS_PAGE_DOWN:\r\n            case FOCUS_DOWN:\r\n                $newTarget = this._nextItem($items);\r\n                break;\r\n            case FOCUS_RIGHT:\r\n                $newTarget = this.option(\"rtlEnabled\") ? this._prevItem($items) : this._nextItem($items);\r\n                break;\r\n            case FOCUS_LEFT:\r\n                $newTarget = this.option(\"rtlEnabled\") ? this._nextItem($items) : this._prevItem($items);\r\n                break;\r\n            case FOCUS_FIRST:\r\n                $newTarget = $items.first();\r\n                break;\r\n            case FOCUS_LAST:\r\n                $newTarget = $items.last();\r\n                break;\r\n            default:\r\n                return false\r\n        }\r\n        if (0 !== $newTarget.length) {\r\n            this.option(\"focusedElement\", getPublicElement($newTarget))\r\n        }\r\n    },\r\n    _getVisibleItems: function($itemElements) {\r\n        $itemElements = $itemElements || this._itemElements();\r\n        return $itemElements.filter(\":visible\")\r\n    },\r\n    _getAvailableItems: function($itemElements) {\r\n        return this._getVisibleItems($itemElements).not(\".dx-state-disabled\")\r\n    },\r\n    _prevItem: function($items) {\r\n        var $target = this._getActiveItem();\r\n        var targetIndex = $items.index($target);\r\n        var $last = $items.last();\r\n        var $item = $($items[targetIndex - 1]);\r\n        var loop = this.option(\"loopItemFocus\");\r\n        if (0 === $item.length && loop) {\r\n            $item = $last\r\n        }\r\n        return $item\r\n    },\r\n    _nextItem: function($items) {\r\n        var $target = this._getActiveItem(true);\r\n        var targetIndex = $items.index($target);\r\n        var $first = $items.first();\r\n        var $item = $($items[targetIndex + 1]);\r\n        var loop = this.option(\"loopItemFocus\");\r\n        if (0 === $item.length && loop) {\r\n            $item = $first\r\n        }\r\n        return $item\r\n    },\r\n    _selectFocusedItem: function($target) {\r\n        this.selectItem($target)\r\n    },\r\n    _updateFocusedItemState: function(target, isFocused, needCleanItemId) {\r\n        var $target = $(target);\r\n        if ($target.length) {\r\n            this._refreshActiveDescendant();\r\n            this._refreshItemId($target, needCleanItemId);\r\n            this._toggleFocusClass(isFocused, $target)\r\n        }\r\n        this._updateParentActiveDescendant()\r\n    },\r\n    _refreshActiveDescendant: function($target) {\r\n        this.setAria(\"activedescendant\", isDefined(this.option(\"focusedElement\")) ? this.getFocusedItemId() : null, $target)\r\n    },\r\n    _refreshItemId: function($target, needCleanItemId) {\r\n        if (!needCleanItemId && this.option(\"focusedElement\")) {\r\n            this.setAria(\"id\", this.getFocusedItemId(), $target)\r\n        } else {\r\n            this.setAria(\"id\", null, $target)\r\n        }\r\n    },\r\n    _setFocusedItem: function($target) {\r\n        if (!$target || !$target.length) {\r\n            return\r\n        }\r\n        this._updateFocusedItemState($target, true);\r\n        this.onFocusedItemChanged(this.getFocusedItemId());\r\n        if (this.option(\"selectOnFocus\")) {\r\n            this._selectFocusedItem($target)\r\n        }\r\n    },\r\n    _findItemElementByItem: function(item) {\r\n        var result = $();\r\n        var that = this;\r\n        this.itemElements().each((function() {\r\n            var $item = $(this);\r\n            if ($item.data(that._itemDataKey()) === item) {\r\n                result = $item;\r\n                return false\r\n            }\r\n        }));\r\n        return result\r\n    },\r\n    _getIndexByItem: function(item) {\r\n        return this.option(\"items\").indexOf(item)\r\n    },\r\n    _itemOptionChanged: function(item, property, value, oldValue) {\r\n        var $item = this._findItemElementByItem(item);\r\n        if (!$item.length) {\r\n            return\r\n        }\r\n        if (!this.constructor.ItemClass.getInstance($item).setDataField(property, value)) {\r\n            this._refreshItem($item, item)\r\n        }\r\n        var isDisabling = \"disabled\" === property && value;\r\n        if (isDisabling) {\r\n            this._resetItemFocus($item)\r\n        }\r\n    },\r\n    _resetItemFocus($item) {\r\n        if ($item.is(this.option(\"focusedElement\"))) {\r\n            this.option(\"focusedElement\", null)\r\n        }\r\n    },\r\n    _refreshItem: function($item) {\r\n        var itemData = this._getItemData($item);\r\n        var index = $item.data(this._itemIndexKey());\r\n        this._renderItem(this._renderedItemsCount + index, itemData, null, $item)\r\n    },\r\n    _updateParentActiveDescendant: noop,\r\n    _optionChanged: function(args) {\r\n        if (\"items\" === args.name) {\r\n            var matches = args.fullName.match(ITEM_PATH_REGEX);\r\n            if (matches && matches.length) {\r\n                var property = matches[matches.length - 1];\r\n                var itemPath = args.fullName.replace(\".\" + property, \"\");\r\n                var item = this.option(itemPath);\r\n                this._itemOptionChanged(item, property, args.value, args.previousValue);\r\n                return\r\n            }\r\n        }\r\n        switch (args.name) {\r\n            case \"items\":\r\n            case \"_itemAttributes\":\r\n            case \"itemTemplateProperty\":\r\n            case \"useItemTextAsTitle\":\r\n                this._cleanRenderedItems();\r\n                this._invalidate();\r\n                break;\r\n            case \"dataSource\":\r\n                this._refreshDataSource();\r\n                this._renderEmptyMessage();\r\n                break;\r\n            case \"noDataText\":\r\n                this._renderEmptyMessage();\r\n                break;\r\n            case \"itemTemplate\":\r\n                this._invalidate();\r\n                break;\r\n            case \"onItemRendered\":\r\n                this._createItemRenderAction();\r\n                break;\r\n            case \"onItemClick\":\r\n                break;\r\n            case \"onItemHold\":\r\n            case \"itemHoldTimeout\":\r\n                this._attachHoldEvent();\r\n                break;\r\n            case \"onItemContextMenu\":\r\n                this._attachContextMenuEvent();\r\n                break;\r\n            case \"onFocusedItemChanged\":\r\n                this.onFocusedItemChanged = this._createActionByOption(\"onFocusedItemChanged\");\r\n                break;\r\n            case \"selectOnFocus\":\r\n            case \"loopItemFocus\":\r\n            case \"focusOnSelectedItem\":\r\n                break;\r\n            case \"focusedElement\":\r\n                this._updateFocusedItemState(args.previousValue, false, true);\r\n                this._setFocusedItem($(args.value));\r\n                break;\r\n            case \"displayExpr\":\r\n                this._compileDisplayGetter();\r\n                this._initDefaultItemTemplate();\r\n                this._invalidate();\r\n                break;\r\n            case \"visibleExpr\":\r\n            case \"disabledExpr\":\r\n                this._invalidate();\r\n                break;\r\n            default:\r\n                this.callBase(args)\r\n        }\r\n    },\r\n    _invalidate: function() {\r\n        this.option(\"focusedElement\", null);\r\n        return this.callBase.apply(this, arguments)\r\n    },\r\n    _loadNextPage: function() {\r\n        var dataSource = this._dataSource;\r\n        this._expectNextPageLoading();\r\n        dataSource.pageIndex(1 + dataSource.pageIndex());\r\n        return dataSource.load()\r\n    },\r\n    _expectNextPageLoading: function() {\r\n        this._startIndexForAppendedItems = 0\r\n    },\r\n    _expectLastItemLoading: function() {\r\n        this._startIndexForAppendedItems = -1\r\n    },\r\n    _forgetNextPageLoading: function() {\r\n        this._startIndexForAppendedItems = null\r\n    },\r\n    _dataSourceChangedHandler: function(newItems) {\r\n        var items = this.option(\"items\");\r\n        if (this._initialized && items && this._shouldAppendItems()) {\r\n            this._renderedItemsCount = items.length;\r\n            if (!this._isLastPage() || -1 !== this._startIndexForAppendedItems) {\r\n                this.option().items = items.concat(newItems.slice(this._startIndexForAppendedItems))\r\n            }\r\n            this._forgetNextPageLoading();\r\n            this._refreshContent()\r\n        } else {\r\n            this.option(\"items\", newItems.slice())\r\n        }\r\n    },\r\n    _refreshContent: function() {\r\n        this._prepareContent();\r\n        this._renderContent()\r\n    },\r\n    _dataSourceLoadErrorHandler: function() {\r\n        this._forgetNextPageLoading();\r\n        this.option(\"items\", this.option(\"items\"))\r\n    },\r\n    _shouldAppendItems: function() {\r\n        return null != this._startIndexForAppendedItems && this._allowDynamicItemsAppend()\r\n    },\r\n    _allowDynamicItemsAppend: function() {\r\n        return false\r\n    },\r\n    _clean: function() {\r\n        this._cleanFocusState();\r\n        this._cleanItemContainer()\r\n    },\r\n    _cleanItemContainer: function() {\r\n        $(this._itemContainer()).empty()\r\n    },\r\n    _dispose: function() {\r\n        this.callBase();\r\n        clearTimeout(this._itemFocusTimeout)\r\n    },\r\n    _refresh: function() {\r\n        this._cleanRenderedItems();\r\n        this.callBase.apply(this, arguments)\r\n    },\r\n    _itemContainer: function() {\r\n        return this.$element()\r\n    },\r\n    _itemClass: function() {\r\n        return ITEM_CLASS\r\n    },\r\n    _itemContentClass: function() {\r\n        return this._itemClass() + CONTENT_CLASS_POSTFIX\r\n    },\r\n    _selectedItemClass: function() {\r\n        return SELECTED_ITEM_CLASS\r\n    },\r\n    _itemResponseWaitClass: function() {\r\n        return ITEM_RESPONSE_WAIT_CLASS\r\n    },\r\n    _itemSelector: function() {\r\n        return \".\" + this._itemClass()\r\n    },\r\n    _itemDataKey: function() {\r\n        return ITEM_DATA_KEY\r\n    },\r\n    _itemIndexKey: function() {\r\n        return ITEM_INDEX_KEY\r\n    },\r\n    _itemElements: function() {\r\n        return this._itemContainer().find(this._itemSelector())\r\n    },\r\n    _initMarkup: function() {\r\n        this.callBase();\r\n        this.onFocusedItemChanged = this._createActionByOption(\"onFocusedItemChanged\");\r\n        this.$element().addClass(COLLECTION_CLASS);\r\n        this._prepareContent()\r\n    },\r\n    _prepareContent: deferRenderer((function() {\r\n        this._renderContentImpl()\r\n    })),\r\n    _renderContent: function() {\r\n        this._fireContentReadyAction()\r\n    },\r\n    _render: function() {\r\n        this.callBase();\r\n        this._attachClickEvent();\r\n        this._attachHoldEvent();\r\n        this._attachContextMenuEvent()\r\n    },\r\n    _attachClickEvent: function() {\r\n        var itemSelector = this._itemSelector();\r\n        var clickEventNamespace = addNamespace(clickEventName, this.NAME);\r\n        var pointerDownEventNamespace = addNamespace(pointerEvents.down, this.NAME);\r\n        var that = this;\r\n        var pointerDownAction = new Action((function(args) {\r\n            var event = args.event;\r\n            that._itemPointerDownHandler(event)\r\n        }));\r\n        eventsEngine.off(this._itemContainer(), clickEventNamespace, itemSelector);\r\n        eventsEngine.off(this._itemContainer(), pointerDownEventNamespace, itemSelector);\r\n        eventsEngine.on(this._itemContainer(), clickEventNamespace, itemSelector, function(e) {\r\n            this._itemClickHandler(e)\r\n        }.bind(this));\r\n        eventsEngine.on(this._itemContainer(), pointerDownEventNamespace, itemSelector, (function(e) {\r\n            pointerDownAction.execute({\r\n                element: $(e.target),\r\n                event: e\r\n            })\r\n        }))\r\n    },\r\n    _itemClickHandler: function(e, args, config) {\r\n        this._itemDXEventHandler(e, \"onItemClick\", args, config)\r\n    },\r\n    _itemPointerDownHandler: function(e) {\r\n        if (!this.option(\"focusStateEnabled\")) {\r\n            return\r\n        }\r\n        this._itemFocusHandler = function() {\r\n            clearTimeout(this._itemFocusTimeout);\r\n            this._itemFocusHandler = null;\r\n            if (e.isDefaultPrevented()) {\r\n                return\r\n            }\r\n            var $target = $(e.target);\r\n            var $closestItem = $target.closest(this._itemElements());\r\n            var $closestFocusable = this._closestFocusable($target);\r\n            if ($closestItem.length && this._isFocusTarget(null === $closestFocusable || void 0 === $closestFocusable ? void 0 : $closestFocusable.get(0))) {\r\n                this.option(\"focusedElement\", getPublicElement($closestItem))\r\n            }\r\n        }.bind(this);\r\n        this._itemFocusTimeout = setTimeout(this._forcePointerDownFocus.bind(this))\r\n    },\r\n    _closestFocusable: function($target) {\r\n        if ($target.is(focusable)) {\r\n            return $target\r\n        } else {\r\n            $target = $target.parent();\r\n            while ($target.length && !domAdapter.isDocument($target.get(0))) {\r\n                if ($target.is(focusable)) {\r\n                    return $target\r\n                }\r\n                $target = $target.parent()\r\n            }\r\n        }\r\n    },\r\n    _forcePointerDownFocus: function() {\r\n        this._itemFocusHandler && this._itemFocusHandler()\r\n    },\r\n    _updateFocusState: function() {\r\n        this.callBase.apply(this, arguments);\r\n        this._forcePointerDownFocus()\r\n    },\r\n    _attachHoldEvent: function() {\r\n        var $itemContainer = this._itemContainer();\r\n        var itemSelector = this._itemSelector();\r\n        var eventName = addNamespace(holdEvent.name, this.NAME);\r\n        eventsEngine.off($itemContainer, eventName, itemSelector);\r\n        eventsEngine.on($itemContainer, eventName, itemSelector, {\r\n            timeout: this._getHoldTimeout()\r\n        }, this._itemHoldHandler.bind(this))\r\n    },\r\n    _getHoldTimeout: function() {\r\n        return this.option(\"itemHoldTimeout\")\r\n    },\r\n    _shouldFireHoldEvent: function() {\r\n        return this.hasActionSubscription(\"onItemHold\")\r\n    },\r\n    _itemHoldHandler: function(e) {\r\n        if (this._shouldFireHoldEvent()) {\r\n            this._itemDXEventHandler(e, \"onItemHold\")\r\n        } else {\r\n            e.cancel = true\r\n        }\r\n    },\r\n    _attachContextMenuEvent: function() {\r\n        var $itemContainer = this._itemContainer();\r\n        var itemSelector = this._itemSelector();\r\n        var eventName = addNamespace(contextMenuEventName, this.NAME);\r\n        eventsEngine.off($itemContainer, eventName, itemSelector);\r\n        eventsEngine.on($itemContainer, eventName, itemSelector, this._itemContextMenuHandler.bind(this))\r\n    },\r\n    _shouldFireContextMenuEvent: function() {\r\n        return this.hasActionSubscription(\"onItemContextMenu\")\r\n    },\r\n    _itemContextMenuHandler: function(e) {\r\n        if (this._shouldFireContextMenuEvent()) {\r\n            this._itemDXEventHandler(e, \"onItemContextMenu\")\r\n        } else {\r\n            e.cancel = true\r\n        }\r\n    },\r\n    _renderContentImpl: function() {\r\n        var items = this.option(\"items\") || [];\r\n        if (this._renderedItemsCount) {\r\n            this._renderItems(items.slice(this._renderedItemsCount))\r\n        } else {\r\n            this._renderItems(items)\r\n        }\r\n    },\r\n    _renderItems: function(items) {\r\n        if (items.length) {\r\n            each(items, function(index, itemData) {\r\n                this._renderItem(this._renderedItemsCount + index, itemData)\r\n            }.bind(this))\r\n        }\r\n        this._renderEmptyMessage()\r\n    },\r\n    _renderItem: function(index, itemData, $container, $itemToReplace) {\r\n        var _index$item;\r\n        var itemIndex = null !== (_index$item = null === index || void 0 === index ? void 0 : index.item) && void 0 !== _index$item ? _index$item : index;\r\n        $container = $container || this._itemContainer();\r\n        var $itemFrame = this._renderItemFrame(itemIndex, itemData, $container, $itemToReplace);\r\n        this._setElementData($itemFrame, itemData, itemIndex);\r\n        $itemFrame.attr(this.option(\"_itemAttributes\"));\r\n        this._attachItemClickEvent(itemData, $itemFrame);\r\n        var $itemContent = this._getItemContent($itemFrame);\r\n        var renderContentPromise = this._renderItemContent({\r\n            index: itemIndex,\r\n            itemData: itemData,\r\n            container: getPublicElement($itemContent),\r\n            contentClass: this._itemContentClass(),\r\n            defaultTemplateName: this.option(\"itemTemplate\")\r\n        });\r\n        var that = this;\r\n        when(renderContentPromise).done((function($itemContent) {\r\n            that._postprocessRenderItem({\r\n                itemElement: $itemFrame,\r\n                itemContent: $itemContent,\r\n                itemData: itemData,\r\n                itemIndex: itemIndex\r\n            });\r\n            that._executeItemRenderAction(index, itemData, getPublicElement($itemFrame))\r\n        }));\r\n        return $itemFrame\r\n    },\r\n    _getItemContent: function($itemFrame) {\r\n        var $itemContent = $itemFrame.find(\".\" + ITEM_CONTENT_PLACEHOLDER_CLASS);\r\n        $itemContent.removeClass(ITEM_CONTENT_PLACEHOLDER_CLASS);\r\n        return $itemContent\r\n    },\r\n    _attachItemClickEvent: function(itemData, $itemElement) {\r\n        if (!itemData || !itemData.onClick) {\r\n            return\r\n        }\r\n        eventsEngine.on($itemElement, clickEventName, function(e) {\r\n            this._itemEventHandlerByHandler($itemElement, itemData.onClick, {\r\n                event: e\r\n            })\r\n        }.bind(this))\r\n    },\r\n    _renderItemContent: function(args) {\r\n        var itemTemplateName = this._getItemTemplateName(args);\r\n        var itemTemplate = this._getTemplate(itemTemplateName);\r\n        this._addItemContentClasses(args);\r\n        var $templateResult = $(this._createItemByTemplate(itemTemplate, args));\r\n        if (!$templateResult.hasClass(TEMPLATE_WRAPPER_CLASS)) {\r\n            return args.container\r\n        }\r\n        return this._renderItemContentByNode(args, $templateResult)\r\n    },\r\n    _renderItemContentByNode: function(args, $node) {\r\n        $(args.container).replaceWith($node);\r\n        args.container = getPublicElement($node);\r\n        this._addItemContentClasses(args);\r\n        return $node\r\n    },\r\n    _addItemContentClasses: function(args) {\r\n        var classes = [ITEM_CLASS + CONTENT_CLASS_POSTFIX, args.contentClass];\r\n        $(args.container).addClass(classes.join(\" \"))\r\n    },\r\n    _appendItemToContainer: function($container, $itemFrame, index) {\r\n        $itemFrame.appendTo($container)\r\n    },\r\n    _renderItemFrame: function(index, itemData, $container, $itemToReplace) {\r\n        var $itemFrame = $(\"<div>\");\r\n        new this.constructor.ItemClass($itemFrame, this._itemOptions(), itemData || {});\r\n        if ($itemToReplace && $itemToReplace.length) {\r\n            $itemToReplace.replaceWith($itemFrame)\r\n        } else {\r\n            this._appendItemToContainer.call(this, $container, $itemFrame, index)\r\n        }\r\n        if (this.option(\"useItemTextAsTitle\")) {\r\n            var displayValue = this._displayGetter ? this._displayGetter(itemData) : itemData;\r\n            $itemFrame.attr(\"title\", displayValue)\r\n        }\r\n        return $itemFrame\r\n    },\r\n    _itemOptions: function() {\r\n        var that = this;\r\n        return {\r\n            watchMethod: function() {\r\n                return that.option(\"integrationOptions.watchMethod\")\r\n            },\r\n            owner: that,\r\n            fieldGetter: function(field) {\r\n                var expr = that.option(field + \"Expr\");\r\n                var getter = compileGetter(expr);\r\n                return getter\r\n            }\r\n        }\r\n    },\r\n    _postprocessRenderItem: noop,\r\n    _executeItemRenderAction: function(index, itemData, itemElement) {\r\n        this._getItemRenderAction()({\r\n            itemElement: itemElement,\r\n            itemIndex: index,\r\n            itemData: itemData\r\n        })\r\n    },\r\n    _setElementData: function(element, data, index) {\r\n        element.addClass([ITEM_CLASS, this._itemClass()].join(\" \")).data(this._itemDataKey(), data).data(this._itemIndexKey(), index)\r\n    },\r\n    _createItemRenderAction: function() {\r\n        return this._itemRenderAction = this._createActionByOption(\"onItemRendered\", {\r\n            element: this.element(),\r\n            excludeValidators: [\"disabled\", \"readOnly\"],\r\n            category: \"rendering\"\r\n        })\r\n    },\r\n    _getItemRenderAction: function() {\r\n        return this._itemRenderAction || this._createItemRenderAction()\r\n    },\r\n    _getItemTemplateName: function(args) {\r\n        var data = args.itemData;\r\n        var templateProperty = args.templateProperty || this.option(\"itemTemplateProperty\");\r\n        var template = data && data[templateProperty];\r\n        return template || args.defaultTemplateName\r\n    },\r\n    _createItemByTemplate: function(itemTemplate, renderArgs) {\r\n        return itemTemplate.render({\r\n            model: renderArgs.itemData,\r\n            container: renderArgs.container,\r\n            index: renderArgs.index\r\n        })\r\n    },\r\n    _emptyMessageContainer: function() {\r\n        return this._itemContainer()\r\n    },\r\n    _renderEmptyMessage: function(items) {\r\n        items = items || this.option(\"items\");\r\n        var noDataText = this.option(\"noDataText\");\r\n        var hideNoData = !noDataText || items && items.length || this._isDataSourceLoading();\r\n        if (hideNoData && this._$noData) {\r\n            this._$noData.remove();\r\n            this._$noData = null;\r\n            this.setAria(\"label\", void 0)\r\n        }\r\n        if (!hideNoData) {\r\n            this._$noData = this._$noData || $(\"<div>\").addClass(\"dx-empty-message\");\r\n            this._$noData.appendTo(this._emptyMessageContainer()).html(noDataText);\r\n            this.setAria(\"label\", noDataText)\r\n        }\r\n        this.$element().toggleClass(EMPTY_COLLECTION, !hideNoData)\r\n    },\r\n    _itemDXEventHandler: function(dxEvent, handlerOptionName, actionArgs, actionConfig) {\r\n        this._itemEventHandler(dxEvent.target, handlerOptionName, extend(actionArgs, {\r\n            event: dxEvent\r\n        }), actionConfig)\r\n    },\r\n    _itemEventHandler: function(initiator, handlerOptionName, actionArgs, actionConfig) {\r\n        var action = this._createActionByOption(handlerOptionName, extend({\r\n            validatingTargetName: \"itemElement\"\r\n        }, actionConfig));\r\n        return this._itemEventHandlerImpl(initiator, action, actionArgs)\r\n    },\r\n    _itemEventHandlerByHandler: function(initiator, handler, actionArgs, actionConfig) {\r\n        var action = this._createAction(handler, extend({\r\n            validatingTargetName: \"itemElement\"\r\n        }, actionConfig));\r\n        return this._itemEventHandlerImpl(initiator, action, actionArgs)\r\n    },\r\n    _itemEventHandlerImpl: function(initiator, action, actionArgs) {\r\n        var $itemElement = this._closestItemElement($(initiator));\r\n        var args = extend({}, actionArgs);\r\n        return action(extend(actionArgs, this._extendActionArgs($itemElement), args))\r\n    },\r\n    _extendActionArgs: function($itemElement) {\r\n        return {\r\n            itemElement: getPublicElement($itemElement),\r\n            itemIndex: this._itemElements().index($itemElement),\r\n            itemData: this._getItemData($itemElement)\r\n        }\r\n    },\r\n    _closestItemElement: function($element) {\r\n        return $($element).closest(this._itemSelector())\r\n    },\r\n    _getItemData: function(itemElement) {\r\n        return $(itemElement).data(this._itemDataKey())\r\n    },\r\n    _getSummaryItemsWidth: function(items, includeMargin) {\r\n        var result = 0;\r\n        if (items) {\r\n            each(items, (function(_, item) {\r\n                result += getOuterWidth(item, includeMargin || false)\r\n            }))\r\n        }\r\n        return result\r\n    },\r\n    getFocusedItemId: function() {\r\n        if (!this._focusedItemId) {\r\n            this._focusedItemId = \"dx-\" + new Guid\r\n        }\r\n        return this._focusedItemId\r\n    },\r\n    itemElements: function() {\r\n        return this._itemElements()\r\n    },\r\n    itemsContainer: function() {\r\n        return this._itemContainer()\r\n    }\r\n}).include(DataHelperMixin);\r\nCollectionWidget.ItemClass = CollectionWidgetItem;\r\nexport default CollectionWidget;\r\n"]},"metadata":{},"sourceType":"module"}