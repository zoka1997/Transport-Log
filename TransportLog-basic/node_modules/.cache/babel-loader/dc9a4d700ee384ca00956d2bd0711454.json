{"ast":null,"code":"/**\r\n * DevExtreme (esm/ui/context_menu/ui.context_menu.js)\r\n * Version: 22.1.6\r\n * Build date: Tue Oct 18 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport $ from \"../../core/renderer\";\nimport domAdapter from \"../../core/dom_adapter\";\nimport eventsEngine from \"../../events/core/events_engine\";\nimport Guid from \"../../core/guid\";\nimport registerComponent from \"../../core/component_registrator\";\nimport { noop } from \"../../core/utils/common\";\nimport { isObject, isRenderer, isWindow, isFunction, isPlainObject, isDefined } from \"../../core/utils/type\";\nimport { contains } from \"../../core/utils/dom\";\nimport { getPublicElement } from \"../../core/element\";\nimport { each } from \"../../core/utils/iterator\";\nimport { extend } from \"../../core/utils/extend\";\nimport { hasWindow, getWindow } from \"../../core/utils/window\";\nimport fx from \"../../animation/fx\";\nimport animationPosition from \"../../animation/position\";\nimport devices from \"../../core/devices\";\nimport { addNamespace } from \"../../events/utils/index\";\nimport Overlay from \"../overlay/ui.overlay\";\nimport MenuBase from \"./ui.menu_base\";\nimport { Deferred } from \"../../core/utils/deferred\";\nimport { name as contextMenuEventName } from \"../../events/contextmenu\";\nimport holdEvent from \"../../events/hold\";\nvar DX_MENU_CLASS = \"dx-menu\";\nvar DX_MENU_ITEM_CLASS = DX_MENU_CLASS + \"-item\";\nvar DX_MENU_ITEM_EXPANDED_CLASS = DX_MENU_ITEM_CLASS + \"-expanded\";\nvar DX_MENU_PHONE_CLASS = \"dx-menu-phone-overlay\";\nvar DX_MENU_ITEMS_CONTAINER_CLASS = DX_MENU_CLASS + \"-items-container\";\nvar DX_MENU_ITEM_WRAPPER_CLASS = DX_MENU_ITEM_CLASS + \"-wrapper\";\nvar DX_SUBMENU_CLASS = \"dx-submenu\";\nvar DX_CONTEXT_MENU_CLASS = \"dx-context-menu\";\nvar DX_HAS_CONTEXT_MENU_CLASS = \"dx-has-context-menu\";\nvar DX_STATE_DISABLED_CLASS = \"dx-state-disabled\";\nvar DX_STATE_FOCUSED_CLASS = \"dx-state-focused\";\nvar DX_STATE_HOVER_CLASS = \"dx-state-hover\";\nvar OVERLAY_CONTENT_CLASS = \"dx-overlay-content\";\nvar FOCUS_UP = \"up\";\nvar FOCUS_DOWN = \"down\";\nvar FOCUS_LEFT = \"left\";\nvar FOCUS_RIGHT = \"right\";\nvar FOCUS_FIRST = \"first\";\nvar FOCUS_LAST = \"last\";\nvar ACTIONS = [\"onShowing\", \"onShown\", \"onSubmenuCreated\", \"onHiding\", \"onHidden\", \"onPositioning\", \"onLeftFirstItem\", \"onLeftLastItem\", \"onCloseRootSubmenu\", \"onExpandLastSubmenu\"];\nvar LOCAL_SUBMENU_DIRECTIONS = [FOCUS_UP, FOCUS_DOWN, FOCUS_FIRST, FOCUS_LAST];\nvar DEFAULT_SHOW_EVENT = \"dxcontextmenu\";\nvar window = getWindow();\n\nclass ContextMenu extends MenuBase {\n  getShowEvent(showEventOption) {\n    var result = null;\n\n    if (isObject(showEventOption)) {\n      if (null !== showEventOption.name) {\n        result = showEventOption.name || DEFAULT_SHOW_EVENT;\n      }\n    } else {\n      result = showEventOption;\n    }\n\n    return result;\n  }\n\n  getShowDelay(showEventOption) {\n    return isObject(showEventOption) && showEventOption.delay;\n  }\n\n  _getDefaultOptions() {\n    return extend(super._getDefaultOptions(), {\n      showEvent: DEFAULT_SHOW_EVENT,\n      hideOnOutsideClick: true,\n      position: {\n        at: \"top left\",\n        my: \"top left\"\n      },\n      onShowing: null,\n      onShown: null,\n      onSubmenuCreated: null,\n      onHiding: null,\n      onHidden: null,\n      onPositioning: null,\n      submenuDirection: \"auto\",\n      visible: false,\n      target: void 0,\n      onLeftFirstItem: null,\n      onLeftLastItem: null,\n      onCloseRootSubmenu: null,\n      onExpandLastSubmenu: null\n    });\n  }\n\n  _defaultOptionsRules() {\n    return super._defaultOptionsRules().concat([{\n      device: () => !hasWindow(),\n      options: {\n        animation: null\n      }\n    }]);\n  }\n\n  _setDeprecatedOptions() {\n    super._setDeprecatedOptions();\n\n    extend(this._deprecatedOptions, {\n      closeOnOutsideClick: {\n        since: \"22.2\",\n        alias: \"hideOnOutsideClick\"\n      }\n    });\n  }\n\n  _initActions() {\n    this._actions = {};\n    each(ACTIONS, (index, action) => {\n      this._actions[action] = this._createActionByOption(action) || noop;\n    });\n  }\n\n  _setOptionsByReference() {\n    super._setOptionsByReference();\n\n    extend(this._optionsByReference, {\n      animation: true,\n      selectedItem: true\n    });\n  }\n\n  _focusInHandler() {}\n\n  _itemContainer() {\n    return this._overlay ? this._overlay.$content() : $();\n  }\n\n  _eventBindingTarget() {\n    return this._itemContainer();\n  }\n\n  itemsContainer() {\n    return this._overlay ? this._overlay.$content() : void 0;\n  }\n\n  _supportedKeys() {\n    return extend(super._supportedKeys(), {\n      space: () => {\n        var $item = $(this.option(\"focusedElement\"));\n        this.hide();\n\n        if (!$item.length || !this._isSelectionEnabled()) {\n          return;\n        }\n\n        this.selectItem($item[0]);\n      },\n      escape: this.hide\n    });\n  }\n\n  _getActiveItem() {\n    var $availableItems = this._getAvailableItems();\n\n    var $focusedItem = $availableItems.filter(\".\".concat(DX_STATE_FOCUSED_CLASS));\n    var $hoveredItem = $availableItems.filter(\".\".concat(DX_STATE_HOVER_CLASS));\n    var $hoveredItemContainer = $hoveredItem.closest(\".\".concat(DX_MENU_ITEMS_CONTAINER_CLASS));\n\n    if ($hoveredItemContainer.find(\".\".concat(DX_MENU_ITEM_CLASS)).index($focusedItem) >= 0) {\n      return $focusedItem;\n    }\n\n    if ($hoveredItem.length) {\n      return $hoveredItem;\n    }\n\n    return super._getActiveItem();\n  }\n\n  _moveFocus(location) {\n    var $items = this._getItemsByLocation(location);\n\n    var $oldTarget = this._getActiveItem(true);\n\n    var $hoveredItem = this.itemsContainer().find(\".\".concat(DX_STATE_HOVER_CLASS));\n    var $focusedItem = $(this.option(\"focusedElement\"));\n    var $activeItemHighlighted = !!($focusedItem.length || $hoveredItem.length);\n    var $newTarget;\n\n    switch (location) {\n      case FOCUS_UP:\n        $newTarget = $activeItemHighlighted ? this._prevItem($items) : $oldTarget;\n\n        this._setFocusedElement($newTarget);\n\n        if ($oldTarget.is($items.first())) {\n          this._actions.onLeftFirstItem($oldTarget);\n        }\n\n        break;\n\n      case FOCUS_DOWN:\n        $newTarget = $activeItemHighlighted ? this._nextItem($items) : $oldTarget;\n\n        this._setFocusedElement($newTarget);\n\n        if ($oldTarget.is($items.last())) {\n          this._actions.onLeftLastItem($oldTarget);\n        }\n\n        break;\n\n      case FOCUS_RIGHT:\n        $newTarget = this.option(\"rtlEnabled\") ? this._hideSubmenuHandler() : this._expandSubmenuHandler($items, location);\n\n        this._setFocusedElement($newTarget);\n\n        break;\n\n      case FOCUS_LEFT:\n        $newTarget = this.option(\"rtlEnabled\") ? this._expandSubmenuHandler($items, location) : this._hideSubmenuHandler();\n\n        this._setFocusedElement($newTarget);\n\n        break;\n\n      case FOCUS_FIRST:\n        $newTarget = $items.first();\n\n        this._setFocusedElement($newTarget);\n\n        break;\n\n      case FOCUS_LAST:\n        $newTarget = $items.last();\n\n        this._setFocusedElement($newTarget);\n\n        break;\n\n      default:\n        return super._moveFocus(location);\n    }\n  }\n\n  _setFocusedElement($element) {\n    if ($element && 0 !== $element.length) {\n      this.option(\"focusedElement\", getPublicElement($element));\n    }\n  }\n\n  _getItemsByLocation(location) {\n    var $activeItem = this._getActiveItem(true);\n\n    var $items;\n\n    if (LOCAL_SUBMENU_DIRECTIONS.includes(location)) {\n      $items = $activeItem.closest(\".\".concat(DX_MENU_ITEMS_CONTAINER_CLASS)).children().children();\n    }\n\n    $items = this._getAvailableItems($items);\n    return $items;\n  }\n\n  _getAriaTarget() {\n    return this.$element();\n  }\n\n  _refreshActiveDescendant() {\n    if (isDefined(this._overlay)) {\n      var $target = this._overlay.$content();\n\n      super._refreshActiveDescendant($target);\n    }\n  }\n\n  _hideSubmenuHandler() {\n    var $curItem = this._getActiveItem(true);\n\n    var $parentItem = $curItem.parents(\".\".concat(DX_MENU_ITEM_EXPANDED_CLASS)).first();\n\n    if ($parentItem.length) {\n      this._hideSubmenusOnSameLevel($parentItem);\n\n      this._hideSubmenu($curItem.closest(\".\".concat(DX_SUBMENU_CLASS)));\n\n      return $parentItem;\n    }\n\n    this._actions.onCloseRootSubmenu($curItem);\n\n    return $curItem;\n  }\n\n  _expandSubmenuHandler($items, location) {\n    var $curItem = this._getActiveItem(true);\n\n    var itemData = this._getItemData($curItem);\n\n    var node = this._dataAdapter.getNodeByItem(itemData);\n\n    var isItemHasSubmenu = this._hasSubmenu(node);\n\n    var $submenu = $curItem.children(\".\".concat(DX_SUBMENU_CLASS));\n\n    if (isItemHasSubmenu && !$curItem.hasClass(DX_STATE_DISABLED_CLASS)) {\n      if (!$submenu.length || \"hidden\" === $submenu.css(\"visibility\")) {\n        this._showSubmenu($curItem);\n      }\n\n      return this._nextItem(this._getItemsByLocation(location));\n    }\n\n    this._actions.onExpandLastSubmenu($curItem);\n\n    return;\n  }\n\n  _clean() {\n    if (this._overlay) {\n      this._overlay.$element().remove();\n\n      this._overlay = null;\n    }\n\n    this._detachShowContextMenuEvents(this._getTarget());\n\n    super._clean();\n  }\n\n  _initMarkup() {\n    this.$element().addClass(DX_HAS_CONTEXT_MENU_CLASS);\n\n    super._initMarkup();\n  }\n\n  _render() {\n    super._render();\n\n    this._renderVisibility(this.option(\"visible\"));\n\n    this._addWidgetClass();\n  }\n\n  _renderContentImpl() {\n    this._detachShowContextMenuEvents(this._getTarget());\n\n    this._attachShowContextMenuEvents();\n  }\n\n  _attachKeyboardEvents() {\n    !this._keyboardListenerId && this._focusTarget().length && super._attachKeyboardEvents();\n  }\n\n  _renderContextMenuOverlay() {\n    if (this._overlay) {\n      return;\n    }\n\n    var overlayOptions = this._getOverlayOptions();\n\n    this._overlay = this._createComponent($(\"<div>\").appendTo(this._$element), Overlay, overlayOptions);\n\n    var $overlayContent = this._overlay.$content();\n\n    $overlayContent.addClass(DX_CONTEXT_MENU_CLASS);\n\n    this._addCustomCssClass($overlayContent);\n\n    this._addPlatformDependentClass($overlayContent);\n\n    this._attachContextMenuEvent();\n  }\n\n  preventShowingDefaultContextMenuAboveOverlay() {\n    var $itemContainer = this._itemContainer();\n\n    var eventName = addNamespace(contextMenuEventName, this.NAME);\n    eventsEngine.off($itemContainer, eventName, \".\".concat(DX_SUBMENU_CLASS));\n    eventsEngine.on($itemContainer, eventName, \".\".concat(DX_SUBMENU_CLASS), (e => {\n      e.stopPropagation();\n      e.preventDefault();\n      eventsEngine.off($itemContainer, eventName, \".\".concat(DX_SUBMENU_CLASS));\n    }).bind(this));\n  }\n\n  _itemContextMenuHandler(e) {\n    super._itemContextMenuHandler(e);\n\n    e.stopPropagation();\n  }\n\n  _addPlatformDependentClass($element) {\n    if (devices.current().phone) {\n      $element.addClass(DX_MENU_PHONE_CLASS);\n    }\n  }\n\n  _detachShowContextMenuEvents(target) {\n    var showEvent = this.getShowEvent(this.option(\"showEvent\"));\n\n    if (!showEvent) {\n      return;\n    }\n\n    var eventName = addNamespace(showEvent, this.NAME);\n\n    if (this._showContextMenuEventHandler) {\n      eventsEngine.off(domAdapter.getDocument(), eventName, target, this._showContextMenuEventHandler);\n    } else {\n      eventsEngine.off($(target), eventName);\n    }\n  }\n\n  _attachShowContextMenuEvents() {\n    var target = this._getTarget();\n\n    var showEvent = this.getShowEvent(this.option(\"showEvent\"));\n\n    if (!showEvent) {\n      return;\n    }\n\n    var eventName = addNamespace(showEvent, this.NAME);\n\n    var contextMenuAction = this._createAction(e => {\n      var delay = this.getShowDelay(this.option(\"showEvent\"));\n\n      if (delay) {\n        setTimeout(() => this._show(e.event), delay);\n      } else {\n        this._show(e.event);\n      }\n    }, {\n      validatingTargetName: \"target\"\n    });\n\n    var handler = e => contextMenuAction({\n      event: e,\n      target: $(e.currentTarget)\n    });\n\n    contextMenuAction = this._createAction(contextMenuAction);\n\n    if (isRenderer(target) || target.nodeType || isWindow(target)) {\n      this._showContextMenuEventHandler = void 0;\n      eventsEngine.on(target, eventName, handler);\n    } else {\n      this._showContextMenuEventHandler = handler;\n      eventsEngine.on(domAdapter.getDocument(), eventName, target, this._showContextMenuEventHandler);\n    }\n  }\n\n  _hoverEndHandler(e) {\n    super._hoverEndHandler(e);\n\n    e.stopPropagation();\n  }\n\n  _renderDimensions() {}\n\n  _renderContainer($wrapper, submenuContainer) {\n    var $holder = submenuContainer || this._itemContainer();\n\n    $wrapper = $(\"<div>\");\n    $wrapper.appendTo($holder).addClass(DX_SUBMENU_CLASS).css(\"visibility\", submenuContainer ? \"hidden\" : \"visible\");\n\n    if (!$wrapper.parent().hasClass(OVERLAY_CONTENT_CLASS)) {\n      this._addCustomCssClass($wrapper);\n    }\n\n    var $itemsContainer = super._renderContainer($wrapper);\n\n    if (submenuContainer) {\n      return $itemsContainer;\n    }\n\n    if (this.option(\"width\")) {\n      return $itemsContainer.css(\"minWidth\", this.option(\"width\"));\n    }\n\n    if (this.option(\"height\")) {\n      return $itemsContainer.css(\"minHeight\", this.option(\"height\"));\n    }\n\n    return $itemsContainer;\n  }\n\n  _renderSubmenuItems(node, $itemFrame) {\n    this._renderItems(this._getChildNodes(node), $itemFrame);\n\n    this._actions.onSubmenuCreated({\n      itemElement: getPublicElement($itemFrame),\n      itemData: node.internalFields.item,\n      submenuElement: getPublicElement($itemFrame.children(\".\".concat(DX_SUBMENU_CLASS)))\n    });\n  }\n\n  _getOverlayOptions() {\n    var position = this.option(\"position\");\n    var overlayOptions = {\n      focusStateEnabled: this.option(\"focusStateEnabled\"),\n      animation: this.option(\"animation\"),\n      innerOverlay: true,\n      hideOnOutsideClick: e => this._hideOnOutsideClickHandler(e),\n      propagateOutsideClick: true,\n      hideOnParentScroll: true,\n      deferRendering: false,\n      position: {\n        at: position.at,\n        my: position.my,\n        of: this._getTarget(),\n        collision: \"flipfit\"\n      },\n      shading: false,\n      showTitle: false,\n      height: \"auto\",\n      width: \"auto\",\n      onShown: this._overlayShownActionHandler.bind(this),\n      onHiding: this._overlayHidingActionHandler.bind(this),\n      onHidden: this._overlayHiddenActionHandler.bind(this),\n      visualContainer: window\n    };\n    return overlayOptions;\n  }\n\n  _overlayShownActionHandler(arg) {\n    this._actions.onShown(arg);\n  }\n\n  _overlayHidingActionHandler(arg) {\n    this._actions.onHiding(arg);\n\n    if (!arg.cancel) {\n      this._hideAllShownSubmenus();\n\n      this._setOptionWithoutOptionChange(\"visible\", false);\n    }\n  }\n\n  _overlayHiddenActionHandler(arg) {\n    this._actions.onHidden(arg);\n  }\n\n  _shouldHideOnOutsideClick(e) {\n    var {\n      closeOnOutsideClick: closeOnOutsideClick,\n      hideOnOutsideClick: hideOnOutsideClick\n    } = this.option();\n\n    if (isFunction(hideOnOutsideClick)) {\n      return hideOnOutsideClick(e);\n    } else if (isFunction(closeOnOutsideClick)) {\n      return closeOnOutsideClick(e);\n    } else {\n      return hideOnOutsideClick || closeOnOutsideClick;\n    }\n  }\n\n  _hideOnOutsideClickHandler(e) {\n    if (!this._shouldHideOnOutsideClick(e)) {\n      return false;\n    }\n\n    if (domAdapter.isDocument(e.target)) {\n      return true;\n    }\n\n    var $activeItemContainer = this._getActiveItemsContainer(e.target);\n\n    var $itemContainers = this._getItemsContainers();\n\n    var $clickedItem = this._searchActiveItem(e.target);\n\n    var $rootItem = this.$element().parents(\".\".concat(DX_MENU_ITEM_CLASS));\n    var isRootItemClicked = $clickedItem[0] === $rootItem[0] && $clickedItem.length && $rootItem.length;\n    var isInnerOverlayClicked = this._isIncludeOverlay($activeItemContainer, $itemContainers) && $clickedItem.length;\n\n    if (isInnerOverlayClicked || isRootItemClicked) {\n      if (\"onClick\" === this._getShowSubmenuMode()) {\n        this._hideAllShownChildSubmenus($clickedItem);\n      }\n\n      return false;\n    }\n\n    return true;\n  }\n\n  _getActiveItemsContainer(target) {\n    return $(target).closest(\".\".concat(DX_MENU_ITEMS_CONTAINER_CLASS));\n  }\n\n  _getItemsContainers() {\n    return this._overlay.$content().find(\".\".concat(DX_MENU_ITEMS_CONTAINER_CLASS));\n  }\n\n  _searchActiveItem(target) {\n    return $(target).closest(\".\".concat(DX_MENU_ITEM_CLASS)).eq(0);\n  }\n\n  _isIncludeOverlay($activeOverlay, $allOverlays) {\n    var isSame = false;\n    each($allOverlays, (index, $overlay) => {\n      if ($activeOverlay.is($overlay) && !isSame) {\n        isSame = true;\n      }\n    });\n    return isSame;\n  }\n\n  _hideAllShownChildSubmenus($clickedItem) {\n    var $submenuElements = $clickedItem.find(\".\".concat(DX_SUBMENU_CLASS));\n    var shownSubmenus = extend([], this._shownSubmenus);\n\n    if ($submenuElements.length > 0) {\n      each(shownSubmenus, (index, $submenu) => {\n        var $context = this._searchActiveItem($submenu.context).parent();\n\n        if ($context.parent().is($clickedItem.parent().parent()) && !$context.is($clickedItem.parent())) {\n          this._hideSubmenu($submenu);\n        }\n      });\n    }\n  }\n\n  _showSubmenu($item) {\n    var node = this._dataAdapter.getNodeByItem(this._getItemData($item));\n\n    this._hideSubmenusOnSameLevel($item);\n\n    if (!this._hasSubmenu(node)) {\n      return;\n    }\n\n    var $submenu = $item.children(\".\".concat(DX_SUBMENU_CLASS));\n    var isSubmenuRendered = $submenu.length;\n\n    super._showSubmenu($item);\n\n    if (!isSubmenuRendered) {\n      this._renderSubmenuItems(node, $item);\n    }\n\n    if (!this._isSubmenuVisible($submenu)) {\n      this._drawSubmenu($item);\n    }\n  }\n\n  _hideSubmenusOnSameLevel($item) {\n    var $expandedItems = $item.parent(\".\".concat(DX_MENU_ITEM_WRAPPER_CLASS)).siblings().find(\".\".concat(DX_MENU_ITEM_EXPANDED_CLASS));\n\n    if ($expandedItems.length) {\n      $expandedItems.removeClass(DX_MENU_ITEM_EXPANDED_CLASS);\n\n      this._hideSubmenu($expandedItems.find(\".\".concat(DX_SUBMENU_CLASS)));\n    }\n  }\n\n  _hideSubmenuGroup($submenu) {\n    if (this._isSubmenuVisible($submenu)) {\n      this._hideSubmenuCore($submenu);\n    }\n  }\n\n  _isSubmenuVisible($submenu) {\n    return \"visible\" === $submenu.css(\"visibility\");\n  }\n\n  _drawSubmenu($itemElement) {\n    var animation = this.option(\"animation\") ? this.option(\"animation\").show : {};\n    var $submenu = $itemElement.children(\".\".concat(DX_SUBMENU_CLASS));\n\n    var submenuPosition = this._getSubmenuPosition($itemElement);\n\n    if (this._overlay && this._overlay.option(\"visible\")) {\n      if (!isDefined(this._shownSubmenus)) {\n        this._shownSubmenus = [];\n      }\n\n      if (!this._shownSubmenus.includes($submenu)) {\n        this._shownSubmenus.push($submenu);\n      }\n\n      if (animation) {\n        fx.stop($submenu);\n      }\n\n      animationPosition.setup($submenu, submenuPosition);\n\n      if (animation) {\n        if (isPlainObject(animation.to)) {\n          animation.to.position = submenuPosition;\n        }\n\n        this._animate($submenu, animation);\n      }\n\n      $submenu.css(\"visibility\", \"visible\");\n    }\n  }\n\n  _animate($container, options) {\n    fx.animate($container, options);\n  }\n\n  _getSubmenuPosition($rootItem) {\n    var submenuDirection = this.option(\"submenuDirection\").toLowerCase();\n    var $rootItemWrapper = $rootItem.parent(\".\".concat(DX_MENU_ITEM_WRAPPER_CLASS));\n    var position = {\n      collision: \"flip\",\n      of: $rootItemWrapper,\n      offset: {\n        h: 0,\n        v: -1\n      }\n    };\n\n    switch (submenuDirection) {\n      case \"left\":\n        position.at = \"left top\";\n        position.my = \"right top\";\n        break;\n\n      case \"right\":\n        position.at = \"right top\";\n        position.my = \"left top\";\n        break;\n\n      default:\n        if (this.option(\"rtlEnabled\")) {\n          position.at = \"left top\";\n          position.my = \"right top\";\n        } else {\n          position.at = \"right top\";\n          position.my = \"left top\";\n        }\n\n    }\n\n    return position;\n  }\n\n  _updateSubmenuVisibilityOnClick(actionArgs) {\n    if (!actionArgs.args.length) {\n      return;\n    }\n\n    var itemData = actionArgs.args[0].itemData;\n\n    var node = this._dataAdapter.getNodeByItem(itemData);\n\n    if (!node) {\n      return;\n    }\n\n    var $itemElement = $(actionArgs.args[0].itemElement);\n    var $submenu = $itemElement.find(\".\".concat(DX_SUBMENU_CLASS));\n    var shouldRenderSubmenu = this._hasSubmenu(node) && !$submenu.length;\n\n    if (shouldRenderSubmenu) {\n      this._renderSubmenuItems(node, $itemElement);\n\n      $submenu = $itemElement.find(\".\".concat(DX_SUBMENU_CLASS));\n    }\n\n    if ($itemElement.context === $submenu.context && \"visible\" === $submenu.css(\"visibility\")) {\n      return;\n    }\n\n    this._updateSelectedItemOnClick(actionArgs);\n\n    var notCloseMenuOnItemClick = itemData && false === itemData.closeMenuOnClick;\n\n    if (!itemData || itemData.disabled || notCloseMenuOnItemClick) {\n      return;\n    }\n\n    if (0 === $submenu.length) {\n      var $prevSubmenu = $($itemElement.parents(\".\".concat(DX_SUBMENU_CLASS))[0]);\n\n      this._hideSubmenu($prevSubmenu);\n\n      if (!actionArgs.canceled && this._overlay && this._overlay.option(\"visible\")) {\n        this.option(\"visible\", false);\n      }\n    } else {\n      if (this._shownSubmenus && this._shownSubmenus.length > 0) {\n        if (this._shownSubmenus[0].is($submenu)) {\n          this._hideSubmenu($submenu);\n        }\n      }\n\n      this._showSubmenu($itemElement);\n    }\n  }\n\n  _hideSubmenu($curSubmenu) {\n    var shownSubmenus = extend([], this._shownSubmenus);\n    each(shownSubmenus, (index, $submenu) => {\n      if ($curSubmenu.is($submenu) || contains($curSubmenu[0], $submenu[0])) {\n        $submenu.parent().removeClass(DX_MENU_ITEM_EXPANDED_CLASS);\n\n        this._hideSubmenuCore($submenu);\n      }\n    });\n  }\n\n  _hideSubmenuCore($submenu) {\n    var index = this._shownSubmenus.indexOf($submenu);\n\n    var animation = this.option(\"animation\") ? this.option(\"animation\").hide : null;\n\n    if (index >= 0) {\n      this._shownSubmenus.splice(index, 1);\n    }\n\n    this._stopAnimate($submenu);\n\n    animation && this._animate($submenu, animation);\n    $submenu.css(\"visibility\", \"hidden\");\n  }\n\n  _stopAnimate($container) {\n    fx.stop($container, true);\n  }\n\n  _hideAllShownSubmenus() {\n    var shownSubmenus = extend([], this._shownSubmenus);\n\n    var $expandedItems = this._overlay.$content().find(\".\".concat(DX_MENU_ITEM_EXPANDED_CLASS));\n\n    $expandedItems.removeClass(DX_MENU_ITEM_EXPANDED_CLASS);\n    each(shownSubmenus, (_, $submenu) => {\n      this._hideSubmenu($submenu);\n    });\n  }\n\n  _visibilityChanged(visible) {\n    if (visible) {\n      this._renderContentImpl();\n    }\n  }\n\n  _optionChanged(args) {\n    if (ACTIONS.includes(args.name)) {\n      this._initActions();\n\n      return;\n    }\n\n    switch (args.name) {\n      case \"visible\":\n        this._renderVisibility(args.value);\n\n        break;\n\n      case \"showEvent\":\n      case \"position\":\n      case \"submenuDirection\":\n        this._invalidate();\n\n        break;\n\n      case \"target\":\n        args.previousValue && this._detachShowContextMenuEvents(args.previousValue);\n\n        this._invalidate();\n\n        break;\n\n      case \"closeOnOutsideClick\":\n      case \"hideOnOutsideClick\":\n        break;\n\n      default:\n        super._optionChanged(args);\n\n    }\n  }\n\n  _renderVisibility(showing) {\n    return showing ? this._show() : this._hide();\n  }\n\n  _toggleVisibility() {}\n\n  _show(event) {\n    var args = {\n      jQEvent: event\n    };\n    var promise = new Deferred().reject().promise();\n\n    this._actions.onShowing(args);\n\n    if (args.cancel) {\n      return promise;\n    }\n\n    var position = this._positionContextMenu(event);\n\n    if (position) {\n      var _event$originalEvent;\n\n      if (!this._overlay) {\n        this._renderContextMenuOverlay();\n\n        this._overlay.$content().addClass(this._widgetClass());\n\n        this._renderFocusState();\n\n        this._attachHoverEvents();\n\n        this._attachClickEvent();\n\n        this._renderItems(this._dataAdapter.getRootNodes());\n      }\n\n      this._setOptionWithoutOptionChange(\"visible\", true);\n\n      this._overlay.option(\"position\", position);\n\n      promise = this._overlay.show();\n      event && event.stopPropagation();\n\n      this._setAriaAttributes();\n\n      if ((null === event || void 0 === event ? void 0 : null === (_event$originalEvent = event.originalEvent) || void 0 === _event$originalEvent ? void 0 : _event$originalEvent.type) === holdEvent.name) {\n        this.preventShowingDefaultContextMenuAboveOverlay();\n      }\n    }\n\n    return promise;\n  }\n\n  _setAriaAttributes() {\n    this._overlayContentId = \"dx-\".concat(new Guid());\n    this.setAria(\"owns\", this._overlayContentId);\n    this.setAria({\n      id: this._overlayContentId,\n      role: \"menu\"\n    }, this._overlay.$content());\n  }\n\n  _cleanAriaAttributes() {\n    this._overlay && this.setAria(\"id\", null, this._overlay.$content());\n    this.setAria(\"owns\", void 0);\n  }\n\n  _getTarget() {\n    return this.option(\"target\") || this.option(\"position\").of || $(domAdapter.getDocument());\n  }\n\n  _getContextMenuPosition() {\n    return extend({}, this.option(\"position\"), {\n      of: this._getTarget()\n    });\n  }\n\n  _positionContextMenu(jQEvent) {\n    var position = this._getContextMenuPosition();\n\n    var isInitialPosition = this._isInitialOptionValue(\"position\");\n\n    var positioningAction = this._createActionByOption(\"onPositioning\", actionArgs);\n\n    if (jQEvent && jQEvent.preventDefault && isInitialPosition) {\n      position.of = jQEvent;\n    }\n\n    var actionArgs = {\n      position: position,\n      event: jQEvent\n    };\n    positioningAction(actionArgs);\n\n    if (actionArgs.cancel) {\n      position = null;\n    } else if (actionArgs.event) {\n      actionArgs.event.cancel = true;\n      jQEvent.preventDefault();\n    }\n\n    return position;\n  }\n\n  _refresh() {\n    if (!hasWindow()) {\n      super._refresh();\n    } else if (this._overlay) {\n      var lastPosition = this._overlay.option(\"position\");\n\n      super._refresh();\n\n      this._overlay && this._overlay.option(\"position\", lastPosition);\n    } else {\n      super._refresh();\n    }\n  }\n\n  _hide() {\n    var promise;\n\n    if (this._overlay) {\n      promise = this._overlay.hide();\n\n      this._setOptionWithoutOptionChange(\"visible\", false);\n    }\n\n    this._cleanAriaAttributes();\n\n    this.option(\"focusedElement\", null);\n    return promise || new Deferred().reject().promise();\n  }\n\n  toggle(showing) {\n    var visible = this.option(\"visible\");\n    showing = void 0 === showing ? !visible : showing;\n    return this._renderVisibility(showing);\n  }\n\n  show() {\n    return this.toggle(true);\n  }\n\n  hide() {\n    return this.toggle(false);\n  }\n\n}\n\nregisterComponent(\"dxContextMenu\", ContextMenu);\nexport default ContextMenu;","map":{"version":3,"sources":["C:/Users/Zoran/source/repos/TransportApp/TransportLog-basic/node_modules/devextreme/esm/ui/context_menu/ui.context_menu.js"],"names":["$","domAdapter","eventsEngine","Guid","registerComponent","noop","isObject","isRenderer","isWindow","isFunction","isPlainObject","isDefined","contains","getPublicElement","each","extend","hasWindow","getWindow","fx","animationPosition","devices","addNamespace","Overlay","MenuBase","Deferred","name","contextMenuEventName","holdEvent","DX_MENU_CLASS","DX_MENU_ITEM_CLASS","DX_MENU_ITEM_EXPANDED_CLASS","DX_MENU_PHONE_CLASS","DX_MENU_ITEMS_CONTAINER_CLASS","DX_MENU_ITEM_WRAPPER_CLASS","DX_SUBMENU_CLASS","DX_CONTEXT_MENU_CLASS","DX_HAS_CONTEXT_MENU_CLASS","DX_STATE_DISABLED_CLASS","DX_STATE_FOCUSED_CLASS","DX_STATE_HOVER_CLASS","OVERLAY_CONTENT_CLASS","FOCUS_UP","FOCUS_DOWN","FOCUS_LEFT","FOCUS_RIGHT","FOCUS_FIRST","FOCUS_LAST","ACTIONS","LOCAL_SUBMENU_DIRECTIONS","DEFAULT_SHOW_EVENT","window","ContextMenu","getShowEvent","showEventOption","result","getShowDelay","delay","_getDefaultOptions","showEvent","hideOnOutsideClick","position","at","my","onShowing","onShown","onSubmenuCreated","onHiding","onHidden","onPositioning","submenuDirection","visible","target","onLeftFirstItem","onLeftLastItem","onCloseRootSubmenu","onExpandLastSubmenu","_defaultOptionsRules","concat","device","options","animation","_setDeprecatedOptions","_deprecatedOptions","closeOnOutsideClick","since","alias","_initActions","_actions","index","action","_createActionByOption","_setOptionsByReference","_optionsByReference","selectedItem","_focusInHandler","_itemContainer","_overlay","$content","_eventBindingTarget","itemsContainer","_supportedKeys","space","$item","option","hide","length","_isSelectionEnabled","selectItem","escape","_getActiveItem","$availableItems","_getAvailableItems","$focusedItem","filter","$hoveredItem","$hoveredItemContainer","closest","find","_moveFocus","location","$items","_getItemsByLocation","$oldTarget","$activeItemHighlighted","$newTarget","_prevItem","_setFocusedElement","is","first","_nextItem","last","_hideSubmenuHandler","_expandSubmenuHandler","$element","$activeItem","includes","children","_getAriaTarget","_refreshActiveDescendant","$target","$curItem","$parentItem","parents","_hideSubmenusOnSameLevel","_hideSubmenu","itemData","_getItemData","node","_dataAdapter","getNodeByItem","isItemHasSubmenu","_hasSubmenu","$submenu","hasClass","css","_showSubmenu","_clean","remove","_detachShowContextMenuEvents","_getTarget","_initMarkup","addClass","_render","_renderVisibility","_addWidgetClass","_renderContentImpl","_attachShowContextMenuEvents","_attachKeyboardEvents","_keyboardListenerId","_focusTarget","_renderContextMenuOverlay","overlayOptions","_getOverlayOptions","_createComponent","appendTo","_$element","$overlayContent","_addCustomCssClass","_addPlatformDependentClass","_attachContextMenuEvent","preventShowingDefaultContextMenuAboveOverlay","$itemContainer","eventName","NAME","off","on","e","stopPropagation","preventDefault","bind","_itemContextMenuHandler","current","phone","_showContextMenuEventHandler","getDocument","contextMenuAction","_createAction","setTimeout","_show","event","validatingTargetName","handler","currentTarget","nodeType","_hoverEndHandler","_renderDimensions","_renderContainer","$wrapper","submenuContainer","$holder","parent","$itemsContainer","_renderSubmenuItems","$itemFrame","_renderItems","_getChildNodes","itemElement","internalFields","item","submenuElement","focusStateEnabled","innerOverlay","_hideOnOutsideClickHandler","propagateOutsideClick","hideOnParentScroll","deferRendering","of","collision","shading","showTitle","height","width","_overlayShownActionHandler","_overlayHidingActionHandler","_overlayHiddenActionHandler","visualContainer","arg","cancel","_hideAllShownSubmenus","_setOptionWithoutOptionChange","_shouldHideOnOutsideClick","isDocument","$activeItemContainer","_getActiveItemsContainer","$itemContainers","_getItemsContainers","$clickedItem","_searchActiveItem","$rootItem","isRootItemClicked","isInnerOverlayClicked","_isIncludeOverlay","_getShowSubmenuMode","_hideAllShownChildSubmenus","eq","$activeOverlay","$allOverlays","isSame","$overlay","$submenuElements","shownSubmenus","_shownSubmenus","$context","context","isSubmenuRendered","_isSubmenuVisible","_drawSubmenu","$expandedItems","siblings","removeClass","_hideSubmenuGroup","_hideSubmenuCore","$itemElement","show","submenuPosition","_getSubmenuPosition","push","stop","setup","to","_animate","$container","animate","toLowerCase","$rootItemWrapper","offset","h","v","_updateSubmenuVisibilityOnClick","actionArgs","args","shouldRenderSubmenu","_updateSelectedItemOnClick","notCloseMenuOnItemClick","closeMenuOnClick","disabled","$prevSubmenu","canceled","$curSubmenu","indexOf","splice","_stopAnimate","_","_visibilityChanged","_optionChanged","value","_invalidate","previousValue","showing","_hide","_toggleVisibility","jQEvent","promise","reject","_positionContextMenu","_event$originalEvent","_widgetClass","_renderFocusState","_attachHoverEvents","_attachClickEvent","getRootNodes","_setAriaAttributes","originalEvent","type","_overlayContentId","setAria","id","role","_cleanAriaAttributes","_getContextMenuPosition","isInitialPosition","_isInitialOptionValue","positioningAction","_refresh","lastPosition","toggle"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (esm/ui/context_menu/ui.context_menu.js)\r\n * Version: 22.1.6\r\n * Build date: Tue Oct 18 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport $ from \"../../core/renderer\";\r\nimport domAdapter from \"../../core/dom_adapter\";\r\nimport eventsEngine from \"../../events/core/events_engine\";\r\nimport Guid from \"../../core/guid\";\r\nimport registerComponent from \"../../core/component_registrator\";\r\nimport {\r\n    noop\r\n} from \"../../core/utils/common\";\r\nimport {\r\n    isObject,\r\n    isRenderer,\r\n    isWindow,\r\n    isFunction,\r\n    isPlainObject,\r\n    isDefined\r\n} from \"../../core/utils/type\";\r\nimport {\r\n    contains\r\n} from \"../../core/utils/dom\";\r\nimport {\r\n    getPublicElement\r\n} from \"../../core/element\";\r\nimport {\r\n    each\r\n} from \"../../core/utils/iterator\";\r\nimport {\r\n    extend\r\n} from \"../../core/utils/extend\";\r\nimport {\r\n    hasWindow,\r\n    getWindow\r\n} from \"../../core/utils/window\";\r\nimport fx from \"../../animation/fx\";\r\nimport animationPosition from \"../../animation/position\";\r\nimport devices from \"../../core/devices\";\r\nimport {\r\n    addNamespace\r\n} from \"../../events/utils/index\";\r\nimport Overlay from \"../overlay/ui.overlay\";\r\nimport MenuBase from \"./ui.menu_base\";\r\nimport {\r\n    Deferred\r\n} from \"../../core/utils/deferred\";\r\nimport {\r\n    name as contextMenuEventName\r\n} from \"../../events/contextmenu\";\r\nimport holdEvent from \"../../events/hold\";\r\nvar DX_MENU_CLASS = \"dx-menu\";\r\nvar DX_MENU_ITEM_CLASS = DX_MENU_CLASS + \"-item\";\r\nvar DX_MENU_ITEM_EXPANDED_CLASS = DX_MENU_ITEM_CLASS + \"-expanded\";\r\nvar DX_MENU_PHONE_CLASS = \"dx-menu-phone-overlay\";\r\nvar DX_MENU_ITEMS_CONTAINER_CLASS = DX_MENU_CLASS + \"-items-container\";\r\nvar DX_MENU_ITEM_WRAPPER_CLASS = DX_MENU_ITEM_CLASS + \"-wrapper\";\r\nvar DX_SUBMENU_CLASS = \"dx-submenu\";\r\nvar DX_CONTEXT_MENU_CLASS = \"dx-context-menu\";\r\nvar DX_HAS_CONTEXT_MENU_CLASS = \"dx-has-context-menu\";\r\nvar DX_STATE_DISABLED_CLASS = \"dx-state-disabled\";\r\nvar DX_STATE_FOCUSED_CLASS = \"dx-state-focused\";\r\nvar DX_STATE_HOVER_CLASS = \"dx-state-hover\";\r\nvar OVERLAY_CONTENT_CLASS = \"dx-overlay-content\";\r\nvar FOCUS_UP = \"up\";\r\nvar FOCUS_DOWN = \"down\";\r\nvar FOCUS_LEFT = \"left\";\r\nvar FOCUS_RIGHT = \"right\";\r\nvar FOCUS_FIRST = \"first\";\r\nvar FOCUS_LAST = \"last\";\r\nvar ACTIONS = [\"onShowing\", \"onShown\", \"onSubmenuCreated\", \"onHiding\", \"onHidden\", \"onPositioning\", \"onLeftFirstItem\", \"onLeftLastItem\", \"onCloseRootSubmenu\", \"onExpandLastSubmenu\"];\r\nvar LOCAL_SUBMENU_DIRECTIONS = [FOCUS_UP, FOCUS_DOWN, FOCUS_FIRST, FOCUS_LAST];\r\nvar DEFAULT_SHOW_EVENT = \"dxcontextmenu\";\r\nvar window = getWindow();\r\nclass ContextMenu extends MenuBase {\r\n    getShowEvent(showEventOption) {\r\n        var result = null;\r\n        if (isObject(showEventOption)) {\r\n            if (null !== showEventOption.name) {\r\n                result = showEventOption.name || DEFAULT_SHOW_EVENT\r\n            }\r\n        } else {\r\n            result = showEventOption\r\n        }\r\n        return result\r\n    }\r\n    getShowDelay(showEventOption) {\r\n        return isObject(showEventOption) && showEventOption.delay\r\n    }\r\n    _getDefaultOptions() {\r\n        return extend(super._getDefaultOptions(), {\r\n            showEvent: DEFAULT_SHOW_EVENT,\r\n            hideOnOutsideClick: true,\r\n            position: {\r\n                at: \"top left\",\r\n                my: \"top left\"\r\n            },\r\n            onShowing: null,\r\n            onShown: null,\r\n            onSubmenuCreated: null,\r\n            onHiding: null,\r\n            onHidden: null,\r\n            onPositioning: null,\r\n            submenuDirection: \"auto\",\r\n            visible: false,\r\n            target: void 0,\r\n            onLeftFirstItem: null,\r\n            onLeftLastItem: null,\r\n            onCloseRootSubmenu: null,\r\n            onExpandLastSubmenu: null\r\n        })\r\n    }\r\n    _defaultOptionsRules() {\r\n        return super._defaultOptionsRules().concat([{\r\n            device: () => !hasWindow(),\r\n            options: {\r\n                animation: null\r\n            }\r\n        }])\r\n    }\r\n    _setDeprecatedOptions() {\r\n        super._setDeprecatedOptions();\r\n        extend(this._deprecatedOptions, {\r\n            closeOnOutsideClick: {\r\n                since: \"22.2\",\r\n                alias: \"hideOnOutsideClick\"\r\n            }\r\n        })\r\n    }\r\n    _initActions() {\r\n        this._actions = {};\r\n        each(ACTIONS, (index, action) => {\r\n            this._actions[action] = this._createActionByOption(action) || noop\r\n        })\r\n    }\r\n    _setOptionsByReference() {\r\n        super._setOptionsByReference();\r\n        extend(this._optionsByReference, {\r\n            animation: true,\r\n            selectedItem: true\r\n        })\r\n    }\r\n    _focusInHandler() {}\r\n    _itemContainer() {\r\n        return this._overlay ? this._overlay.$content() : $()\r\n    }\r\n    _eventBindingTarget() {\r\n        return this._itemContainer()\r\n    }\r\n    itemsContainer() {\r\n        return this._overlay ? this._overlay.$content() : void 0\r\n    }\r\n    _supportedKeys() {\r\n        return extend(super._supportedKeys(), {\r\n            space: () => {\r\n                var $item = $(this.option(\"focusedElement\"));\r\n                this.hide();\r\n                if (!$item.length || !this._isSelectionEnabled()) {\r\n                    return\r\n                }\r\n                this.selectItem($item[0])\r\n            },\r\n            escape: this.hide\r\n        })\r\n    }\r\n    _getActiveItem() {\r\n        var $availableItems = this._getAvailableItems();\r\n        var $focusedItem = $availableItems.filter(\".\".concat(DX_STATE_FOCUSED_CLASS));\r\n        var $hoveredItem = $availableItems.filter(\".\".concat(DX_STATE_HOVER_CLASS));\r\n        var $hoveredItemContainer = $hoveredItem.closest(\".\".concat(DX_MENU_ITEMS_CONTAINER_CLASS));\r\n        if ($hoveredItemContainer.find(\".\".concat(DX_MENU_ITEM_CLASS)).index($focusedItem) >= 0) {\r\n            return $focusedItem\r\n        }\r\n        if ($hoveredItem.length) {\r\n            return $hoveredItem\r\n        }\r\n        return super._getActiveItem()\r\n    }\r\n    _moveFocus(location) {\r\n        var $items = this._getItemsByLocation(location);\r\n        var $oldTarget = this._getActiveItem(true);\r\n        var $hoveredItem = this.itemsContainer().find(\".\".concat(DX_STATE_HOVER_CLASS));\r\n        var $focusedItem = $(this.option(\"focusedElement\"));\r\n        var $activeItemHighlighted = !!($focusedItem.length || $hoveredItem.length);\r\n        var $newTarget;\r\n        switch (location) {\r\n            case FOCUS_UP:\r\n                $newTarget = $activeItemHighlighted ? this._prevItem($items) : $oldTarget;\r\n                this._setFocusedElement($newTarget);\r\n                if ($oldTarget.is($items.first())) {\r\n                    this._actions.onLeftFirstItem($oldTarget)\r\n                }\r\n                break;\r\n            case FOCUS_DOWN:\r\n                $newTarget = $activeItemHighlighted ? this._nextItem($items) : $oldTarget;\r\n                this._setFocusedElement($newTarget);\r\n                if ($oldTarget.is($items.last())) {\r\n                    this._actions.onLeftLastItem($oldTarget)\r\n                }\r\n                break;\r\n            case FOCUS_RIGHT:\r\n                $newTarget = this.option(\"rtlEnabled\") ? this._hideSubmenuHandler() : this._expandSubmenuHandler($items, location);\r\n                this._setFocusedElement($newTarget);\r\n                break;\r\n            case FOCUS_LEFT:\r\n                $newTarget = this.option(\"rtlEnabled\") ? this._expandSubmenuHandler($items, location) : this._hideSubmenuHandler();\r\n                this._setFocusedElement($newTarget);\r\n                break;\r\n            case FOCUS_FIRST:\r\n                $newTarget = $items.first();\r\n                this._setFocusedElement($newTarget);\r\n                break;\r\n            case FOCUS_LAST:\r\n                $newTarget = $items.last();\r\n                this._setFocusedElement($newTarget);\r\n                break;\r\n            default:\r\n                return super._moveFocus(location)\r\n        }\r\n    }\r\n    _setFocusedElement($element) {\r\n        if ($element && 0 !== $element.length) {\r\n            this.option(\"focusedElement\", getPublicElement($element))\r\n        }\r\n    }\r\n    _getItemsByLocation(location) {\r\n        var $activeItem = this._getActiveItem(true);\r\n        var $items;\r\n        if (LOCAL_SUBMENU_DIRECTIONS.includes(location)) {\r\n            $items = $activeItem.closest(\".\".concat(DX_MENU_ITEMS_CONTAINER_CLASS)).children().children()\r\n        }\r\n        $items = this._getAvailableItems($items);\r\n        return $items\r\n    }\r\n    _getAriaTarget() {\r\n        return this.$element()\r\n    }\r\n    _refreshActiveDescendant() {\r\n        if (isDefined(this._overlay)) {\r\n            var $target = this._overlay.$content();\r\n            super._refreshActiveDescendant($target)\r\n        }\r\n    }\r\n    _hideSubmenuHandler() {\r\n        var $curItem = this._getActiveItem(true);\r\n        var $parentItem = $curItem.parents(\".\".concat(DX_MENU_ITEM_EXPANDED_CLASS)).first();\r\n        if ($parentItem.length) {\r\n            this._hideSubmenusOnSameLevel($parentItem);\r\n            this._hideSubmenu($curItem.closest(\".\".concat(DX_SUBMENU_CLASS)));\r\n            return $parentItem\r\n        }\r\n        this._actions.onCloseRootSubmenu($curItem);\r\n        return $curItem\r\n    }\r\n    _expandSubmenuHandler($items, location) {\r\n        var $curItem = this._getActiveItem(true);\r\n        var itemData = this._getItemData($curItem);\r\n        var node = this._dataAdapter.getNodeByItem(itemData);\r\n        var isItemHasSubmenu = this._hasSubmenu(node);\r\n        var $submenu = $curItem.children(\".\".concat(DX_SUBMENU_CLASS));\r\n        if (isItemHasSubmenu && !$curItem.hasClass(DX_STATE_DISABLED_CLASS)) {\r\n            if (!$submenu.length || \"hidden\" === $submenu.css(\"visibility\")) {\r\n                this._showSubmenu($curItem)\r\n            }\r\n            return this._nextItem(this._getItemsByLocation(location))\r\n        }\r\n        this._actions.onExpandLastSubmenu($curItem);\r\n        return\r\n    }\r\n    _clean() {\r\n        if (this._overlay) {\r\n            this._overlay.$element().remove();\r\n            this._overlay = null\r\n        }\r\n        this._detachShowContextMenuEvents(this._getTarget());\r\n        super._clean()\r\n    }\r\n    _initMarkup() {\r\n        this.$element().addClass(DX_HAS_CONTEXT_MENU_CLASS);\r\n        super._initMarkup()\r\n    }\r\n    _render() {\r\n        super._render();\r\n        this._renderVisibility(this.option(\"visible\"));\r\n        this._addWidgetClass()\r\n    }\r\n    _renderContentImpl() {\r\n        this._detachShowContextMenuEvents(this._getTarget());\r\n        this._attachShowContextMenuEvents()\r\n    }\r\n    _attachKeyboardEvents() {\r\n        !this._keyboardListenerId && this._focusTarget().length && super._attachKeyboardEvents()\r\n    }\r\n    _renderContextMenuOverlay() {\r\n        if (this._overlay) {\r\n            return\r\n        }\r\n        var overlayOptions = this._getOverlayOptions();\r\n        this._overlay = this._createComponent($(\"<div>\").appendTo(this._$element), Overlay, overlayOptions);\r\n        var $overlayContent = this._overlay.$content();\r\n        $overlayContent.addClass(DX_CONTEXT_MENU_CLASS);\r\n        this._addCustomCssClass($overlayContent);\r\n        this._addPlatformDependentClass($overlayContent);\r\n        this._attachContextMenuEvent()\r\n    }\r\n    preventShowingDefaultContextMenuAboveOverlay() {\r\n        var $itemContainer = this._itemContainer();\r\n        var eventName = addNamespace(contextMenuEventName, this.NAME);\r\n        eventsEngine.off($itemContainer, eventName, \".\".concat(DX_SUBMENU_CLASS));\r\n        eventsEngine.on($itemContainer, eventName, \".\".concat(DX_SUBMENU_CLASS), (e => {\r\n            e.stopPropagation();\r\n            e.preventDefault();\r\n            eventsEngine.off($itemContainer, eventName, \".\".concat(DX_SUBMENU_CLASS))\r\n        }).bind(this))\r\n    }\r\n    _itemContextMenuHandler(e) {\r\n        super._itemContextMenuHandler(e);\r\n        e.stopPropagation()\r\n    }\r\n    _addPlatformDependentClass($element) {\r\n        if (devices.current().phone) {\r\n            $element.addClass(DX_MENU_PHONE_CLASS)\r\n        }\r\n    }\r\n    _detachShowContextMenuEvents(target) {\r\n        var showEvent = this.getShowEvent(this.option(\"showEvent\"));\r\n        if (!showEvent) {\r\n            return\r\n        }\r\n        var eventName = addNamespace(showEvent, this.NAME);\r\n        if (this._showContextMenuEventHandler) {\r\n            eventsEngine.off(domAdapter.getDocument(), eventName, target, this._showContextMenuEventHandler)\r\n        } else {\r\n            eventsEngine.off($(target), eventName)\r\n        }\r\n    }\r\n    _attachShowContextMenuEvents() {\r\n        var target = this._getTarget();\r\n        var showEvent = this.getShowEvent(this.option(\"showEvent\"));\r\n        if (!showEvent) {\r\n            return\r\n        }\r\n        var eventName = addNamespace(showEvent, this.NAME);\r\n        var contextMenuAction = this._createAction(e => {\r\n            var delay = this.getShowDelay(this.option(\"showEvent\"));\r\n            if (delay) {\r\n                setTimeout(() => this._show(e.event), delay)\r\n            } else {\r\n                this._show(e.event)\r\n            }\r\n        }, {\r\n            validatingTargetName: \"target\"\r\n        });\r\n        var handler = e => contextMenuAction({\r\n            event: e,\r\n            target: $(e.currentTarget)\r\n        });\r\n        contextMenuAction = this._createAction(contextMenuAction);\r\n        if (isRenderer(target) || target.nodeType || isWindow(target)) {\r\n            this._showContextMenuEventHandler = void 0;\r\n            eventsEngine.on(target, eventName, handler)\r\n        } else {\r\n            this._showContextMenuEventHandler = handler;\r\n            eventsEngine.on(domAdapter.getDocument(), eventName, target, this._showContextMenuEventHandler)\r\n        }\r\n    }\r\n    _hoverEndHandler(e) {\r\n        super._hoverEndHandler(e);\r\n        e.stopPropagation()\r\n    }\r\n    _renderDimensions() {}\r\n    _renderContainer($wrapper, submenuContainer) {\r\n        var $holder = submenuContainer || this._itemContainer();\r\n        $wrapper = $(\"<div>\");\r\n        $wrapper.appendTo($holder).addClass(DX_SUBMENU_CLASS).css(\"visibility\", submenuContainer ? \"hidden\" : \"visible\");\r\n        if (!$wrapper.parent().hasClass(OVERLAY_CONTENT_CLASS)) {\r\n            this._addCustomCssClass($wrapper)\r\n        }\r\n        var $itemsContainer = super._renderContainer($wrapper);\r\n        if (submenuContainer) {\r\n            return $itemsContainer\r\n        }\r\n        if (this.option(\"width\")) {\r\n            return $itemsContainer.css(\"minWidth\", this.option(\"width\"))\r\n        }\r\n        if (this.option(\"height\")) {\r\n            return $itemsContainer.css(\"minHeight\", this.option(\"height\"))\r\n        }\r\n        return $itemsContainer\r\n    }\r\n    _renderSubmenuItems(node, $itemFrame) {\r\n        this._renderItems(this._getChildNodes(node), $itemFrame);\r\n        this._actions.onSubmenuCreated({\r\n            itemElement: getPublicElement($itemFrame),\r\n            itemData: node.internalFields.item,\r\n            submenuElement: getPublicElement($itemFrame.children(\".\".concat(DX_SUBMENU_CLASS)))\r\n        })\r\n    }\r\n    _getOverlayOptions() {\r\n        var position = this.option(\"position\");\r\n        var overlayOptions = {\r\n            focusStateEnabled: this.option(\"focusStateEnabled\"),\r\n            animation: this.option(\"animation\"),\r\n            innerOverlay: true,\r\n            hideOnOutsideClick: e => this._hideOnOutsideClickHandler(e),\r\n            propagateOutsideClick: true,\r\n            hideOnParentScroll: true,\r\n            deferRendering: false,\r\n            position: {\r\n                at: position.at,\r\n                my: position.my,\r\n                of: this._getTarget(),\r\n                collision: \"flipfit\"\r\n            },\r\n            shading: false,\r\n            showTitle: false,\r\n            height: \"auto\",\r\n            width: \"auto\",\r\n            onShown: this._overlayShownActionHandler.bind(this),\r\n            onHiding: this._overlayHidingActionHandler.bind(this),\r\n            onHidden: this._overlayHiddenActionHandler.bind(this),\r\n            visualContainer: window\r\n        };\r\n        return overlayOptions\r\n    }\r\n    _overlayShownActionHandler(arg) {\r\n        this._actions.onShown(arg)\r\n    }\r\n    _overlayHidingActionHandler(arg) {\r\n        this._actions.onHiding(arg);\r\n        if (!arg.cancel) {\r\n            this._hideAllShownSubmenus();\r\n            this._setOptionWithoutOptionChange(\"visible\", false)\r\n        }\r\n    }\r\n    _overlayHiddenActionHandler(arg) {\r\n        this._actions.onHidden(arg)\r\n    }\r\n    _shouldHideOnOutsideClick(e) {\r\n        var {\r\n            closeOnOutsideClick: closeOnOutsideClick,\r\n            hideOnOutsideClick: hideOnOutsideClick\r\n        } = this.option();\r\n        if (isFunction(hideOnOutsideClick)) {\r\n            return hideOnOutsideClick(e)\r\n        } else if (isFunction(closeOnOutsideClick)) {\r\n            return closeOnOutsideClick(e)\r\n        } else {\r\n            return hideOnOutsideClick || closeOnOutsideClick\r\n        }\r\n    }\r\n    _hideOnOutsideClickHandler(e) {\r\n        if (!this._shouldHideOnOutsideClick(e)) {\r\n            return false\r\n        }\r\n        if (domAdapter.isDocument(e.target)) {\r\n            return true\r\n        }\r\n        var $activeItemContainer = this._getActiveItemsContainer(e.target);\r\n        var $itemContainers = this._getItemsContainers();\r\n        var $clickedItem = this._searchActiveItem(e.target);\r\n        var $rootItem = this.$element().parents(\".\".concat(DX_MENU_ITEM_CLASS));\r\n        var isRootItemClicked = $clickedItem[0] === $rootItem[0] && $clickedItem.length && $rootItem.length;\r\n        var isInnerOverlayClicked = this._isIncludeOverlay($activeItemContainer, $itemContainers) && $clickedItem.length;\r\n        if (isInnerOverlayClicked || isRootItemClicked) {\r\n            if (\"onClick\" === this._getShowSubmenuMode()) {\r\n                this._hideAllShownChildSubmenus($clickedItem)\r\n            }\r\n            return false\r\n        }\r\n        return true\r\n    }\r\n    _getActiveItemsContainer(target) {\r\n        return $(target).closest(\".\".concat(DX_MENU_ITEMS_CONTAINER_CLASS))\r\n    }\r\n    _getItemsContainers() {\r\n        return this._overlay.$content().find(\".\".concat(DX_MENU_ITEMS_CONTAINER_CLASS))\r\n    }\r\n    _searchActiveItem(target) {\r\n        return $(target).closest(\".\".concat(DX_MENU_ITEM_CLASS)).eq(0)\r\n    }\r\n    _isIncludeOverlay($activeOverlay, $allOverlays) {\r\n        var isSame = false;\r\n        each($allOverlays, (index, $overlay) => {\r\n            if ($activeOverlay.is($overlay) && !isSame) {\r\n                isSame = true\r\n            }\r\n        });\r\n        return isSame\r\n    }\r\n    _hideAllShownChildSubmenus($clickedItem) {\r\n        var $submenuElements = $clickedItem.find(\".\".concat(DX_SUBMENU_CLASS));\r\n        var shownSubmenus = extend([], this._shownSubmenus);\r\n        if ($submenuElements.length > 0) {\r\n            each(shownSubmenus, (index, $submenu) => {\r\n                var $context = this._searchActiveItem($submenu.context).parent();\r\n                if ($context.parent().is($clickedItem.parent().parent()) && !$context.is($clickedItem.parent())) {\r\n                    this._hideSubmenu($submenu)\r\n                }\r\n            })\r\n        }\r\n    }\r\n    _showSubmenu($item) {\r\n        var node = this._dataAdapter.getNodeByItem(this._getItemData($item));\r\n        this._hideSubmenusOnSameLevel($item);\r\n        if (!this._hasSubmenu(node)) {\r\n            return\r\n        }\r\n        var $submenu = $item.children(\".\".concat(DX_SUBMENU_CLASS));\r\n        var isSubmenuRendered = $submenu.length;\r\n        super._showSubmenu($item);\r\n        if (!isSubmenuRendered) {\r\n            this._renderSubmenuItems(node, $item)\r\n        }\r\n        if (!this._isSubmenuVisible($submenu)) {\r\n            this._drawSubmenu($item)\r\n        }\r\n    }\r\n    _hideSubmenusOnSameLevel($item) {\r\n        var $expandedItems = $item.parent(\".\".concat(DX_MENU_ITEM_WRAPPER_CLASS)).siblings().find(\".\".concat(DX_MENU_ITEM_EXPANDED_CLASS));\r\n        if ($expandedItems.length) {\r\n            $expandedItems.removeClass(DX_MENU_ITEM_EXPANDED_CLASS);\r\n            this._hideSubmenu($expandedItems.find(\".\".concat(DX_SUBMENU_CLASS)))\r\n        }\r\n    }\r\n    _hideSubmenuGroup($submenu) {\r\n        if (this._isSubmenuVisible($submenu)) {\r\n            this._hideSubmenuCore($submenu)\r\n        }\r\n    }\r\n    _isSubmenuVisible($submenu) {\r\n        return \"visible\" === $submenu.css(\"visibility\")\r\n    }\r\n    _drawSubmenu($itemElement) {\r\n        var animation = this.option(\"animation\") ? this.option(\"animation\").show : {};\r\n        var $submenu = $itemElement.children(\".\".concat(DX_SUBMENU_CLASS));\r\n        var submenuPosition = this._getSubmenuPosition($itemElement);\r\n        if (this._overlay && this._overlay.option(\"visible\")) {\r\n            if (!isDefined(this._shownSubmenus)) {\r\n                this._shownSubmenus = []\r\n            }\r\n            if (!this._shownSubmenus.includes($submenu)) {\r\n                this._shownSubmenus.push($submenu)\r\n            }\r\n            if (animation) {\r\n                fx.stop($submenu)\r\n            }\r\n            animationPosition.setup($submenu, submenuPosition);\r\n            if (animation) {\r\n                if (isPlainObject(animation.to)) {\r\n                    animation.to.position = submenuPosition\r\n                }\r\n                this._animate($submenu, animation)\r\n            }\r\n            $submenu.css(\"visibility\", \"visible\")\r\n        }\r\n    }\r\n    _animate($container, options) {\r\n        fx.animate($container, options)\r\n    }\r\n    _getSubmenuPosition($rootItem) {\r\n        var submenuDirection = this.option(\"submenuDirection\").toLowerCase();\r\n        var $rootItemWrapper = $rootItem.parent(\".\".concat(DX_MENU_ITEM_WRAPPER_CLASS));\r\n        var position = {\r\n            collision: \"flip\",\r\n            of: $rootItemWrapper,\r\n            offset: {\r\n                h: 0,\r\n                v: -1\r\n            }\r\n        };\r\n        switch (submenuDirection) {\r\n            case \"left\":\r\n                position.at = \"left top\";\r\n                position.my = \"right top\";\r\n                break;\r\n            case \"right\":\r\n                position.at = \"right top\";\r\n                position.my = \"left top\";\r\n                break;\r\n            default:\r\n                if (this.option(\"rtlEnabled\")) {\r\n                    position.at = \"left top\";\r\n                    position.my = \"right top\"\r\n                } else {\r\n                    position.at = \"right top\";\r\n                    position.my = \"left top\"\r\n                }\r\n        }\r\n        return position\r\n    }\r\n    _updateSubmenuVisibilityOnClick(actionArgs) {\r\n        if (!actionArgs.args.length) {\r\n            return\r\n        }\r\n        var itemData = actionArgs.args[0].itemData;\r\n        var node = this._dataAdapter.getNodeByItem(itemData);\r\n        if (!node) {\r\n            return\r\n        }\r\n        var $itemElement = $(actionArgs.args[0].itemElement);\r\n        var $submenu = $itemElement.find(\".\".concat(DX_SUBMENU_CLASS));\r\n        var shouldRenderSubmenu = this._hasSubmenu(node) && !$submenu.length;\r\n        if (shouldRenderSubmenu) {\r\n            this._renderSubmenuItems(node, $itemElement);\r\n            $submenu = $itemElement.find(\".\".concat(DX_SUBMENU_CLASS))\r\n        }\r\n        if ($itemElement.context === $submenu.context && \"visible\" === $submenu.css(\"visibility\")) {\r\n            return\r\n        }\r\n        this._updateSelectedItemOnClick(actionArgs);\r\n        var notCloseMenuOnItemClick = itemData && false === itemData.closeMenuOnClick;\r\n        if (!itemData || itemData.disabled || notCloseMenuOnItemClick) {\r\n            return\r\n        }\r\n        if (0 === $submenu.length) {\r\n            var $prevSubmenu = $($itemElement.parents(\".\".concat(DX_SUBMENU_CLASS))[0]);\r\n            this._hideSubmenu($prevSubmenu);\r\n            if (!actionArgs.canceled && this._overlay && this._overlay.option(\"visible\")) {\r\n                this.option(\"visible\", false)\r\n            }\r\n        } else {\r\n            if (this._shownSubmenus && this._shownSubmenus.length > 0) {\r\n                if (this._shownSubmenus[0].is($submenu)) {\r\n                    this._hideSubmenu($submenu)\r\n                }\r\n            }\r\n            this._showSubmenu($itemElement)\r\n        }\r\n    }\r\n    _hideSubmenu($curSubmenu) {\r\n        var shownSubmenus = extend([], this._shownSubmenus);\r\n        each(shownSubmenus, (index, $submenu) => {\r\n            if ($curSubmenu.is($submenu) || contains($curSubmenu[0], $submenu[0])) {\r\n                $submenu.parent().removeClass(DX_MENU_ITEM_EXPANDED_CLASS);\r\n                this._hideSubmenuCore($submenu)\r\n            }\r\n        })\r\n    }\r\n    _hideSubmenuCore($submenu) {\r\n        var index = this._shownSubmenus.indexOf($submenu);\r\n        var animation = this.option(\"animation\") ? this.option(\"animation\").hide : null;\r\n        if (index >= 0) {\r\n            this._shownSubmenus.splice(index, 1)\r\n        }\r\n        this._stopAnimate($submenu);\r\n        animation && this._animate($submenu, animation);\r\n        $submenu.css(\"visibility\", \"hidden\")\r\n    }\r\n    _stopAnimate($container) {\r\n        fx.stop($container, true)\r\n    }\r\n    _hideAllShownSubmenus() {\r\n        var shownSubmenus = extend([], this._shownSubmenus);\r\n        var $expandedItems = this._overlay.$content().find(\".\".concat(DX_MENU_ITEM_EXPANDED_CLASS));\r\n        $expandedItems.removeClass(DX_MENU_ITEM_EXPANDED_CLASS);\r\n        each(shownSubmenus, (_, $submenu) => {\r\n            this._hideSubmenu($submenu)\r\n        })\r\n    }\r\n    _visibilityChanged(visible) {\r\n        if (visible) {\r\n            this._renderContentImpl()\r\n        }\r\n    }\r\n    _optionChanged(args) {\r\n        if (ACTIONS.includes(args.name)) {\r\n            this._initActions();\r\n            return\r\n        }\r\n        switch (args.name) {\r\n            case \"visible\":\r\n                this._renderVisibility(args.value);\r\n                break;\r\n            case \"showEvent\":\r\n            case \"position\":\r\n            case \"submenuDirection\":\r\n                this._invalidate();\r\n                break;\r\n            case \"target\":\r\n                args.previousValue && this._detachShowContextMenuEvents(args.previousValue);\r\n                this._invalidate();\r\n                break;\r\n            case \"closeOnOutsideClick\":\r\n            case \"hideOnOutsideClick\":\r\n                break;\r\n            default:\r\n                super._optionChanged(args)\r\n        }\r\n    }\r\n    _renderVisibility(showing) {\r\n        return showing ? this._show() : this._hide()\r\n    }\r\n    _toggleVisibility() {}\r\n    _show(event) {\r\n        var args = {\r\n            jQEvent: event\r\n        };\r\n        var promise = (new Deferred).reject().promise();\r\n        this._actions.onShowing(args);\r\n        if (args.cancel) {\r\n            return promise\r\n        }\r\n        var position = this._positionContextMenu(event);\r\n        if (position) {\r\n            var _event$originalEvent;\r\n            if (!this._overlay) {\r\n                this._renderContextMenuOverlay();\r\n                this._overlay.$content().addClass(this._widgetClass());\r\n                this._renderFocusState();\r\n                this._attachHoverEvents();\r\n                this._attachClickEvent();\r\n                this._renderItems(this._dataAdapter.getRootNodes())\r\n            }\r\n            this._setOptionWithoutOptionChange(\"visible\", true);\r\n            this._overlay.option(\"position\", position);\r\n            promise = this._overlay.show();\r\n            event && event.stopPropagation();\r\n            this._setAriaAttributes();\r\n            if ((null === event || void 0 === event ? void 0 : null === (_event$originalEvent = event.originalEvent) || void 0 === _event$originalEvent ? void 0 : _event$originalEvent.type) === holdEvent.name) {\r\n                this.preventShowingDefaultContextMenuAboveOverlay()\r\n            }\r\n        }\r\n        return promise\r\n    }\r\n    _setAriaAttributes() {\r\n        this._overlayContentId = \"dx-\".concat(new Guid);\r\n        this.setAria(\"owns\", this._overlayContentId);\r\n        this.setAria({\r\n            id: this._overlayContentId,\r\n            role: \"menu\"\r\n        }, this._overlay.$content())\r\n    }\r\n    _cleanAriaAttributes() {\r\n        this._overlay && this.setAria(\"id\", null, this._overlay.$content());\r\n        this.setAria(\"owns\", void 0)\r\n    }\r\n    _getTarget() {\r\n        return this.option(\"target\") || this.option(\"position\").of || $(domAdapter.getDocument())\r\n    }\r\n    _getContextMenuPosition() {\r\n        return extend({}, this.option(\"position\"), {\r\n            of: this._getTarget()\r\n        })\r\n    }\r\n    _positionContextMenu(jQEvent) {\r\n        var position = this._getContextMenuPosition();\r\n        var isInitialPosition = this._isInitialOptionValue(\"position\");\r\n        var positioningAction = this._createActionByOption(\"onPositioning\", actionArgs);\r\n        if (jQEvent && jQEvent.preventDefault && isInitialPosition) {\r\n            position.of = jQEvent\r\n        }\r\n        var actionArgs = {\r\n            position: position,\r\n            event: jQEvent\r\n        };\r\n        positioningAction(actionArgs);\r\n        if (actionArgs.cancel) {\r\n            position = null\r\n        } else if (actionArgs.event) {\r\n            actionArgs.event.cancel = true;\r\n            jQEvent.preventDefault()\r\n        }\r\n        return position\r\n    }\r\n    _refresh() {\r\n        if (!hasWindow()) {\r\n            super._refresh()\r\n        } else if (this._overlay) {\r\n            var lastPosition = this._overlay.option(\"position\");\r\n            super._refresh();\r\n            this._overlay && this._overlay.option(\"position\", lastPosition)\r\n        } else {\r\n            super._refresh()\r\n        }\r\n    }\r\n    _hide() {\r\n        var promise;\r\n        if (this._overlay) {\r\n            promise = this._overlay.hide();\r\n            this._setOptionWithoutOptionChange(\"visible\", false)\r\n        }\r\n        this._cleanAriaAttributes();\r\n        this.option(\"focusedElement\", null);\r\n        return promise || (new Deferred).reject().promise()\r\n    }\r\n    toggle(showing) {\r\n        var visible = this.option(\"visible\");\r\n        showing = void 0 === showing ? !visible : showing;\r\n        return this._renderVisibility(showing)\r\n    }\r\n    show() {\r\n        return this.toggle(true)\r\n    }\r\n    hide() {\r\n        return this.toggle(false)\r\n    }\r\n}\r\nregisterComponent(\"dxContextMenu\", ContextMenu);\r\nexport default ContextMenu;\r\n"]},"metadata":{},"sourceType":"module"}